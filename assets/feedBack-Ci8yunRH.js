import{G as Nl,H as Cl,I as fs,J as ei,K as Rl,L as ri,M as jl,N as Ll,O as Il,P as cs,Q as Yn,R as Bl,S as ps,U as Xl,V as Gn,W as kl,X as Hl,Y as Yl,Z as Gl,$ as zl,a0 as Fl,a1 as Ul,a2 as $l,a3 as Vl,a4 as Wl,a5 as Kl,c as k,a6 as ni,a7 as zn,a8 as eo,a9 as Ye,aa as le,ab as Ue,i as Xt,ac as Zl,ad as ql,ae as hs,af as Jl,ag as vs,ah as Oi,ai as Ql,aj as tu,ak as eu}from"./index-DF2vOzu5.js";var ru=1/0,nu=17976931348623157e292;function ou(r){if(!r)return r===0?r:0;if(r=Nl(r),r===ru||r===-1/0){var t=r<0?-1:1;return t*nu}return r===r?r:0}function iu(r){var t=ou(r),e=t%1;return t===t?e?t-e:t:0}var au=Object.prototype,su=au.hasOwnProperty,Q=Cl(function(r,t){if(fs(t)||ei(t)){Rl(t,ri(t),r);return}for(var e in t)su.call(t,e)&&jl(r,e,t[e])});function lu(r,t,e,n){var o=-1,i=r==null?0:r.length;for(n&&i&&(e=r[++o]);++o<i;)e=t(e,r[o],o,r);return e}function uu(r){return typeof r=="function"?r:Ll}function at(r,t){var e=Yn(r)?Il:cs;return e(r,uu(t))}function du(r,t){return Bl(t,function(e){return[e,r[e]]})}function fu(r){var t=-1,e=Array(r.size);return r.forEach(function(n){e[++t]=[n,n]}),e}var cu="[object Map]",pu="[object Set]";function hu(r){return function(t){var e=ps(t);return e==cu?Xl(t):e==pu?fu(t):du(t,r(t))}}var me=hu(ri);function vu(r){return function(t,e,n){var o=Object(t);if(!ei(t)){var i=Gn(e);t=ri(t),e=function(s){return i(o[s],s,o)}}var a=r(t,e,n);return a>-1?o[i?t[a]:a]:void 0}}var yu=Math.max;function gu(r,t,e){var n=r==null?0:r.length;if(!n)return-1;var o=e==null?0:iu(e);return o<0&&(o=yu(n+o,0)),kl(r,Gn(t),o)}var Ne=vu(gu),_u=Object.prototype,mu=_u.hasOwnProperty;function xu(r,t){return r!=null&&mu.call(r,t)}function Si(r,t){return r!=null&&Hl(r,t,xu)}function Eu(r,t,e){var n=r==null?0:r.length;if(!n)return-1;var o=0;return Yl(r,t,o)}var bu="[object Boolean]";function mo(r){return r===!0||r===!1||Gl(r)&&zl(r)==bu}var Ou="[object Map]",Su="[object Set]",wu=Object.prototype,Mu=wu.hasOwnProperty;function ys(r){if(r==null)return!0;if(ei(r)&&(Yn(r)||typeof r=="string"||typeof r.splice=="function"||Fl(r)||Ul(r)||$l(r)))return!r.length;var t=ps(r);if(t==Ou||t==Su)return!r.size;if(fs(r))return!Vl(r).length;for(var e in r)if(Mu.call(r,e))return!1;return!0}function Au(r,t){var e={};return t=Gn(t),Wl(r,function(n,o,i){Kl(e,t(n,o,i),n)}),e}function Pu(r,t,e,n,o){return o(r,function(i,a,s){e=n?(n=!1,i):t(e,i,a,s)}),e}function Tu(r,t,e){var n=Yn(r)?lu:Pu,o=arguments.length<3;return n(r,Gn(t),e,o,cs)}var Fn,H,gs,Oe,wi,_s,ms,xs,oi,xo,Eo,Pr={},Es=[],Du=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,Xr=Array.isArray;function ae(r,t){for(var e in t)r[e]=t[e];return r}function ii(r){r&&r.parentNode&&r.parentNode.removeChild(r)}function $e(r,t,e){var n,o,i,a={};for(i in t)i=="key"?n=t[i]:i=="ref"?o=t[i]:a[i]=t[i];if(arguments.length>2&&(a.children=arguments.length>3?Fn.call(arguments,2):e),typeof r=="function"&&r.defaultProps!=null)for(i in r.defaultProps)a[i]==null&&(a[i]=r.defaultProps[i]);return cn(r,a,n,o,null)}function cn(r,t,e,n,o){var i={type:r,props:t,key:e,ref:n,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:o??++gs,__i:-1,__u:0};return o==null&&H.vnode!=null&&H.vnode(i),i}function Un(){return{current:null}}function Ve(r){return r.children}function z(r,t){this.props=r,this.context=t}function We(r,t){if(t==null)return r.__?We(r.__,r.__i+1):null;for(var e;t<r.__k.length;t++)if((e=r.__k[t])!=null&&e.__e!=null)return e.__e;return typeof r.type=="function"?We(r):null}function bs(r){var t,e;if((r=r.__)!=null&&r.__c!=null){for(r.__e=r.__c.base=null,t=0;t<r.__k.length;t++)if((e=r.__k[t])!=null&&e.__e!=null){r.__e=r.__c.base=e.__e;break}return bs(r)}}function Mi(r){(!r.__d&&(r.__d=!0)&&Oe.push(r)&&!yn.__r++||wi!=H.debounceRendering)&&((wi=H.debounceRendering)||_s)(yn)}function yn(){for(var r,t,e,n,o,i,a,s=1;Oe.length;)Oe.length>s&&Oe.sort(ms),r=Oe.shift(),s=Oe.length,r.__d&&(e=void 0,o=(n=(t=r).__v).__e,i=[],a=[],t.__P&&((e=ae({},n)).__v=n.__v+1,H.vnode&&H.vnode(e),ai(t.__P,e,n,t.__n,t.__P.namespaceURI,32&n.__u?[o]:null,i,o??We(n),!!(32&n.__u),a),e.__v=n.__v,e.__.__k[e.__i]=e,ws(i,e,a),e.__e!=o&&bs(e)));yn.__r=0}function Os(r,t,e,n,o,i,a,s,l,u,f){var d,c,p,v,h,g,y=n&&n.__k||Es,_=t.length;for(l=Nu(e,t,y,l,_),d=0;d<_;d++)(p=e.__k[d])!=null&&(c=p.__i==-1?Pr:y[p.__i]||Pr,p.__i=d,g=ai(r,p,c,o,i,a,s,l,u,f),v=p.__e,p.ref&&c.ref!=p.ref&&(c.ref&&si(c.ref,null,p),f.push(p.ref,p.__c||v,p)),h==null&&v!=null&&(h=v),4&p.__u||c.__k===p.__k?l=Ss(p,l,r):typeof p.type=="function"&&g!==void 0?l=g:v&&(l=v.nextSibling),p.__u&=-7);return e.__e=h,l}function Nu(r,t,e,n,o){var i,a,s,l,u,f=e.length,d=f,c=0;for(r.__k=new Array(o),i=0;i<o;i++)(a=t[i])!=null&&typeof a!="boolean"&&typeof a!="function"?(l=i+c,(a=r.__k[i]=typeof a=="string"||typeof a=="number"||typeof a=="bigint"||a.constructor==String?cn(null,a,null,null,null):Xr(a)?cn(Ve,{children:a},null,null,null):a.constructor==null&&a.__b>0?cn(a.type,a.props,a.key,a.ref?a.ref:null,a.__v):a).__=r,a.__b=r.__b+1,s=null,(u=a.__i=Cu(a,e,l,d))!=-1&&(d--,(s=e[u])&&(s.__u|=2)),s==null||s.__v==null?(u==-1&&(o>f?c--:o<f&&c++),typeof a.type!="function"&&(a.__u|=4)):u!=l&&(u==l-1?c--:u==l+1?c++:(u>l?c--:c++,a.__u|=4))):r.__k[i]=null;if(d)for(i=0;i<f;i++)(s=e[i])!=null&&(2&s.__u)==0&&(s.__e==n&&(n=We(s)),As(s,s));return n}function Ss(r,t,e){var n,o;if(typeof r.type=="function"){for(n=r.__k,o=0;n&&o<n.length;o++)n[o]&&(n[o].__=r,t=Ss(n[o],t,e));return t}r.__e!=t&&(t&&r.type&&!e.contains(t)&&(t=We(r)),e.insertBefore(r.__e,t||null),t=r.__e);do t=t&&t.nextSibling;while(t!=null&&t.nodeType==8);return t}function gn(r,t){return t=t||[],r==null||typeof r=="boolean"||(Xr(r)?r.some(function(e){gn(e,t)}):t.push(r)),t}function Cu(r,t,e,n){var o,i,a=r.key,s=r.type,l=t[e];if(l===null&&r.key==null||l&&a==l.key&&s==l.type&&(2&l.__u)==0)return e;if(n>(l!=null&&(2&l.__u)==0?1:0))for(o=e-1,i=e+1;o>=0||i<t.length;){if(o>=0){if((l=t[o])&&(2&l.__u)==0&&a==l.key&&s==l.type)return o;o--}if(i<t.length){if((l=t[i])&&(2&l.__u)==0&&a==l.key&&s==l.type)return i;i++}}return-1}function Ai(r,t,e){t[0]=="-"?r.setProperty(t,e??""):r[t]=e==null?"":typeof e!="number"||Du.test(t)?e:e+"px"}function Fr(r,t,e,n,o){var i;t:if(t=="style")if(typeof e=="string")r.style.cssText=e;else{if(typeof n=="string"&&(r.style.cssText=n=""),n)for(t in n)e&&t in e||Ai(r.style,t,"");if(e)for(t in e)n&&e[t]==n[t]||Ai(r.style,t,e[t])}else if(t[0]=="o"&&t[1]=="n")i=t!=(t=t.replace(xs,"$1")),t=t.toLowerCase()in r||t=="onFocusOut"||t=="onFocusIn"?t.toLowerCase().slice(2):t.slice(2),r.l||(r.l={}),r.l[t+i]=e,e?n?e.u=n.u:(e.u=oi,r.addEventListener(t,i?Eo:xo,i)):r.removeEventListener(t,i?Eo:xo,i);else{if(o=="http://www.w3.org/2000/svg")t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(t!="width"&&t!="height"&&t!="href"&&t!="list"&&t!="form"&&t!="tabIndex"&&t!="download"&&t!="rowSpan"&&t!="colSpan"&&t!="role"&&t!="popover"&&t in r)try{r[t]=e??"";break t}catch{}typeof e=="function"||(e==null||e===!1&&t[4]!="-"?r.removeAttribute(t):r.setAttribute(t,t=="popover"&&e==1?"":e))}}function Pi(r){return function(t){if(this.l){var e=this.l[t.type+r];if(t.t==null)t.t=oi++;else if(t.t<e.u)return;return e(H.event?H.event(t):t)}}}function ai(r,t,e,n,o,i,a,s,l,u){var f,d,c,p,v,h,g,y,_,S,M,w,A,m,O,P,T,B=t.type;if(t.constructor!=null)return null;128&e.__u&&(l=!!(32&e.__u),i=[s=t.__e=e.__e]),(f=H.__b)&&f(t);t:if(typeof B=="function")try{if(y=t.props,_="prototype"in B&&B.prototype.render,S=(f=B.contextType)&&n[f.__c],M=f?S?S.props.value:f.__:n,e.__c?g=(d=t.__c=e.__c).__=d.__E:(_?t.__c=d=new B(y,M):(t.__c=d=new z(y,M),d.constructor=B,d.render=ju),S&&S.sub(d),d.props=y,d.state||(d.state={}),d.context=M,d.__n=n,c=d.__d=!0,d.__h=[],d._sb=[]),_&&d.__s==null&&(d.__s=d.state),_&&B.getDerivedStateFromProps!=null&&(d.__s==d.state&&(d.__s=ae({},d.__s)),ae(d.__s,B.getDerivedStateFromProps(y,d.__s))),p=d.props,v=d.state,d.__v=t,c)_&&B.getDerivedStateFromProps==null&&d.componentWillMount!=null&&d.componentWillMount(),_&&d.componentDidMount!=null&&d.__h.push(d.componentDidMount);else{if(_&&B.getDerivedStateFromProps==null&&y!==p&&d.componentWillReceiveProps!=null&&d.componentWillReceiveProps(y,M),!d.__e&&d.shouldComponentUpdate!=null&&d.shouldComponentUpdate(y,d.__s,M)===!1||t.__v==e.__v){for(t.__v!=e.__v&&(d.props=y,d.state=d.__s,d.__d=!1),t.__e=e.__e,t.__k=e.__k,t.__k.some(function(I){I&&(I.__=t)}),w=0;w<d._sb.length;w++)d.__h.push(d._sb[w]);d._sb=[],d.__h.length&&a.push(d);break t}d.componentWillUpdate!=null&&d.componentWillUpdate(y,d.__s,M),_&&d.componentDidUpdate!=null&&d.__h.push(function(){d.componentDidUpdate(p,v,h)})}if(d.context=M,d.props=y,d.__P=r,d.__e=!1,A=H.__r,m=0,_){for(d.state=d.__s,d.__d=!1,A&&A(t),f=d.render(d.props,d.state,d.context),O=0;O<d._sb.length;O++)d.__h.push(d._sb[O]);d._sb=[]}else do d.__d=!1,A&&A(t),f=d.render(d.props,d.state,d.context),d.state=d.__s;while(d.__d&&++m<25);d.state=d.__s,d.getChildContext!=null&&(n=ae(ae({},n),d.getChildContext())),_&&!c&&d.getSnapshotBeforeUpdate!=null&&(h=d.getSnapshotBeforeUpdate(p,v)),P=f,f!=null&&f.type===Ve&&f.key==null&&(P=Ms(f.props.children)),s=Os(r,Xr(P)?P:[P],t,e,n,o,i,a,s,l,u),d.base=t.__e,t.__u&=-161,d.__h.length&&a.push(d),g&&(d.__E=d.__=null)}catch(I){if(t.__v=null,l||i!=null)if(I.then){for(t.__u|=l?160:128;s&&s.nodeType==8&&s.nextSibling;)s=s.nextSibling;i[i.indexOf(s)]=null,t.__e=s}else for(T=i.length;T--;)ii(i[T]);else t.__e=e.__e,t.__k=e.__k;H.__e(I,t,e)}else i==null&&t.__v==e.__v?(t.__k=e.__k,t.__e=e.__e):s=t.__e=Ru(e.__e,t,e,n,o,i,a,l,u);return(f=H.diffed)&&f(t),128&t.__u?void 0:s}function ws(r,t,e){for(var n=0;n<e.length;n++)si(e[n],e[++n],e[++n]);H.__c&&H.__c(t,r),r.some(function(o){try{r=o.__h,o.__h=[],r.some(function(i){i.call(o)})}catch(i){H.__e(i,o.__v)}})}function Ms(r){return typeof r!="object"||r==null||r.__b&&r.__b>0?r:Xr(r)?r.map(Ms):ae({},r)}function Ru(r,t,e,n,o,i,a,s,l){var u,f,d,c,p,v,h,g=e.props,y=t.props,_=t.type;if(_=="svg"?o="http://www.w3.org/2000/svg":_=="math"?o="http://www.w3.org/1998/Math/MathML":o||(o="http://www.w3.org/1999/xhtml"),i!=null){for(u=0;u<i.length;u++)if((p=i[u])&&"setAttribute"in p==!!_&&(_?p.localName==_:p.nodeType==3)){r=p,i[u]=null;break}}if(r==null){if(_==null)return document.createTextNode(y);r=document.createElementNS(o,_,y.is&&y),s&&(H.__m&&H.__m(t,i),s=!1),i=null}if(_==null)g===y||s&&r.data==y||(r.data=y);else{if(i=i&&Fn.call(r.childNodes),g=e.props||Pr,!s&&i!=null)for(g={},u=0;u<r.attributes.length;u++)g[(p=r.attributes[u]).name]=p.value;for(u in g)if(p=g[u],u!="children"){if(u=="dangerouslySetInnerHTML")d=p;else if(!(u in y)){if(u=="value"&&"defaultValue"in y||u=="checked"&&"defaultChecked"in y)continue;Fr(r,u,null,p,o)}}for(u in y)p=y[u],u=="children"?c=p:u=="dangerouslySetInnerHTML"?f=p:u=="value"?v=p:u=="checked"?h=p:s&&typeof p!="function"||g[u]===p||Fr(r,u,p,g[u],o);if(f)s||d&&(f.__html==d.__html||f.__html==r.innerHTML)||(r.innerHTML=f.__html),t.__k=[];else if(d&&(r.innerHTML=""),Os(t.type=="template"?r.content:r,Xr(c)?c:[c],t,e,n,_=="foreignObject"?"http://www.w3.org/1999/xhtml":o,i,a,i?i[0]:e.__k&&We(e,0),s,l),i!=null)for(u=i.length;u--;)ii(i[u]);s||(u="value",_=="progress"&&v==null?r.removeAttribute("value"):v!=null&&(v!==r[u]||_=="progress"&&!v||_=="option"&&v!=g[u])&&Fr(r,u,v,g[u],o),u="checked",h!=null&&h!=r[u]&&Fr(r,u,h,g[u],o))}return r}function si(r,t,e){try{if(typeof r=="function"){var n=typeof r.__u=="function";n&&r.__u(),n&&t==null||(r.__u=r(t))}else r.current=t}catch(o){H.__e(o,e)}}function As(r,t,e){var n,o;if(H.unmount&&H.unmount(r),(n=r.ref)&&(n.current&&n.current!=r.__e||si(n,null,t)),(n=r.__c)!=null){if(n.componentWillUnmount)try{n.componentWillUnmount()}catch(i){H.__e(i,t)}n.base=n.__P=null}if(n=r.__k)for(o=0;o<n.length;o++)n[o]&&As(n[o],t,e||typeof r.type!="function");e||ii(r.__e),r.__c=r.__=r.__e=void 0}function ju(r,t,e){return this.constructor(r,e)}function Lu(r,t,e){var n,o,i,a;t==document&&(t=document.documentElement),H.__&&H.__(r,t),o=(n=!1)?null:t.__k,i=[],a=[],ai(t,r=t.__k=$e(Ve,null,[r]),o||Pr,Pr,t.namespaceURI,o?null:t.firstChild?Fn.call(t.childNodes):null,i,o?o.__e:t.firstChild,n,a),ws(i,r,a)}Fn=Es.slice,H={__e:function(r,t,e,n){for(var o,i,a;t=t.__;)if((o=t.__c)&&!o.__)try{if((i=o.constructor)&&i.getDerivedStateFromError!=null&&(o.setState(i.getDerivedStateFromError(r)),a=o.__d),o.componentDidCatch!=null&&(o.componentDidCatch(r,n||{}),a=o.__d),a)return o.__E=o}catch(s){r=s}throw r}},gs=0,z.prototype.setState=function(r,t){var e;e=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=ae({},this.state),typeof r=="function"&&(r=r(ae({},e),this.props)),r&&ae(e,r),r!=null&&this.__v&&(t&&this._sb.push(t),Mi(this))},z.prototype.forceUpdate=function(r){this.__v&&(this.__e=!0,r&&this.__h.push(r),Mi(this))},z.prototype.render=Ve,Oe=[],_s=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,ms=function(r,t){return r.__v.__b-t.__v.__b},yn.__r=0,xs=/(PointerCapture)$|Capture$/i,oi=0,xo=Pi(!1),Eo=Pi(!0);var Iu="An invariant failed, however the error is obfuscated because this is a production build.",_n=[];Object.freeze(_n);var li={};Object.freeze(li);function xt(){return++N.mobxGuid}function W(r){throw Ae(!1,r),"X"}function Ae(r,t){if(!r)throw new Error("[mobx] "+(t||Iu))}function Ps(r){var t=!1;return function(){if(!t)return t=!0,r.apply(this,arguments)}}var Ur=function(){};function Bu(r){var t=[];return r.forEach(function(e){t.indexOf(e)===-1&&t.push(e)}),t}function ui(r){return r!==null&&typeof r=="object"}function or(r){if(r===null||typeof r!="object")return!1;var t=Object.getPrototypeOf(r);return t===Object.prototype||t===null}function Xu(r){if(ar(r)||Et(r))return r;if(Array.isArray(r))return new Map(r);if(or(r)){var t=new Map;for(var e in r)t.set(e,r[e]);return t}else return W("Cannot convert to map from '"+r+"'")}function ir(r,t,e){Object.defineProperty(r,t,{enumerable:!1,writable:!0,configurable:!0,value:e})}function ku(r,t,e){Object.defineProperty(r,t,{enumerable:!1,writable:!1,configurable:!0,value:e})}function Hu(r,t){var e=Object.getOwnPropertyDescriptor(r,t);return!e||e.configurable!==!1&&e.writable!==!1}function xe(r,t){var e="isMobX"+r;return t.prototype[e]=!0,function(n){return ui(n)&&n[e]===!0}}function ar(r){return r instanceof Map}function kr(r){return r instanceof Set}function Ts(r){var t=new Set;for(var e in r)t.add(e);return Object.getOwnPropertySymbols(r).forEach(function(n){Object.getOwnPropertyDescriptor(r,n).enumerable&&t.add(n)}),Array.from(t)}function ve(r){return r&&r.toString?r.toString():new String(r).toString()}function Ds(r){return r===null?null:typeof r=="object"?""+r:r}var Yu=typeof Reflect<"u"&&Reflect.ownKeys?Reflect.ownKeys:Object.getOwnPropertySymbols?function(r){return Object.getOwnPropertyNames(r).concat(Object.getOwnPropertySymbols(r))}:Object.getOwnPropertyNames,L=Symbol("mobx administration"),sr=function(){function r(t){t===void 0&&(t="Atom@"+xt()),this.name=t,this.isPendingUnobservation=!1,this.isBeingObserved=!1,this.observers=new Set,this.diffValue=0,this.lastAccessedBy=0,this.lowestObserverState=Z.NOT_TRACKING}return r.prototype.onBecomeObserved=function(){this.onBecomeObservedListeners&&this.onBecomeObservedListeners.forEach(function(t){return t()})},r.prototype.onBecomeUnobserved=function(){this.onBecomeUnobservedListeners&&this.onBecomeUnobservedListeners.forEach(function(t){return t()})},r.prototype.reportObserved=function(){return Ys(this)},r.prototype.reportChanged=function(){Ht(),ud(this),Yt()},r.prototype.toString=function(){return this.name},r}(),di=xe("Atom",sr);function fi(r,t,e){t===void 0&&(t=Ur),e===void 0&&(e=Ur);var n=new sr(r);return t!==Ur&&bd(n,t),e!==Ur&&Vs(n,e),n}function Gu(r,t){return nl(r,t)}function zu(r,t){return Object.is(r,t)}var Ke={structural:Gu,default:zu};/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var bo=function(r,t){return bo=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var o in n)n.hasOwnProperty(o)&&(e[o]=n[o])},bo(r,t)};function Fu(r,t){bo(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var mn=function(){return mn=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},mn.apply(this,arguments)};function Zt(r){var t=typeof Symbol=="function"&&r[Symbol.iterator],e=0;return t?t.call(r):{next:function(){return r&&e>=r.length&&(r=void 0),{value:r&&r[e++],done:!r}}}}function Ge(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i}function ci(){for(var r=[],t=0;t<arguments.length;t++)r=r.concat(Ge(arguments[t]));return r}var xn=Symbol("mobx did run lazy initializers"),cr=Symbol("mobx pending decorators"),Uu={},$u={};function Vu(r,t){var e=t?Uu:$u;return e[r]||(e[r]={configurable:!0,enumerable:t,get:function(){return Ce(this),this[r]},set:function(n){Ce(this),this[r]=n}})}function Ce(r){var t,e;if(r[xn]!==!0){var n=r[cr];if(n){ir(r,xn,!0);var o=ci(Object.getOwnPropertySymbols(n),Object.keys(n));try{for(var i=Zt(o),a=i.next();!a.done;a=i.next()){var s=a.value,l=n[s];l.propertyCreator(r,l.prop,l.descriptor,l.decoratorTarget,l.decoratorArguments)}}catch(u){t={error:u}}finally{try{a&&!a.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}}}}function Ns(r,t){return function(){var n,o=function(a,s,l,u){if(u===!0)return t(a,s,l,a,n),null;if(!Object.prototype.hasOwnProperty.call(a,cr)){var f=a[cr];ir(a,cr,mn({},f))}return a[cr][s]={prop:s,propertyCreator:t,descriptor:l,decoratorTarget:a,decoratorArguments:n},Vu(s,r)};return Wu(arguments)?(n=_n,o.apply(null,arguments)):(n=Array.prototype.slice.call(arguments),o)}}function Wu(r){return(r.length===2||r.length===3)&&(typeof r[1]=="string"||typeof r[1]=="symbol")||r.length===4&&r[3]===!0}function Hr(r,t,e){return Qe(r)?r:Array.isArray(r)?E.array(r,{name:e}):or(r)?E.object(r,void 0,{name:e}):ar(r)?E.map(r,{name:e}):kr(r)?E.set(r,{name:e}):r}function Ku(r,t,e){return r==null||Ft(r)||ee(r)||Et(r)||Dt(r)?r:Array.isArray(r)?E.array(r,{name:e,deep:!1}):or(r)?E.object(r,void 0,{name:e,deep:!1}):ar(r)?E.map(r,{name:e,deep:!1}):kr(r)?E.set(r,{name:e,deep:!1}):W(!1)}function $n(r){return r}function Zu(r,t,e){return nl(r,t)?t:r}function Vn(r){Ae(r);var t=Ns(!0,function(n,o,i,a,s){var l=i?i.initializer?i.initializer.call(n):i.value:void 0;gi(n).addObservableProp(o,l,r)}),e=t;return e.enhancer=r,e}var Cs={deep:!0,name:void 0,defaultDecorator:void 0,proxy:!0};Object.freeze(Cs);function He(r){return r==null?Cs:typeof r=="string"?{name:r,deep:!0,proxy:!0}:r}var pi=Vn(Hr),qu=Vn(Ku),Rs=Vn($n),Ju=Vn(Zu);function $r(r){return r.defaultDecorator?r.defaultDecorator.enhancer:r.deep===!1?$n:Hr}function Qu(r,t,e){if(typeof arguments[1]=="string"||typeof arguments[1]=="symbol")return pi.apply(null,arguments);if(Qe(r))return r;var n=or(r)?E.object(r,t,e):Array.isArray(r)?E.array(r,t):ar(r)?E.map(r,t):kr(r)?E.set(r,t):r;if(n!==r)return n;W(!1)}var Ti={box:function(r,t){arguments.length>2&&ur("box");var e=He(t);return new Te(r,$r(e),e.name,!0,e.equals)},array:function(r,t){arguments.length>2&&ur("array");var e=He(t);return Bd(r,$r(e),e.name)},map:function(r,t){arguments.length>2&&ur("map");var e=He(t);return new yi(r,$r(e),e.name)},set:function(r,t){arguments.length>2&&ur("set");var e=He(t);return new el(r,$r(e),e.name)},object:function(r,t,e){typeof arguments[1]=="string"&&ur("object");var n=He(e);if(n.proxy===!1)return Po({},r,t,n);var o=Ks(n),i=Po({},void 0,void 0,n),a=jd(i);return Zs(a,r,t,o),a},ref:Rs,shallow:qu,deep:pi,struct:Ju},E=Qu;Object.keys(Ti).forEach(function(r){return E[r]=Ti[r]});function ur(r){W("Expected one or two arguments to observable."+r+". Did you accidentally try to use observable."+r+" as decorator?")}var En=Ns(!1,function(r,t,e,n,o){var i=e.get,a=e.set,s=o[0]||{};gi(r).addComputedProp(r,t,mn({get:i,set:a,context:r},s))}),td=En({equals:Ke.structural}),tt=function(t,e,n){if(typeof e=="string"||t!==null&&typeof t=="object"&&arguments.length===1)return En.apply(null,arguments);var o=typeof e=="object"?e:{};return o.get=t,o.set=typeof e=="function"?e:o.set,o.name=o.name||t.name||"",new qe(o)};tt.struct=td;var Z;(function(r){r[r.NOT_TRACKING=-1]="NOT_TRACKING",r[r.UP_TO_DATE=0]="UP_TO_DATE",r[r.POSSIBLY_STALE=1]="POSSIBLY_STALE",r[r.STALE=2]="STALE"})(Z||(Z={}));var Jt;(function(r){r[r.NONE=0]="NONE",r[r.LOG=1]="LOG",r[r.BREAK=2]="BREAK"})(Jt||(Jt={}));var bn=function(){function r(t){this.cause=t}return r}();function pr(r){return r instanceof bn}function Oo(r){switch(r.dependenciesState){case Z.UP_TO_DATE:return!1;case Z.NOT_TRACKING:case Z.STALE:return!0;case Z.POSSIBLY_STALE:{for(var t=hi(!0),e=lr(),n=r.observing,o=n.length,i=0;i<o;i++){var a=n[i];if(Je(a)){if(N.disableErrorBoundaries)a.get();else try{a.get()}catch{return ge(e),yr(t),!0}if(r.dependenciesState===Z.STALE)return ge(e),yr(t),!0}}return Is(r),ge(e),yr(t),!1}}}function Ze(r){var t=r.observers.size>0;N.computationDepth>0&&t&&W(!1),!N.allowStateChanges&&(t||N.enforceActions==="strict")&&W(!1)}function js(r,t,e){var n=hi(!0);Is(r),r.newObserving=new Array(r.observing.length+100),r.unboundDepsCount=0,r.runId=++N.runId;var o=N.trackingDerivation;N.trackingDerivation=r;var i;if(N.disableErrorBoundaries===!0)i=t.call(e);else try{i=t.call(e)}catch(a){i=new bn(a)}return N.trackingDerivation=o,ed(r),yr(n),i}function ed(r){for(var t=r.observing,e=r.observing=r.newObserving,n=Z.UP_TO_DATE,o=0,i=r.unboundDepsCount,a=0;a<i;a++){var s=e[a];s.diffValue===0&&(s.diffValue=1,o!==a&&(e[o]=s),o++),s.dependenciesState>n&&(n=s.dependenciesState)}for(e.length=o,r.newObserving=null,i=t.length;i--;){var s=t[i];s.diffValue===0&&ks(s,r),s.diffValue=0}for(;o--;){var s=e[o];s.diffValue===1&&(s.diffValue=0,ld(s,r))}n!==Z.UP_TO_DATE&&(r.dependenciesState=n,r.onBecomeStale())}function So(r){var t=r.observing;r.observing=[];for(var e=t.length;e--;)ks(t[e],r);r.dependenciesState=Z.NOT_TRACKING}function Ls(r){var t=lr();try{return r()}finally{ge(t)}}function lr(){var r=N.trackingDerivation;return N.trackingDerivation=null,r}function ge(r){N.trackingDerivation=r}function hi(r){var t=N.allowStateReads;return N.allowStateReads=r,t}function yr(r){N.allowStateReads=r}function Is(r){if(r.dependenciesState!==Z.UP_TO_DATE){r.dependenciesState=Z.UP_TO_DATE;for(var t=r.observing,e=t.length;e--;)t[e].lowestObserverState=Z.UP_TO_DATE}}var On=0,rd=1,Di=Object.getOwnPropertyDescriptor(function(){},"name");Di&&Di.configurable;function Pe(r,t,e){var n=function(){return Bs(r,t,e||this,arguments)};return n.isMobxAction=!0,n}function Bs(r,t,e,n){var o=nd();try{return t.apply(e,n)}catch(i){throw o.error=i,i}finally{od(o)}}function nd(r,t,e){var n=Pt(),o=0,i=lr();Ht();var a=Wn(!0),s=hi(!0),l={prevDerivation:i,prevAllowStateChanges:a,prevAllowStateReads:s,notifySpy:n,startTime:o,actionId:rd++,parentActionId:On};return On=l.actionId,l}function od(r){On!==r.actionId&&W("invalid action stack. did you forget to finish an action?"),On=r.parentActionId,r.error!==void 0&&(N.suppressReactionErrors=!0),Kn(r.prevAllowStateChanges),yr(r.prevAllowStateReads),Yt(),ge(r.prevDerivation),N.suppressReactionErrors=!1}function Wn(r){var t=N.allowStateChanges;return N.allowStateChanges=r,t}function Kn(r){N.allowStateChanges=r}var Te=function(r){Fu(t,r);function t(e,n,o,i,a){o===void 0&&(o="ObservableValue@"+xt()),a===void 0&&(a=Ke.default);var s=r.call(this,o)||this;return s.enhancer=n,s.name=o,s.equals=a,s.hasUnreportedChange=!1,s.value=n(e,void 0,o),s}return t.prototype.dehanceValue=function(e){return this.dehancer!==void 0?this.dehancer(e):e},t.prototype.set=function(e){this.value,e=this.prepareNewValue(e),e!==N.UNCHANGED&&this.setNewValue(e)},t.prototype.prepareNewValue=function(e){if(Ze(this),Qt(this)){var n=te(this,{object:this,type:"update",newValue:e});if(!n)return N.UNCHANGED;e=n.newValue}return e=this.enhancer(e,this.value,this.name),this.equals(this.value,e)?N.UNCHANGED:e},t.prototype.setNewValue=function(e){var n=this.value;this.value=e,this.reportChanged(),Gt(this)&&zt(this,{type:"update",object:this,newValue:e,oldValue:n})},t.prototype.get=function(){return this.reportObserved(),this.dehanceValue(this.value)},t.prototype.intercept=function(e){return Yr(this,e)},t.prototype.observe=function(e,n){return n&&e({object:this,type:"update",newValue:this.value,oldValue:void 0}),Gr(this,e)},t.prototype.toJSON=function(){return this.get()},t.prototype.toString=function(){return this.name+"["+this.value+"]"},t.prototype.valueOf=function(){return Ds(this.get())},t.prototype[Symbol.toPrimitive]=function(){return this.valueOf()},t}(sr),id=xe("ObservableValue",Te),qe=function(){function r(t){this.dependenciesState=Z.NOT_TRACKING,this.observing=[],this.newObserving=null,this.isBeingObserved=!1,this.isPendingUnobservation=!1,this.observers=new Set,this.diffValue=0,this.runId=0,this.lastAccessedBy=0,this.lowestObserverState=Z.UP_TO_DATE,this.unboundDepsCount=0,this.__mapid="#"+xt(),this.value=new bn(null),this.isComputing=!1,this.isRunningSetter=!1,this.isTracing=Jt.NONE,Ae(t.get,"missing option for computed: get"),this.derivation=t.get,this.name=t.name||"ComputedValue@"+xt(),t.set&&(this.setter=Pe(this.name+"-setter",t.set)),this.equals=t.equals||(t.compareStructural||t.struct?Ke.structural:Ke.default),this.scope=t.context,this.requiresReaction=!!t.requiresReaction,this.keepAlive=!!t.keepAlive}return r.prototype.onBecomeStale=function(){fd(this)},r.prototype.onBecomeObserved=function(){this.onBecomeObservedListeners&&this.onBecomeObservedListeners.forEach(function(t){return t()})},r.prototype.onBecomeUnobserved=function(){this.onBecomeUnobservedListeners&&this.onBecomeUnobservedListeners.forEach(function(t){return t()})},r.prototype.get=function(){this.isComputing&&W("Cycle detected in computation "+this.name+": "+this.derivation),N.inBatch===0&&this.observers.size===0&&!this.keepAlive?Oo(this)&&(this.warnAboutUntrackedRead(),Ht(),this.value=this.computeValue(!1),Yt()):(Ys(this),Oo(this)&&this.trackAndCompute()&&dd(this));var t=this.value;if(pr(t))throw t.cause;return t},r.prototype.peek=function(){var t=this.computeValue(!1);if(pr(t))throw t.cause;return t},r.prototype.set=function(t){if(this.setter){Ae(!this.isRunningSetter,"The setter of computed value '"+this.name+"' is trying to update itself. Did you intend to update an _observable_ value, instead of the computed property?"),this.isRunningSetter=!0;try{this.setter.call(this.scope,t)}finally{this.isRunningSetter=!1}}else Ae(!1,!1)},r.prototype.trackAndCompute=function(){var t=this.value,e=this.dependenciesState===Z.NOT_TRACKING,n=this.computeValue(!0),o=e||pr(t)||pr(n)||!this.equals(t,n);return o&&(this.value=n),o},r.prototype.computeValue=function(t){this.isComputing=!0,N.computationDepth++;var e;if(t)e=js(this,this.derivation,this.scope);else if(N.disableErrorBoundaries===!0)e=this.derivation.call(this.scope);else try{e=this.derivation.call(this.scope)}catch(n){e=new bn(n)}return N.computationDepth--,this.isComputing=!1,e},r.prototype.suspend=function(){this.keepAlive||(So(this),this.value=void 0)},r.prototype.observe=function(t,e){var n=this,o=!0,i=void 0;return md(function(){var a=n.get();if(!o||e){var s=lr();t({type:"update",object:n,newValue:a,oldValue:i}),ge(s)}o=!1,i=a})},r.prototype.warnAboutUntrackedRead=function(){},r.prototype.toJSON=function(){return this.get()},r.prototype.toString=function(){return this.name+"["+this.derivation.toString()+"]"},r.prototype.valueOf=function(){return Ds(this.get())},r.prototype[Symbol.toPrimitive]=function(){return this.valueOf()},r}(),Je=xe("ComputedValue",qe),pn=function(){function r(){this.version=5,this.UNCHANGED={},this.trackingDerivation=null,this.computationDepth=0,this.runId=0,this.mobxGuid=0,this.inBatch=0,this.pendingUnobservations=[],this.pendingReactions=[],this.isRunningReactions=!1,this.allowStateChanges=!0,this.allowStateReads=!0,this.enforceActions=!1,this.spyListeners=[],this.globalReactionErrorHandlers=[],this.computedRequiresReaction=!1,this.reactionRequiresObservable=!1,this.observableRequiresReaction=!1,this.computedConfigurable=!1,this.disableErrorBoundaries=!1,this.suppressReactionErrors=!1}return r}(),ad={};function wo(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:ad}var hn=!0,Xs=!1,N=function(){var r=wo();return r.__mobxInstanceCount>0&&!r.__mobxGlobals&&(hn=!1),r.__mobxGlobals&&r.__mobxGlobals.version!==new pn().version&&(hn=!1),hn?r.__mobxGlobals?(r.__mobxInstanceCount+=1,r.__mobxGlobals.UNCHANGED||(r.__mobxGlobals.UNCHANGED={}),r.__mobxGlobals):(r.__mobxInstanceCount=1,r.__mobxGlobals=new pn):(setTimeout(function(){Xs||W("There are multiple, different versions of MobX active. Make sure MobX is loaded only once or use `configure({ isolateGlobalState: true })`")},1),new pn)}();function sd(){(N.pendingReactions.length||N.inBatch||N.isRunningReactions)&&W("isolateGlobalState should be called before MobX is running any reactions"),Xs=!0,hn&&(--wo().__mobxInstanceCount===0&&(wo().__mobxGlobals=void 0),N=new pn)}function Mo(){return N}function ld(r,t){r.observers.add(t),r.lowestObserverState>t.dependenciesState&&(r.lowestObserverState=t.dependenciesState)}function ks(r,t){r.observers.delete(t),r.observers.size===0&&Hs(r)}function Hs(r){r.isPendingUnobservation===!1&&(r.isPendingUnobservation=!0,N.pendingUnobservations.push(r))}function Ht(){N.inBatch++}function Yt(){if(--N.inBatch===0){Fs();for(var r=N.pendingUnobservations,t=0;t<r.length;t++){var e=r[t];e.isPendingUnobservation=!1,e.observers.size===0&&(e.isBeingObserved&&(e.isBeingObserved=!1,e.onBecomeUnobserved()),e instanceof qe&&e.suspend())}N.pendingUnobservations=[]}}function Ys(r){var t=N.trackingDerivation;return t!==null?(t.runId!==r.lastAccessedBy&&(r.lastAccessedBy=t.runId,t.newObserving[t.unboundDepsCount++]=r,r.isBeingObserved||(r.isBeingObserved=!0,r.onBecomeObserved())),!0):(r.observers.size===0&&N.inBatch>0&&Hs(r),!1)}function ud(r){r.lowestObserverState!==Z.STALE&&(r.lowestObserverState=Z.STALE,r.observers.forEach(function(t){t.dependenciesState===Z.UP_TO_DATE&&(t.isTracing!==Jt.NONE&&Gs(t,r),t.onBecomeStale()),t.dependenciesState=Z.STALE}))}function dd(r){r.lowestObserverState!==Z.STALE&&(r.lowestObserverState=Z.STALE,r.observers.forEach(function(t){t.dependenciesState===Z.POSSIBLY_STALE?t.dependenciesState=Z.STALE:t.dependenciesState===Z.UP_TO_DATE&&(r.lowestObserverState=Z.UP_TO_DATE)}))}function fd(r){r.lowestObserverState===Z.UP_TO_DATE&&(r.lowestObserverState=Z.POSSIBLY_STALE,r.observers.forEach(function(t){t.dependenciesState===Z.UP_TO_DATE&&(t.dependenciesState=Z.POSSIBLY_STALE,t.isTracing!==Jt.NONE&&Gs(t,r),t.onBecomeStale())}))}function Gs(r,t){if(console.log("[mobx.trace] '"+r.name+"' is invalidated due to a change in: '"+t.name+"'"),r.isTracing===Jt.BREAK){var e=[];zs(Sd(r),e,1),new Function(`debugger;
/*
Tracing '`+r.name+`'

You are entering this break point because derivation '`+r.name+"' is being traced and '"+t.name+`' is now forcing it to update.
Just follow the stacktrace you should now see in the devtools to see precisely what piece of your code is causing this update
The stackframe you are looking for is at least ~6-8 stack-frames up.

`+(r instanceof qe?r.derivation.toString().replace(/[*]\//g,"/"):"")+`

The dependencies for this derivation are:

`+e.join(`
`)+`
*/
    `)()}}function zs(r,t,e){if(t.length>=1e3){t.push("(and many more)");return}t.push(""+new Array(e).join("	")+r.name),r.dependencies&&r.dependencies.forEach(function(n){return zs(n,t,e+1)})}var Tr=function(){function r(t,e,n,o){t===void 0&&(t="Reaction@"+xt()),o===void 0&&(o=!1),this.name=t,this.onInvalidate=e,this.errorHandler=n,this.requiresObservable=o,this.observing=[],this.newObserving=[],this.dependenciesState=Z.NOT_TRACKING,this.diffValue=0,this.runId=0,this.unboundDepsCount=0,this.__mapid="#"+xt(),this.isDisposed=!1,this._isScheduled=!1,this._isTrackPending=!1,this._isRunning=!1,this.isTracing=Jt.NONE}return r.prototype.onBecomeStale=function(){this.schedule()},r.prototype.schedule=function(){this._isScheduled||(this._isScheduled=!0,N.pendingReactions.push(this),Fs())},r.prototype.isScheduled=function(){return this._isScheduled},r.prototype.runReaction=function(){if(!this.isDisposed){if(Ht(),this._isScheduled=!1,Oo(this)){this._isTrackPending=!0;try{this.onInvalidate(),this._isTrackPending&&Pt()}catch(t){this.reportExceptionInDerivation(t)}}Yt()}},r.prototype.track=function(t){if(!this.isDisposed){Ht(),this._isRunning=!0;var e=js(this,t,void 0);this._isRunning=!1,this._isTrackPending=!1,this.isDisposed&&So(this),pr(e)&&this.reportExceptionInDerivation(e.cause),Yt()}},r.prototype.reportExceptionInDerivation=function(t){var e=this;if(this.errorHandler){this.errorHandler(t,this);return}if(N.disableErrorBoundaries)throw t;var n="[mobx] Encountered an uncaught exception that was thrown by a reaction or observer component, in: '"+this+"'";N.suppressReactionErrors?console.warn("[mobx] (error in reaction '"+this.name+"' suppressed, fix error of causing action below)"):console.error(n,t),N.globalReactionErrorHandlers.forEach(function(o){return o(t,e)})},r.prototype.dispose=function(){this.isDisposed||(this.isDisposed=!0,this._isRunning||(Ht(),So(this),Yt()))},r.prototype.getDisposer=function(){var t=this.dispose.bind(this);return t[L]=this,t},r.prototype.toString=function(){return"Reaction["+this.name+"]"},r.prototype.trace=function(t){t===void 0&&(t=!1),Nd(this,t)},r}(),Ni=100,Ao=function(r){return r()};function Fs(){N.inBatch>0||N.isRunningReactions||Ao(cd)}function cd(){N.isRunningReactions=!0;for(var r=N.pendingReactions,t=0;r.length>0;){++t===Ni&&(console.error("Reaction doesn't converge to a stable state after "+Ni+" iterations."+(" Probably there is a cycle in the reactive function: "+r[0])),r.splice(0));for(var e=r.splice(0),n=0,o=e.length;n<o;n++)e[n].runReaction()}N.isRunningReactions=!1}var Sn=xe("Reaction",Tr);function pd(r){var t=Ao;Ao=function(e){return r(function(){return t(e)})}}function Pt(){return!1}function hd(r){return console.warn("[mobx.spy] Is a no-op in production builds"),function(){}}function vd(){W(!1)}function Ci(r){return function(t,e,n){if(n){if(n.value)return{value:Pe(r,n.value),enumerable:!1,configurable:!0,writable:!0};var o=n.initializer;return{enumerable:!1,configurable:!0,writable:!0,initializer:function(){return Pe(r,o.call(this))}}}return yd(r).apply(this,arguments)}}function yd(r){return function(t,e,n){Object.defineProperty(t,e,{configurable:!0,enumerable:!1,get:function(){},set:function(o){ir(this,e,x(r,o))}})}}function gd(r,t,e,n){return n===!0?(ro(r,t,e.value),null):e?{configurable:!0,enumerable:!1,get:function(){return ro(this,t,e.value||e.initializer.call(this)),this[t]},set:vd}:{enumerable:!1,configurable:!0,set:function(o){ro(this,t,o)},get:function(){}}}var x=function(t,e,n,o){if(arguments.length===1&&typeof t=="function")return Pe(t.name||"<unnamed action>",t);if(arguments.length===2&&typeof e=="function")return Pe(t,e);if(arguments.length===1&&typeof t=="string")return Ci(t);if(o===!0)ir(t,e,Pe(t.name||e,n.value,this));else return Ci(e).apply(null,arguments)};x.bound=gd;function _d(r,t){var e=typeof r=="string"?r:r.name||"<unnamed action>",n=typeof r=="function"?r:t;return Bs(e,n,this,void 0)}function ro(r,t,e){ir(r,t,Pe(t,e.bind(r)))}function md(r,t){t===void 0&&(t=li);var e=t&&t.name||r.name||"Autorun@"+xt(),n=!t.scheduler&&!t.delay,o;if(n)o=new Tr(e,function(){this.track(s)},t.onError,t.requiresObservable);else{var i=Us(t),a=!1;o=new Tr(e,function(){a||(a=!0,i(function(){a=!1,o.isDisposed||o.track(s)}))},t.onError,t.requiresObservable)}function s(){r(o)}return o.schedule(),o.getDisposer()}var xd=function(r){return r()};function Us(r){return r.scheduler?r.scheduler:r.delay?function(t){return setTimeout(t,r.delay)}:xd}function $s(r,t,e){e===void 0&&(e=li);var n=e.name||"Reaction@"+xt(),o=x(n,e.onError?Ed(e.onError,t):t),i=!e.scheduler&&!e.delay,a=Us(e),s=!0,l=!1,u,f=e.compareStructural?Ke.structural:e.equals||Ke.default,d=new Tr(n,function(){s||i?c():l||(l=!0,a(c))},e.onError,e.requiresObservable);function c(){if(l=!1,!d.isDisposed){var p=!1;d.track(function(){var v=r(d);p=s||!f(u,v),u=v}),s&&e.fireImmediately&&o(u,d),!s&&p===!0&&o(u,d),s&&(s=!1)}}return d.schedule(),d.getDisposer()}function Ed(r,t){return function(){try{return t.apply(this,arguments)}catch(e){r.call(this,e)}}}function bd(r,t,e){return Ws("onBecomeObserved",r,t)}function Vs(r,t,e){return Ws("onBecomeUnobserved",r,t)}function Ws(r,t,e,n){var o=_e(t),i=e,a=r+"Listeners";o[a]?o[a].add(i):o[a]=new Set([i]);var s=o[r];return typeof s!="function"?W(!1):function(){var l=o[a];l&&(l.delete(i),l.size===0&&delete o[a])}}function Od(r){var t=r.enforceActions,e=r.computedRequiresReaction,n=r.computedConfigurable,o=r.disableErrorBoundaries,i=r.reactionScheduler,a=r.reactionRequiresObservable,s=r.observableRequiresReaction;if(sd(),t!==void 0){var l=void 0;switch(t){case!0:case"observed":l=!0;break;case!1:case"never":l=!1;break;case"strict":case"always":l="strict";break;default:W("Invalid value for 'enforceActions': '"+t+"', expected 'never', 'always' or 'observed'")}N.enforceActions=l,N.allowStateChanges=!(l===!0||l==="strict")}e!==void 0&&(N.computedRequiresReaction=!!e),a!==void 0&&(N.reactionRequiresObservable=!!a),s!==void 0&&(N.observableRequiresReaction=!!s,N.allowStateReads=!N.observableRequiresReaction),n!==void 0&&(N.computedConfigurable=!!n),o!==void 0&&(o===!0&&console.warn("WARNING: Debug feature only. MobX will NOT recover from errors when `disableErrorBoundaries` is enabled."),N.disableErrorBoundaries=!!o),i&&pd(i)}function Po(r,t,e,n){n=He(n);var o=Ks(n);return Ce(r),gi(r,n.name,o.enhancer),t&&Zs(r,t,e,o),r}function Ks(r){return r.defaultDecorator||(r.deep===!1?Rs:pi)}function Zs(r,t,e,n){var o,i,a,s,l,u;Ht();try{var a=Yu(t);try{for(var f=Zt(a),d=f.next();!d.done;d=f.next()){var u=d.value,c=Object.getOwnPropertyDescriptor(t,u),p=e&&u in e?e[u]:c.get?En:n,v=p(r,u,c,!0);v&&Object.defineProperty(r,u,v)}}catch(g){o={error:g}}finally{try{d&&!d.done&&(i=f.return)&&i.call(f)}finally{if(o)throw o.error}}}finally{Yt()}}function Sd(r,t){return qs(_e(r,t))}function qs(r){var t={name:r.name};return r.observing&&r.observing.length>0&&(t.dependencies=Bu(r.observing).map(qs)),t}function Js(r,t){if(r==null)return!1;if(t!==void 0){if(Ft(r)===!1||!r[L].values.has(t))return!1;var e=_e(r,t);return Je(e)}return Je(r)}function wd(r){return arguments.length>1?W(!1):Js(r)}function Ri(r,t){return typeof t!="string"?W(!1):Js(r,t)}function Md(r,t){return r==null?!1:Ft(r)||!!r[L]||di(r)||Sn(r)||Je(r)}function Qe(r){return arguments.length!==1&&W(!1),Md(r)}function tr(r){return Ft(r)?r[L].getKeys():Et(r)||Dt(r)?Array.from(r.keys()):ee(r)?r.map(function(t,e){return e}):W(!1)}function Ad(r){return Ft(r)?tr(r).map(function(t){return r[t]}):Et(r)?tr(r).map(function(t){return r.get(t)}):Dt(r)?Array.from(r.values()):ee(r)?r.slice():W(!1)}function Pd(r){return Ft(r)?tr(r).map(function(t){return[t,r[t]]}):Et(r)?tr(r).map(function(t){return[t,r.get(t)]}):Dt(r)?Array.from(r.entries()):ee(r)?r.map(function(t,e){return[e,t]}):W(!1)}function vi(r,t,e){if(arguments.length===2&&!Dt(r)){Ht();var n=t;try{for(var o in n)vi(r,o,n[o])}finally{Yt()}return}if(Ft(r)){var i=r[L],a=i.values.get(t);a?i.write(t,e):i.addObservableProp(t,e,i.defaultEnhancer)}else if(Et(r))r.set(t,e);else if(Dt(r))r.add(t);else if(ee(r))typeof t!="number"&&(t=parseInt(t,10)),Ae(t>=0,"Not a valid index: '"+t+"'"),Ht(),t>=r.length&&(r.length=t+1),r[t]=e,Yt();else return W(!1)}function Qs(r,t,e,n){return Td(r,t,e)}function Td(r,t,e){return Zn(r).observe(t,e)}var Dd={detectCycles:!0,exportMapsAsObjects:!0,recurseEverything:!1};function je(r,t,e,n){return n.detectCycles&&r.set(t,e),e}function de(r,t,e){if(!t.recurseEverything&&!Qe(r)||typeof r!="object")return r;if(r===null)return null;if(r instanceof Date)return r;if(id(r))return de(r.get(),t,e);Qe(r)&&tr(r);var n=t.detectCycles===!0;if(n&&r!==null&&e.has(r))return e.get(r);if(ee(r)||Array.isArray(r)){var o=je(e,r,[],t),i=r.map(function(p){return de(p,t,e)});o.length=i.length;for(var a=0,s=i.length;a<s;a++)o[a]=i[a];return o}if(Dt(r)||Object.getPrototypeOf(r)===Set.prototype)if(t.exportMapsAsObjects===!1){var l=je(e,r,new Set,t);return r.forEach(function(p){l.add(de(p,t,e))}),l}else{var u=je(e,r,[],t);return r.forEach(function(p){u.push(de(p,t,e))}),u}if(Et(r)||Object.getPrototypeOf(r)===Map.prototype)if(t.exportMapsAsObjects===!1){var f=je(e,r,new Map,t);return r.forEach(function(p,v){f.set(v,de(p,t,e))}),f}else{var d=je(e,r,{},t);return r.forEach(function(p,v){d[v]=de(p,t,e)}),d}var c=je(e,r,{},t);return Ts(r).forEach(function(p){c[p]=de(r[p],t,e)}),c}function Vt(r,t){typeof t=="boolean"&&(t={detectCycles:t}),t||(t=Dd),t.detectCycles=t.detectCycles===void 0?t.recurseEverything===!0:t.detectCycles===!0;var e;return t.detectCycles&&(e=new Map),de(r,t,e)}function Nd(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];var e=!1;typeof r[r.length-1]=="boolean"&&(e=r.pop());var n=Cd(r);if(!n)return W(!1);n.isTracing===Jt.NONE&&console.log("[mobx.trace] '"+n.name+"' tracing enabled"),n.isTracing=e?Jt.BREAK:Jt.LOG}function Cd(r){switch(r.length){case 0:return N.trackingDerivation;case 1:return _e(r[0]);case 2:return _e(r[0],r[1])}}function It(r,t){t===void 0&&(t=void 0),Ht();try{return r.apply(t)}finally{Yt()}}function Vr(r){return r[L]}function Wr(r){return typeof r=="string"||typeof r=="number"||typeof r=="symbol"}var Rd={has:function(r,t){if(t===L||t==="constructor"||t===xn)return!0;var e=Vr(r);return Wr(t)?e.has(t):t in r},get:function(r,t){if(t===L||t==="constructor"||t===xn)return r[t];var e=Vr(r),n=e.values.get(t);if(n instanceof sr){var o=n.get();return o===void 0&&e.has(t),o}return Wr(t)&&e.has(t),r[t]},set:function(r,t,e){return Wr(t)?(vi(r,t,e),!0):!1},deleteProperty:function(r,t){if(!Wr(t))return!1;var e=Vr(r);return e.remove(t),!0},ownKeys:function(r){var t=Vr(r);return t.keysAtom.reportObserved(),Reflect.ownKeys(r)},preventExtensions:function(r){return W("Dynamic observable objects cannot be frozen"),!1}};function jd(r){var t=new Proxy(r,Rd);return r[L].proxy=t,t}function Qt(r){return r.interceptors!==void 0&&r.interceptors.length>0}function Yr(r,t){var e=r.interceptors||(r.interceptors=[]);return e.push(t),Ps(function(){var n=e.indexOf(t);n!==-1&&e.splice(n,1)})}function te(r,t){var e=lr();try{for(var n=ci(r.interceptors||[]),o=0,i=n.length;o<i&&(t=n[o](t),Ae(!t||t.type,"Intercept handlers should return nothing or a change object"),!!t);o++);return t}finally{ge(e)}}function Gt(r){return r.changeListeners!==void 0&&r.changeListeners.length>0}function Gr(r,t){var e=r.changeListeners||(r.changeListeners=[]);return e.push(t),Ps(function(){var n=e.indexOf(t);n!==-1&&e.splice(n,1)})}function zt(r,t){var e=lr(),n=r.changeListeners;if(n){n=n.slice();for(var o=0,i=n.length;o<i;o++)n[o](t);ge(e)}}var Ld=1e4,Id={get:function(r,t){return t===L?r[L]:t==="length"?r[L].getArrayLength():typeof t=="number"?ie.get.call(r,t):typeof t=="string"&&!isNaN(t)?ie.get.call(r,parseInt(t)):ie.hasOwnProperty(t)?ie[t]:r[t]},set:function(r,t,e){return t==="length"&&r[L].setArrayLength(e),typeof t=="number"&&ie.set.call(r,t,e),typeof t=="symbol"||isNaN(t)?r[t]=e:ie.set.call(r,parseInt(t),e),!0},preventExtensions:function(r){return W("Observable arrays cannot be frozen"),!1}};function Bd(r,t,e,n){e===void 0&&(e="ObservableArray@"+xt()),n===void 0&&(n=!1);var o=new tl(e,t,n);ku(o.values,L,o);var i=new Proxy(o.values,Id);if(o.proxy=i,r&&r.length){var a=Wn(!0);o.spliceWithArray(0,0,r),Kn(a)}return i}var tl=function(){function r(t,e,n){this.owned=n,this.values=[],this.proxy=void 0,this.lastKnownLength=0,this.atom=new sr(t||"ObservableArray@"+xt()),this.enhancer=function(o,i){return e(o,i,t+"[..]")}}return r.prototype.dehanceValue=function(t){return this.dehancer!==void 0?this.dehancer(t):t},r.prototype.dehanceValues=function(t){return this.dehancer!==void 0&&t.length>0?t.map(this.dehancer):t},r.prototype.intercept=function(t){return Yr(this,t)},r.prototype.observe=function(t,e){return e===void 0&&(e=!1),e&&t({object:this.proxy,type:"splice",index:0,added:this.values.slice(),addedCount:this.values.length,removed:[],removedCount:0}),Gr(this,t)},r.prototype.getArrayLength=function(){return this.atom.reportObserved(),this.values.length},r.prototype.setArrayLength=function(t){if(typeof t!="number"||t<0)throw new Error("[mobx.array] Out of range: "+t);var e=this.values.length;if(t!==e)if(t>e){for(var n=new Array(t-e),o=0;o<t-e;o++)n[o]=void 0;this.spliceWithArray(e,0,n)}else this.spliceWithArray(t,e-t)},r.prototype.updateArrayLength=function(t,e){if(t!==this.lastKnownLength)throw new Error("[mobx] Modification exception: the internal structure of an observable array was changed.");this.lastKnownLength+=e},r.prototype.spliceWithArray=function(t,e,n){var o=this;Ze(this.atom);var i=this.values.length;if(t===void 0?t=0:t>i?t=i:t<0&&(t=Math.max(0,i+t)),arguments.length===1?e=i-t:e==null?e=0:e=Math.max(0,Math.min(e,i-t)),n===void 0&&(n=_n),Qt(this)){var a=te(this,{object:this.proxy,type:"splice",index:t,removedCount:e,added:n});if(!a)return _n;e=a.removedCount,n=a.added}n=n.length===0?n:n.map(function(l){return o.enhancer(l,void 0)});var s=this.spliceItemsIntoValues(t,e,n);return(e!==0||n.length!==0)&&this.notifyArraySplice(t,n,s),this.dehanceValues(s)},r.prototype.spliceItemsIntoValues=function(t,e,n){var o;if(n.length<Ld)return(o=this.values).splice.apply(o,ci([t,e],n));var i=this.values.slice(t,t+e);return this.values=this.values.slice(0,t).concat(n,this.values.slice(t+e)),i},r.prototype.notifyArrayChildUpdate=function(t,e,n){var o=!this.owned&&Pt(),i=Gt(this),a=i||o?{object:this.proxy,type:"update",index:t,newValue:e,oldValue:n}:null;this.atom.reportChanged(),i&&zt(this,a)},r.prototype.notifyArraySplice=function(t,e,n){var o=!this.owned&&Pt(),i=Gt(this),a=i||o?{object:this.proxy,type:"splice",index:t,removed:n,added:e,removedCount:n.length,addedCount:e.length}:null;this.atom.reportChanged(),i&&zt(this,a)},r}(),ie={intercept:function(r){return this[L].intercept(r)},observe:function(r,t){t===void 0&&(t=!1);var e=this[L];return e.observe(r,t)},clear:function(){return this.splice(0)},replace:function(r){var t=this[L];return t.spliceWithArray(0,t.values.length,r)},toJS:function(){return this.slice()},toJSON:function(){return this.toJS()},splice:function(r,t){for(var e=[],n=2;n<arguments.length;n++)e[n-2]=arguments[n];var o=this[L];switch(arguments.length){case 0:return[];case 1:return o.spliceWithArray(r);case 2:return o.spliceWithArray(r,t)}return o.spliceWithArray(r,t,e)},spliceWithArray:function(r,t,e){var n=this[L];return n.spliceWithArray(r,t,e)},push:function(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];var e=this[L];return e.spliceWithArray(e.values.length,0,r),e.values.length},pop:function(){return this.splice(Math.max(this[L].values.length-1,0),1)[0]},shift:function(){return this.splice(0,1)[0]},unshift:function(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];var e=this[L];return e.spliceWithArray(0,0,r),e.values.length},reverse:function(){var r=this.slice();return r.reverse.apply(r,arguments)},sort:function(r){var t=this.slice();return t.sort.apply(t,arguments)},remove:function(r){var t=this[L],e=t.dehanceValues(t.values).indexOf(r);return e>-1?(this.splice(e,1),!0):!1},get:function(r){var t=this[L];if(t){if(r<t.values.length)return t.atom.reportObserved(),t.dehanceValue(t.values[r]);console.warn("[mobx.array] Attempt to read an array index ("+r+") that is out of bounds ("+t.values.length+"). Please check length first. Out of bound indices will not be tracked by MobX")}},set:function(r,t){var e=this[L],n=e.values;if(r<n.length){Ze(e.atom);var o=n[r];if(Qt(e)){var i=te(e,{type:"update",object:e.proxy,index:r,newValue:t});if(!i)return;t=i.newValue}t=e.enhancer(t,o);var a=t!==o;a&&(n[r]=t,e.notifyArrayChildUpdate(r,t,o))}else if(r===n.length)e.spliceWithArray(r,0,[t]);else throw new Error("[mobx.array] Index out of bounds, "+r+" is larger than "+n.length)}};["concat","flat","includes","indexOf","join","lastIndexOf","slice","toString","toLocaleString"].forEach(function(r){typeof Array.prototype[r]=="function"&&(ie[r]=function(){var t=this[L];t.atom.reportObserved();var e=t.dehanceValues(t.values);return e[r].apply(e,arguments)})});["every","filter","find","findIndex","flatMap","forEach","map","some"].forEach(function(r){typeof Array.prototype[r]=="function"&&(ie[r]=function(t,e){var n=this,o=this[L];o.atom.reportObserved();var i=o.dehanceValues(o.values);return i[r](function(a,s){return t.call(e,a,s,n)},e)})});["reduce","reduceRight"].forEach(function(r){ie[r]=function(){var t=this,e=this[L];e.atom.reportObserved();var n=arguments[0];return arguments[0]=function(o,i,a){return i=e.dehanceValue(i),n(o,i,a,t)},e.values[r].apply(e.values,arguments)}});var Xd=xe("ObservableArrayAdministration",tl);function ee(r){return ui(r)&&Xd(r[L])}var ji,kd={},yi=function(){function r(t,e,n){if(e===void 0&&(e=Hr),n===void 0&&(n="ObservableMap@"+xt()),this.enhancer=e,this.name=n,this[ji]=kd,this._keysAtom=fi(this.name+".keys()"),this[Symbol.toStringTag]="Map",typeof Map!="function")throw new Error("mobx.map requires Map polyfill for the current browser. Check babel-polyfill or core-js/es6/map.js");this._data=new Map,this._hasMap=new Map,this.merge(t)}return r.prototype._has=function(t){return this._data.has(t)},r.prototype.has=function(t){var e=this;if(!N.trackingDerivation)return this._has(t);var n=this._hasMap.get(t);if(!n){var o=n=new Te(this._has(t),$n,this.name+"."+ve(t)+"?",!1);this._hasMap.set(t,o),Vs(o,function(){return e._hasMap.delete(t)})}return n.get()},r.prototype.set=function(t,e){var n=this._has(t);if(Qt(this)){var o=te(this,{type:n?"update":"add",object:this,newValue:e,name:t});if(!o)return this;e=o.newValue}return n?this._updateValue(t,e):this._addValue(t,e),this},r.prototype.delete=function(t){var e=this;if(Ze(this._keysAtom),Qt(this)){var n=te(this,{type:"delete",object:this,name:t});if(!n)return!1}if(this._has(t)){var o=Pt(),i=Gt(this),n=i||o?{type:"delete",object:this,oldValue:this._data.get(t).value,name:t}:null;return It(function(){e._keysAtom.reportChanged(),e._updateHasMapEntry(t,!1);var s=e._data.get(t);s.setNewValue(void 0),e._data.delete(t)}),i&&zt(this,n),!0}return!1},r.prototype._updateHasMapEntry=function(t,e){var n=this._hasMap.get(t);n&&n.setNewValue(e)},r.prototype._updateValue=function(t,e){var n=this._data.get(t);if(e=n.prepareNewValue(e),e!==N.UNCHANGED){var o=Pt(),i=Gt(this),a=i||o?{type:"update",object:this,oldValue:n.value,name:t,newValue:e}:null;n.setNewValue(e),i&&zt(this,a)}},r.prototype._addValue=function(t,e){var n=this;Ze(this._keysAtom),It(function(){var s=new Te(e,n.enhancer,n.name+"."+ve(t),!1);n._data.set(t,s),e=s.value,n._updateHasMapEntry(t,!0),n._keysAtom.reportChanged()});var o=Pt(),i=Gt(this),a=i||o?{type:"add",object:this,name:t,newValue:e}:null;i&&zt(this,a)},r.prototype.get=function(t){return this.has(t)?this.dehanceValue(this._data.get(t).get()):this.dehanceValue(void 0)},r.prototype.dehanceValue=function(t){return this.dehancer!==void 0?this.dehancer(t):t},r.prototype.keys=function(){return this._keysAtom.reportObserved(),this._data.keys()},r.prototype.values=function(){var t=this,e=this.keys();return wn({next:function(){var n=e.next(),o=n.done,i=n.value;return{done:o,value:o?void 0:t.get(i)}}})},r.prototype.entries=function(){var t=this,e=this.keys();return wn({next:function(){var n=e.next(),o=n.done,i=n.value;return{done:o,value:o?void 0:[i,t.get(i)]}}})},r.prototype[ji=L,Symbol.iterator]=function(){return this.entries()},r.prototype.forEach=function(t,e){var n,o;try{for(var i=Zt(this),a=i.next();!a.done;a=i.next()){var s=Ge(a.value,2),l=s[0],u=s[1];t.call(e,u,l,this)}}catch(f){n={error:f}}finally{try{a&&!a.done&&(o=i.return)&&o.call(i)}finally{if(n)throw n.error}}},r.prototype.merge=function(t){var e=this;return Et(t)&&(t=t.toJS()),It(function(){var n=Wn(!0);try{or(t)?Ts(t).forEach(function(o){return e.set(o,t[o])}):Array.isArray(t)?t.forEach(function(o){var i=Ge(o,2),a=i[0],s=i[1];return e.set(a,s)}):ar(t)?(t.constructor!==Map&&W("Cannot initialize from classes that inherit from Map: "+t.constructor.name),t.forEach(function(o,i){return e.set(i,o)})):t!=null&&W("Cannot initialize map from "+t)}finally{Kn(n)}}),this},r.prototype.clear=function(){var t=this;It(function(){Ls(function(){var e,n;try{for(var o=Zt(t.keys()),i=o.next();!i.done;i=o.next()){var a=i.value;t.delete(a)}}catch(s){e={error:s}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}})})},r.prototype.replace=function(t){var e=this;return It(function(){var n,o,i,a,s=Xu(t),l=new Map,u=!1;try{for(var f=Zt(e._data.keys()),d=f.next();!d.done;d=f.next()){var c=d.value;if(!s.has(c)){var p=e.delete(c);if(p)u=!0;else{var v=e._data.get(c);l.set(c,v)}}}}catch(O){n={error:O}}finally{try{d&&!d.done&&(o=f.return)&&o.call(f)}finally{if(n)throw n.error}}try{for(var h=Zt(s.entries()),g=h.next();!g.done;g=h.next()){var y=Ge(g.value,2),c=y[0],v=y[1],_=e._data.has(c);if(e.set(c,v),e._data.has(c)){var S=e._data.get(c);l.set(c,S),_||(u=!0)}}}catch(O){i={error:O}}finally{try{g&&!g.done&&(a=h.return)&&a.call(h)}finally{if(i)throw i.error}}if(!u)if(e._data.size!==l.size)e._keysAtom.reportChanged();else for(var M=e._data.keys(),w=l.keys(),A=M.next(),m=w.next();!A.done;){if(A.value!==m.value){e._keysAtom.reportChanged();break}A=M.next(),m=w.next()}e._data=l}),this},Object.defineProperty(r.prototype,"size",{get:function(){return this._keysAtom.reportObserved(),this._data.size},enumerable:!0,configurable:!0}),r.prototype.toPOJO=function(){var t,e,n={};try{for(var o=Zt(this),i=o.next();!i.done;i=o.next()){var a=Ge(i.value,2),s=a[0],l=a[1];n[typeof s=="symbol"?s:ve(s)]=l}}catch(u){t={error:u}}finally{try{i&&!i.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}return n},r.prototype.toJS=function(){return new Map(this)},r.prototype.toJSON=function(){return this.toPOJO()},r.prototype.toString=function(){var t=this;return this.name+"[{ "+Array.from(this.keys()).map(function(e){return ve(e)+": "+(""+t.get(e))}).join(", ")+" }]"},r.prototype.observe=function(t,e){return Gr(this,t)},r.prototype.intercept=function(t){return Yr(this,t)},r}(),Et=xe("ObservableMap",yi),Li,Hd={},el=function(){function r(t,e,n){if(e===void 0&&(e=Hr),n===void 0&&(n="ObservableSet@"+xt()),this.name=n,this[Li]=Hd,this._data=new Set,this._atom=fi(this.name),this[Symbol.toStringTag]="Set",typeof Set!="function")throw new Error("mobx.set requires Set polyfill for the current browser. Check babel-polyfill or core-js/es6/set.js");this.enhancer=function(o,i){return e(o,i,n)},t&&this.replace(t)}return r.prototype.dehanceValue=function(t){return this.dehancer!==void 0?this.dehancer(t):t},r.prototype.clear=function(){var t=this;It(function(){Ls(function(){var e,n;try{for(var o=Zt(t._data.values()),i=o.next();!i.done;i=o.next()){var a=i.value;t.delete(a)}}catch(s){e={error:s}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}})})},r.prototype.forEach=function(t,e){var n,o;try{for(var i=Zt(this),a=i.next();!a.done;a=i.next()){var s=a.value;t.call(e,s,s,this)}}catch(l){n={error:l}}finally{try{a&&!a.done&&(o=i.return)&&o.call(i)}finally{if(n)throw n.error}}},Object.defineProperty(r.prototype,"size",{get:function(){return this._atom.reportObserved(),this._data.size},enumerable:!0,configurable:!0}),r.prototype.add=function(t){var e=this;if(Ze(this._atom),Qt(this)){var n=te(this,{type:"add",object:this,newValue:t});if(!n)return this}if(!this.has(t)){It(function(){e._data.add(e.enhancer(t,void 0)),e._atom.reportChanged()});var o=Pt(),i=Gt(this),n=i||o?{type:"add",object:this,newValue:t}:null;i&&zt(this,n)}return this},r.prototype.delete=function(t){var e=this;if(Qt(this)){var n=te(this,{type:"delete",object:this,oldValue:t});if(!n)return!1}if(this.has(t)){var o=Pt(),i=Gt(this),n=i||o?{type:"delete",object:this,oldValue:t}:null;return It(function(){e._atom.reportChanged(),e._data.delete(t)}),i&&zt(this,n),!0}return!1},r.prototype.has=function(t){return this._atom.reportObserved(),this._data.has(this.dehanceValue(t))},r.prototype.entries=function(){var t=0,e=Array.from(this.keys()),n=Array.from(this.values());return wn({next:function(){var o=t;return t+=1,o<n.length?{value:[e[o],n[o]],done:!1}:{done:!0}}})},r.prototype.keys=function(){return this.values()},r.prototype.values=function(){this._atom.reportObserved();var t=this,e=0,n=Array.from(this._data.values());return wn({next:function(){return e<n.length?{value:t.dehanceValue(n[e++]),done:!1}:{done:!0}}})},r.prototype.replace=function(t){var e=this;return Dt(t)&&(t=t.toJS()),It(function(){var n=Wn(!0);try{Array.isArray(t)?(e.clear(),t.forEach(function(o){return e.add(o)})):kr(t)?(e.clear(),t.forEach(function(o){return e.add(o)})):t!=null&&W("Cannot initialize set from "+t)}finally{Kn(n)}}),this},r.prototype.observe=function(t,e){return Gr(this,t)},r.prototype.intercept=function(t){return Yr(this,t)},r.prototype.toJS=function(){return new Set(this)},r.prototype.toString=function(){return this.name+"[ "+Array.from(this).join(", ")+" ]"},r.prototype[Li=L,Symbol.iterator]=function(){return this.values()},r}(),Dt=xe("ObservableSet",el),rl=function(){function r(t,e,n,o){e===void 0&&(e=new Map),this.target=t,this.values=e,this.name=n,this.defaultEnhancer=o,this.keysAtom=new sr(n+".keys")}return r.prototype.read=function(t){return this.values.get(t).get()},r.prototype.write=function(t,e){var n=this.target,o=this.values.get(t);if(o instanceof qe){o.set(e);return}if(Qt(this)){var i=te(this,{type:"update",object:this.proxy||n,name:t,newValue:e});if(!i)return;e=i.newValue}if(e=o.prepareNewValue(e),e!==N.UNCHANGED){var a=Gt(this),s=Pt(),i=a||s?{type:"update",object:this.proxy||n,oldValue:o.value,name:t,newValue:e}:null;o.setNewValue(e),a&&zt(this,i)}},r.prototype.has=function(t){var e=this.pendingKeys||(this.pendingKeys=new Map),n=e.get(t);if(n)return n.get();var o=!!this.values.get(t);return n=new Te(o,$n,this.name+"."+ve(t)+"?",!1),e.set(t,n),n.get()},r.prototype.addObservableProp=function(t,e,n){n===void 0&&(n=this.defaultEnhancer);var o=this.target;if(Qt(this)){var i=te(this,{object:this.proxy||o,name:t,type:"add",newValue:e});if(!i)return;e=i.newValue}var a=new Te(e,n,this.name+"."+ve(t),!1);this.values.set(t,a),e=a.value,Object.defineProperty(o,t,Yd(t)),this.notifyPropertyAddition(t,e)},r.prototype.addComputedProp=function(t,e,n){var o=this.target;n.name=n.name||this.name+"."+ve(e),this.values.set(e,new qe(n)),(t===o||Hu(t,e))&&Object.defineProperty(t,e,Gd(e))},r.prototype.remove=function(t){if(this.values.has(t)){var e=this.target;if(Qt(this)){var n=te(this,{object:this.proxy||e,name:t,type:"remove"});if(!n)return}try{Ht();var o=Gt(this),i=Pt(),a=this.values.get(t),s=a&&a.get();if(a&&a.set(void 0),this.keysAtom.reportChanged(),this.values.delete(t),this.pendingKeys){var l=this.pendingKeys.get(t);l&&l.set(!1)}delete this.target[t];var n=o||i?{type:"remove",object:this.proxy||e,oldValue:s,name:t}:null;o&&zt(this,n)}finally{Yt()}}},r.prototype.illegalAccess=function(t,e){console.warn("Property '"+e+"' of '"+t+"' was accessed through the prototype chain. Use 'decorate' instead to declare the prop or access it statically through it's owner")},r.prototype.observe=function(t,e){return Gr(this,t)},r.prototype.intercept=function(t){return Yr(this,t)},r.prototype.notifyPropertyAddition=function(t,e){var n=Gt(this),o=Pt(),i=n||o?{type:"add",object:this.proxy||this.target,name:t,newValue:e}:null;if(n&&zt(this,i),this.pendingKeys){var a=this.pendingKeys.get(t);a&&a.set(!0)}this.keysAtom.reportChanged()},r.prototype.getKeys=function(){var t,e;this.keysAtom.reportObserved();var n=[];try{for(var o=Zt(this.values),i=o.next();!i.done;i=o.next()){var a=Ge(i.value,2),s=a[0],l=a[1];l instanceof Te&&n.push(s)}}catch(u){t={error:u}}finally{try{i&&!i.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}return n},r}();function gi(r,t,e){if(t===void 0&&(t=""),e===void 0&&(e=Hr),Object.prototype.hasOwnProperty.call(r,L))return r[L];or(r)||(t=(r.constructor.name||"ObservableObject")+"@"+xt()),t||(t="ObservableObject@"+xt());var n=new rl(r,new Map,ve(t),e);return ir(r,L,n),n}var Ii=Object.create(null),Bi=Object.create(null);function Yd(r){return Ii[r]||(Ii[r]={configurable:!0,enumerable:!0,get:function(){return this[L].read(r)},set:function(t){this[L].write(r,t)}})}function Xi(r){var t=r[L];return t||(Ce(r),r[L])}function Gd(r){return Bi[r]||(Bi[r]={configurable:N.computedConfigurable,enumerable:!1,get:function(){return Xi(this).read(r)},set:function(t){Xi(this).write(r,t)}})}var zd=xe("ObservableObjectAdministration",rl);function Ft(r){return ui(r)?(Ce(r),zd(r[L])):!1}function _e(r,t){if(typeof r=="object"&&r!==null){if(ee(r))return t!==void 0&&W(!1),r[L].atom;if(Dt(r))return r[L];if(Et(r)){var e=r;if(t===void 0)return e._keysAtom;var n=e._data.get(t)||e._hasMap.get(t);return n||W(!1),n}if(Ce(r),t&&!r[L]&&r[t],Ft(r)){if(!t)return W(!1);var n=r[L].values.get(t);return n||W(!1),n}if(di(r)||Je(r)||Sn(r))return r}else if(typeof r=="function"&&Sn(r[L]))return r[L];return W(!1)}function Zn(r,t){if(r||W("Expecting some object"),t!==void 0)return Zn(_e(r,t));if(di(r)||Je(r)||Sn(r)||Et(r)||Dt(r))return r;if(Ce(r),r[L])return r[L];W(!1)}function Fd(r,t){var e;return t!==void 0?e=_e(r,t):Ft(r)||Et(r)||Dt(r)?e=Zn(r):e=_e(r),e.name}var ki=Object.prototype.toString;function nl(r,t,e){return e===void 0&&(e=-1),To(r,t,e)}function To(r,t,e,n,o){if(r===t)return r!==0||1/r===1/t;if(r==null||t==null)return!1;if(r!==r)return t!==t;var i=typeof r;if(i!=="function"&&i!=="object"&&typeof t!="object")return!1;var a=ki.call(r);if(a!==ki.call(t))return!1;switch(a){case"[object RegExp]":case"[object String]":return""+r==""+t;case"[object Number]":return+r!=+r?+t!=+t:+r==0?1/+r===1/t:+r==+t;case"[object Date]":case"[object Boolean]":return+r==+t;case"[object Symbol]":return typeof Symbol<"u"&&Symbol.valueOf.call(r)===Symbol.valueOf.call(t);case"[object Map]":case"[object Set]":e>=0&&e++;break}r=Hi(r),t=Hi(t);var s=a==="[object Array]";if(!s){if(typeof r!="object"||typeof t!="object")return!1;var l=r.constructor,u=t.constructor;if(l!==u&&!(typeof l=="function"&&l instanceof l&&typeof u=="function"&&u instanceof u)&&"constructor"in r&&"constructor"in t)return!1}if(e===0)return!1;e<0&&(e=-1),n=n||[],o=o||[];for(var f=n.length;f--;)if(n[f]===r)return o[f]===t;if(n.push(r),o.push(t),s){if(f=r.length,f!==t.length)return!1;for(;f--;)if(!To(r[f],t[f],e-1,n,o))return!1}else{var d=Object.keys(r),c=void 0;if(f=d.length,Object.keys(t).length!==f)return!1;for(;f--;)if(c=d[f],!(Ud(t,c)&&To(r[c],t[c],e-1,n,o)))return!1}return n.pop(),o.pop(),!0}function Hi(r){return ee(r)?r.slice():ar(r)||Et(r)||kr(r)||Dt(r)?Array.from(r.entries()):r}function Ud(r,t){return Object.prototype.hasOwnProperty.call(r,t)}function wn(r){return r[Symbol.iterator]=$d,r}function $d(){return this}if(typeof Proxy>"u"||typeof Symbol>"u")throw new Error("[mobx] MobX 5+ requires Proxy and Symbol objects. If your environment doesn't support Symbol or Proxy objects, please downgrade to MobX 4. For React Native Android, consider upgrading JSCore.");typeof __MOBX_DEVTOOLS_GLOBAL_HOOK__=="object"&&__MOBX_DEVTOOLS_GLOBAL_HOOK__.injectMobx({spy:hd,extras:{getDebugName:Fd},$mobx:L});function Vd(r){return!(r.prototype&&r.prototype.render)&&!z.isPrototypeOf(r)}function ol(r){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e=t.prefix,n=e===void 0?"":e,o=t.suffix,i=o===void 0?"":o,a=r.displayName||r.name||r.constructor&&r.constructor.name||"<component>";return n+a+i}var Yi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},il=function(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")},al=function(){function r(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}}(),sl=function(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(r,t):r.__proto__=t)},ll=function(r,t){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:r},Gi=console;function Wd(r){var t=Mo().allowStateChanges;return Mo().allowStateChanges=r,t}function Kd(r){Mo().allowStateChanges=r}function Zd(r,t,e,n,o){var i=Wd(r),a=void 0;try{a=t(e,n,o)}finally{Kd(i)}return a}function zi(r,t){var e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,n=r[t],o=ul[t],i=n?e===!0?function(){o.apply(this,arguments),n.apply(this,arguments)}:function(){n.apply(this,arguments),o.apply(this,arguments)}:o;r[t]=i}function Fi(r,t){if(r==null||t==null||(typeof r>"u"?"undefined":Yi(r))!=="object"||(typeof t>"u"?"undefined":Yi(t))!=="object")return r!==t;var e=Object.keys(r);if(e.length!==Object.keys(t).length)return!0;for(var n=void 0,o=e.length-1;n=e[o];o--)if(t[n]!==r[n])return!0;return!1}var ul={componentWillMount:function(){var t=this,e=ol(this),n=!1,o=!1;function i(d){var c=this[d],p=fi("reactive "+d);Object.defineProperty(this,d,{configurable:!0,enumerable:!0,get:function(){return p.reportObserved(),c},set:function(h){!o&&Fi(c,h)?(c=h,n=!0,p.reportChanged(),n=!1):c=h}})}i.call(this,"props"),i.call(this,"state");var a=this.render.bind(this),s=null,l=!1,u=function(){return s=new Tr(e+".render()",function(){if(!l&&(l=!0,typeof t.componentWillReact=="function"&&t.componentWillReact(),t.__$mobxIsUnmounted!==!0)){var c=!0;try{o=!0,n||z.prototype.forceUpdate.call(t),c=!1}finally{o=!1,c&&s.dispose()}}}),s.reactComponent=t,f.$mobx=s,t.render=f,f(t.props,t.state,t.context)},f=function(c,p,v){l=!1;var h=void 0,g=void 0;if(s.track(function(){try{g=Zd(!1,a,c,p,v)}catch(y){h=y}}),h)throw h;return g};this.render=u},componentWillUnmount:function(){this.render.$mobx&&this.render.$mobx.dispose(),this.__$mobxIsUnmounted=!0},componentDidMount:function(){},componentDidUpdate:function(){},shouldComponentUpdate:function(t,e){return this.state!==e?!0:Fi(this.props,t)}};function _i(r){if(arguments.length>1&&Gi.warn('Mobx observer: Using observer to inject stores is not supported. Use `@connect(["store1", "store2"]) ComponentClass instead or preferably, use `@inject("store1", "store2") @observer ComponentClass` or `inject("store1", "store2")(observer(componentClass))``'),r.isMobxInjector===!0&&Gi.warn("Mobx observer: You are trying to use 'observer' on a component that already has 'inject'. Please apply 'observer' before applying 'inject'"),Vd(r)){var t,e;return _i((e=t=function(o){sl(i,o);function i(){return il(this,i),ll(this,(i.__proto__||Object.getPrototypeOf(i)).apply(this,arguments))}return al(i,[{key:"render",value:function(){return r.call(this,this.props,this.context)}}]),i}(z),t.displayName=ol(r),e))}if(!r)throw new Error("Please pass a valid component to 'observer'");var n=r.prototype||r;return qd(n),r.isMobXReactObserver=!0,r}function qd(r){zi(r,"componentWillMount",!0),zi(r,"componentDidMount"),r.shouldComponentUpdate||(r.shouldComponentUpdate=ul.shouldComponentUpdate)}var Jd=_i(function(r){var t=r.children;return t[0]()});Jd.displayName="Observer";var Qd=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function tf(r,t){return t={exports:{}},r(t,t.exports),t.exports}tf(function(r,t){(function(e,n){r.exports=n()})(Qd,function(){var e={childContextTypes:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},n={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},o=Object.defineProperty,i=Object.getOwnPropertyNames,a=Object.getOwnPropertySymbols,s=Object.getOwnPropertyDescriptor,l=Object.getPrototypeOf,u=l&&l(Object);return function f(d,c,p){if(typeof c!="string"){if(u){var v=l(c);v&&v!==u&&f(d,v,p)}var h=i(c);a&&(h=h.concat(a(c)));for(var g=0;g<h.length;++g){var y=h[g];if(!e[y]&&!n[y]&&(!p||!p[y])){var _=s(c,y);try{o(d,y,_)}catch{}}}return d}return d}})});var Ui={children:!0,key:!0,ref:!0},$i=console;(function(r){sl(t,r);function t(){return il(this,t),ll(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return al(t,[{key:"render",value:function(n){var o=n.children;return o.length>1?$e("div",null," ",o," "):o[0]}},{key:"getChildContext",value:function(){var n={},o=this.context.mobxStores;if(o)for(var i in o)n[i]=o[i];for(var a in this.props)!Ui[a]&&a!=="suppressChangedStoreWarning"&&(n[a]=this.props[a]);return{mobxStores:n}}},{key:"componentWillReceiveProps",value:function(n){if(Object.keys(n).length!==Object.keys(this.props).length&&$i.warn("MobX Provider: The set of provided stores has changed. Please avoid changing stores as the change might not propagate to all children"),!n.suppressChangedStoreWarning)for(var o in n)!Ui[o]&&this.props[o]!==n[o]&&$i.warn("MobX Provider: Provided store '"+o+"' has changed. Please avoid replacing stores as the change might not propagate to all children")}}]),t})(z);if(!z)throw new Error("mobx-preact requires Preact to be available");var Wt,no,Vi,dl=[],pt=H,Wi=pt.__b,Ki=pt.__r,Zi=pt.diffed,qi=pt.__c,Ji=pt.unmount,Qi=pt.__;function ef(){for(var r;r=dl.shift();)if(r.__P&&r.__H)try{r.__H.__h.forEach(vn),r.__H.__h.forEach(Do),r.__H.__h=[]}catch(t){r.__H.__h=[],pt.__e(t,r.__v)}}pt.__b=function(r){Wt=null,Wi&&Wi(r)},pt.__=function(r,t){r&&t.__k&&t.__k.__m&&(r.__m=t.__k.__m),Qi&&Qi(r,t)},pt.__r=function(r){Ki&&Ki(r);var t=(Wt=r.__c).__H;t&&(no===Wt?(t.__h=[],Wt.__h=[],t.__.forEach(function(e){e.__N&&(e.__=e.__N),e.u=e.__N=void 0})):(t.__h.forEach(vn),t.__h.forEach(Do),t.__h=[])),no=Wt},pt.diffed=function(r){Zi&&Zi(r);var t=r.__c;t&&t.__H&&(t.__H.__h.length&&(dl.push(t)!==1&&Vi===pt.requestAnimationFrame||((Vi=pt.requestAnimationFrame)||rf)(ef)),t.__H.__.forEach(function(e){e.u&&(e.__H=e.u),e.u=void 0})),no=Wt=null},pt.__c=function(r,t){t.some(function(e){try{e.__h.forEach(vn),e.__h=e.__h.filter(function(n){return!n.__||Do(n)})}catch(n){t.some(function(o){o.__h&&(o.__h=[])}),t=[],pt.__e(n,e.__v)}}),qi&&qi(r,t)},pt.unmount=function(r){Ji&&Ji(r);var t,e=r.__c;e&&e.__H&&(e.__H.__.forEach(function(n){try{vn(n)}catch(o){t=o}}),e.__H=void 0,t&&pt.__e(t,e.__v))};var ta=typeof requestAnimationFrame=="function";function rf(r){var t,e=function(){clearTimeout(n),ta&&cancelAnimationFrame(t),setTimeout(r)},n=setTimeout(e,100);ta&&(t=requestAnimationFrame(e))}function vn(r){var t=Wt,e=r.__c;typeof e=="function"&&(r.__c=void 0,e()),Wt=t}function Do(r){var t=Wt;r.__c=r.__(),Wt=t}function nf(r,t){for(var e in t)r[e]=t[e];return r}function ea(r,t){for(var e in r)if(e!=="__source"&&!(e in t))return!0;for(var n in t)if(n!=="__source"&&r[n]!==t[n])return!0;return!1}function ra(r,t){this.props=r,this.context=t}(ra.prototype=new z).isPureReactComponent=!0,ra.prototype.shouldComponentUpdate=function(r,t){return ea(this.props,r)||ea(this.state,t)};var na=H.__b;H.__b=function(r){r.type&&r.type.__f&&r.ref&&(r.props.ref=r.ref,r.ref=null),na&&na(r)};var of=H.__e;H.__e=function(r,t,e,n){if(r.then){for(var o,i=t;i=i.__;)if((o=i.__c)&&o.__c)return t.__e==null&&(t.__e=e.__e,t.__k=e.__k),o.__c(r,t)}of(r,t,e,n)};var oa=H.unmount;function fl(r,t,e){return r&&(r.__c&&r.__c.__H&&(r.__c.__H.__.forEach(function(n){typeof n.__c=="function"&&n.__c()}),r.__c.__H=null),(r=nf({},r)).__c!=null&&(r.__c.__P===e&&(r.__c.__P=t),r.__c.__e=!0,r.__c=null),r.__k=r.__k&&r.__k.map(function(n){return fl(n,t,e)})),r}function cl(r,t,e){return r&&e&&(r.__v=null,r.__k=r.__k&&r.__k.map(function(n){return cl(n,t,e)}),r.__c&&r.__c.__P===t&&(r.__e&&e.appendChild(r.__e),r.__c.__e=!0,r.__c.__P=e)),r}function oo(){this.__u=0,this.o=null,this.__b=null}function pl(r){var t=r.__.__c;return t&&t.__a&&t.__a(r)}function Kr(){this.i=null,this.l=null}H.unmount=function(r){var t=r.__c;t&&t.__R&&t.__R(),t&&32&r.__u&&(r.type=null),oa&&oa(r)},(oo.prototype=new z).__c=function(r,t){var e=t.__c,n=this;n.o==null&&(n.o=[]),n.o.push(e);var o=pl(n.__v),i=!1,a=function(){i||(i=!0,e.__R=null,o?o(s):s())};e.__R=a;var s=function(){if(!--n.__u){if(n.state.__a){var l=n.state.__a;n.__v.__k[0]=cl(l,l.__c.__P,l.__c.__O)}var u;for(n.setState({__a:n.__b=null});u=n.o.pop();)u.forceUpdate()}};n.__u++||32&t.__u||n.setState({__a:n.__b=n.__v.__k[0]}),r.then(a,a)},oo.prototype.componentWillUnmount=function(){this.o=[]},oo.prototype.render=function(r,t){if(this.__b){if(this.__v.__k){var e=document.createElement("div"),n=this.__v.__k[0].__c;this.__v.__k[0]=fl(this.__b,e,n.__O=n.__P)}this.__b=null}var o=t.__a&&$e(Ve,null,r.fallback);return o&&(o.__u&=-33),[$e(Ve,null,t.__a?null:r.children),o]};var ia=function(r,t,e){if(++e[1]===e[0]&&r.l.delete(t),r.props.revealOrder&&(r.props.revealOrder[0]!=="t"||!r.l.size))for(e=r.i;e;){for(;e.length>3;)e.pop()();if(e[1]<e[0])break;r.i=e=e[2]}};(Kr.prototype=new z).__a=function(r){var t=this,e=pl(t.__v),n=t.l.get(r);return n[0]++,function(o){var i=function(){t.props.revealOrder?(n.push(o),ia(t,r,n)):o()};e?e(i):i()}},Kr.prototype.render=function(r){this.i=null,this.l=new Map;var t=gn(r.children);r.revealOrder&&r.revealOrder[0]==="b"&&t.reverse();for(var e=t.length;e--;)this.l.set(t[e],this.i=[1,0,this.i]);return r.children},Kr.prototype.componentDidUpdate=Kr.prototype.componentDidMount=function(){var r=this;this.l.forEach(function(t,e){ia(r,e,t)})};var af=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.element")||60103,sf=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image(!S)|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,lf=/^on(Ani|Tra|Tou|BeforeInp|Compo)/,uf=/[A-Z0-9]/g,df=typeof document<"u",ff=function(r){return(typeof Symbol<"u"&&typeof Symbol()=="symbol"?/fil|che|rad/:/fil|che|ra/).test(r)};function aa(r,t,e){return t.__k==null&&(t.textContent=""),Lu(r,t),typeof e=="function"&&e(),r?r.__c:null}z.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(r){Object.defineProperty(z.prototype,r,{configurable:!0,get:function(){return this["UNSAFE_"+r]},set:function(t){Object.defineProperty(this,r,{configurable:!0,writable:!0,value:t})}})});var sa=H.event;function cf(){}function pf(){return this.cancelBubble}function hf(){return this.defaultPrevented}H.event=function(r){return sa&&(r=sa(r)),r.persist=cf,r.isPropagationStopped=pf,r.isDefaultPrevented=hf,r.nativeEvent=r};var vf={enumerable:!1,configurable:!0,get:function(){return this.class}},la=H.vnode;H.vnode=function(r){typeof r.type=="string"&&function(t){var e=t.props,n=t.type,o={},i=n.indexOf("-")===-1;for(var a in e){var s=e[a];if(!(a==="value"&&"defaultValue"in e&&s==null||df&&a==="children"&&n==="noscript"||a==="class"||a==="className")){var l=a.toLowerCase();a==="defaultValue"&&"value"in e&&e.value==null?a="value":a==="download"&&s===!0?s="":l==="translate"&&s==="no"?s=!1:l[0]==="o"&&l[1]==="n"?l==="ondoubleclick"?a="ondblclick":l!=="onchange"||n!=="input"&&n!=="textarea"||ff(e.type)?l==="onfocus"?a="onfocusin":l==="onblur"?a="onfocusout":lf.test(a)&&(a=l):l=a="oninput":i&&sf.test(a)?a=a.replace(uf,"-$&").toLowerCase():s===null&&(s=void 0),l==="oninput"&&o[a=l]&&(a="oninputCapture"),o[a]=s}}n=="select"&&o.multiple&&Array.isArray(o.value)&&(o.value=gn(e.children).forEach(function(u){u.props.selected=o.value.indexOf(u.props.value)!=-1})),n=="select"&&o.defaultValue!=null&&(o.value=gn(e.children).forEach(function(u){u.props.selected=o.multiple?o.defaultValue.indexOf(u.props.value)!=-1:o.defaultValue==u.props.value})),e.class&&!e.className?(o.class=e.class,Object.defineProperty(o,"className",vf)):(e.className&&!e.class||e.class&&e.className)&&(o.class=o.className=e.className),t.props=o}(r),r.$$typeof=af,la&&la(r)};var ua=H.__r;H.__r=function(r){ua&&ua(r),r.__c};var da=H.diffed;H.diffed=function(r){da&&da(r);var t=r.props,e=r.__e;e!=null&&r.type==="textarea"&&"value"in t&&t.value!==e.value&&(e.value=t.value==null?"":t.value)};var yf=0;function b(r,t,e,n,o,i){t||(t={});var a,s,l=t;if("ref"in l)for(s in l={},t)s=="ref"?a=t[s]:l[s]=t[s];var u={type:r,props:l,key:e,ref:a,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--yf,__i:-1,__u:0,__source:o,__self:i};if(typeof r=="function"&&(a=r.defaultProps))for(s in a)l[s]===void 0&&(l[s]=a[s]);return H.vnode&&H.vnode(u),u}var gf=function(r,t){var e={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&t.indexOf(n)<0&&(e[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(r);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(r,n[o])&&(e[n[o]]=r[n[o]]);return e},Dr;(function(r){function t(e){var n=gf(e,[]),o=e.container;if(!o)throw new Error("Ensure the container of LogicFlow is specified and valid.");return Q({},r.defaults,n)}r.get=t})(Dr||(Dr={}));(function(r){r.defaults={background:!1,grid:!1,textEdit:!0,snapline:!0,outline:!1,disabledTools:[]}})(Dr||(Dr={}));var fa={node:!1,edge:!1},_f={node:!0,edge:!0},mf=function(r){return!r||typeof r=="boolean"?r===!0?k(_f):k(fa):ni(k(fa),r)},xf=function(){return zn(window,"navigator.userAgent","").match(/MSIE|Trident/)!==null};function vt(r){try{return JSON.parse(JSON.stringify(r))}catch{return r}}var ca=200,Ef=9999,bf=10,V;(function(r){r[r.DEFAULT=1]="DEFAULT",r[r.TEXT_EDIT=2]="TEXT_EDIT",r[r.SHOW_MENU=3]="SHOW_MENU",r[r.ALLOW_CONNECT=4]="ALLOW_CONNECT",r[r.NOT_ALLOW_CONNECT=5]="NOT_ALLOW_CONNECT"})(V||(V={}));var ot;(function(r){r.NODE="node",r.EDGE="edge",r.GRAPH="graph"})(ot||(ot={}));var Y;(function(r){r.NODE="node",r.CIRCLE_NODE="circle-node",r.POLYGON_NODE="polygon-node",r.RECT_NODE="rect-node",r.TEXT_NODE="text-node",r.ELLIPSE_NODE="ellipse-node",r.DIAMOND_NODE="diamond-node",r.HTML_NODE="html-node",r.CUSTOM_HTML_NODE="custom-html-node",r.EDGE="edge",r.LINE_EDGE="line-edge",r.POLYLINE_EDGE="polyline-edge",r.BEZIER_EDGE="bezier-edge",r.GRAPH="graph"})(Y||(Y={}));var C;(function(r){r.ELEMENT_CLICK="element:click",r.NODE_ADD="node:add",r.NODE_DELETE="node:delete",r.NODE_CLICK="node:click",r.NODE_DBCLICK="node:dbclick",r.NODE_GROUP_COPY="node:group-copy-add",r.NODE_DND_ADD="node:dnd-add",r.NODE_DND_DRAG="node:dnd-drag",r.NODE_MOUSEDOWN="node:mousedown",r.NODE_DRAGSTART="node:dragstart",r.NODE_DRAG="node:drag",r.NODE_DROP="node:drop",r.NODE_MOUSEUP="node:mouseup",r.NODE_MOUSEMOVE="node:mousemove",r.NODE_MOUSEENTER="node:mouseenter",r.NODE_MOUSELEAVE="node:mouseleave",r.NODE_CONTEXTMENU="node:contextmenu",r.NODE_ROTATE="node:rotate",r.NODE_RESIZE="node:resize",r.NODE_FOCUS="node:focus",r.NODE_BLUR="node:blur",r.NODE_PROPERTIES_CHANGE="node:properties-change",r.NODE_PROPERTIES_DELETE="node:properties-delete",r.EDGE_ADD="edge:add",r.EDGE_DELETE="edge:delete",r.EDGE_CLICK="edge:click",r.EDGE_DBCLICK="edge:dbclick",r.EDGE_FOCUS="edge:focus",r.EDGE_BLUR="edge:blur",r.EDGE_MOUSEENTER="edge:mouseenter",r.EDGE_MOUSELEAVE="edge:mouseleave",r.EDGE_CONTEXTMENU="edge:contextmenu",r.EDGE_ADJUST="edge:adjust",r.EDGE_EXCHANGE_NODE="edge:exchange-node",r.ANCHOR_CLICK="anchor:click",r.ANCHOR_MOUSEDOWN="anchor:mousedown",r.ANCHOR_DRAGSTART="anchor:dragstart",r.ANCHOR_DRAG="anchor:drag",r.ANCHOR_DROP="anchor:drop",r.ANCHOR_DRAGEND="anchor:dragend",r.ADJUST_POINT_MOUSEDOWN="adjustPoint:mousedown",r.ADJUST_POINT_MOUSEUP="adjustPoint:mouseup",r.ADJUST_POINT_MOUSEMOVE="adjustPoint:mousemove",r.ADJUST_POINT_DRAGSTART="adjustPoint:dragstart",r.ADJUST_POINT_DRAG="adjustPoint:drag",r.ADJUST_POINT_DROP="adjustPoint:drop",r.ADJUST_POINT_DRAGEND="adjustPoint:dragend",r.BLANK_MOUSEDOWN="blank:mousedown",r.BLANK_DRAGSTART="blank:dragstart",r.BLANK_DRAG="blank:drag",r.BLANK_DROP="blank:drop",r.BLANK_MOUSEMOVE="blank:mousemove",r.BLANK_MOUSEUP="blank:mouseup",r.BLANK_CLICK="blank:click",r.BLANK_CONTEXTMENU="blank:contextmenu",r.SELECTION_MOUSEDOWN="selection:mousedown",r.SELECTION_DRAGSTART="selection:dragstart",r.SELECTION_DRAG="selection:drag",r.SELECTION_DROP="selection:drop",r.SELECTION_MOUSEMOVE="selection:mousemove",r.SELECTION_MOUSEUP="selection:mouseup",r.SELECTION_CONTEXTMENU="selection:contextmenu",r.CONNECTION_NOT_ALLOWED="connection:not-allowed",r.TEXT_MOUSEDOWN="text:mousedown",r.TEXT_DRAGSTART="text:dragstart",r.TEXT_DRAG="text:drag",r.TEXT_DROP="text:drop",r.TEXT_CLICK="text:click",r.TEXT_DBCLICK="text:dbclick",r.TEXT_BLUR="text:blur",r.TEXT_MOUSEMOVE="text:mousemove",r.TEXT_MOUSEUP="text:mouseup",r.TEXT_FOCUS="text:focus",r.TEXT_ADD="text:add",r.TEXT_UPDATE="text:update",r.TEXT_CLEAR="text:clear",r.LABEL_MOUSEDOWN="label:mousedown",r.LABEL_DRAGSTART="label:dragstart",r.LABEL_DRAG="label:drag",r.LABEL_DROP="label:drop",r.LABEL_CLICK="label:click",r.LABEL_DBCLICK="label:dbclick",r.LABEL_BLUR="label:blur",r.LABEL_MOUSEMOVE="label:mousemove",r.LABEL_MOUSEUP="label:mouseup",r.LABEL_FOCUS="label:focus",r.LABEL_ADD="label:add",r.LABEL_UPDATE="label:update",r.LABEL_CLEAR="label:clear",r.LABEL_DELETE="label:delete",r.LABEL_SHOULD_ADD="label:should-add",r.LABEL_BATCH_ADD="label:batch-add",r.LABEL_SHOULD_UPDATE="label:should-update",r.LABEL_SHOULD_DELETE="label:should-delete",r.LABEL_BATCH_DELETE="label:batch-delete",r.LABEL_NOT_ALLOWED_ADD="label:not-allowed-add",r.HISTORY_CHANGE="history:change",r.GRAPH_TRANSFORM="graph:transform",r.GRAPH_RENDERED="graph:rendered",r.GRAPH_UPDATED="graph:updated"})(C||(C={}));var Bt;(function(r){r[r.DEFAULT=0]="DEFAULT",r[r.INCREASE=1]="INCREASE"})(Bt||(Bt={}));var rt;(function(r){r.HORIZONTAL="horizontal",r.VERTICAL="vertical"})(rt||(rt={}));var Tt;(function(r){r.TEXT="text",r.LABEL="label"})(Tt||(Tt={}));var Of=0,re=function(){function r(t){var e=t.onDragStart,n=e===void 0?eo:e,o=t.onDragging,i=o===void 0?eo:o,a=t.onDragEnd,s=a===void 0?eo:a,l=t.eventType,u=l===void 0?"":l,f=t.eventCenter,d=t.step,c=d===void 0?1:d,p=t.isStopPropagation,v=p===void 0?!0:p,h=t.model,g=t.data,y=this;this.isDragging=!1,this.isStartDragging=!1,this.startX=0,this.startY=0,this.sumDeltaX=0,this.sumDeltaY=0,this.handleMouseDown=function(_){var S,M,w=window==null?void 0:window.document;if(_.button===Of){y.isStopPropagation&&_.stopPropagation(),y.isStartDragging=!0,y.startX=_.clientX,y.startY=_.clientY,w.addEventListener("mousemove",y.handleMouseMove,!1),w.addEventListener("mouseup",y.handleMouseUp,!1);var A=(S=y.model)===null||S===void 0?void 0:S.getData();(M=y.eventCenter)===null||M===void 0||M.emit(C["".concat(y.eventType,"_MOUSEDOWN")],{e:_,data:y.data||A}),y.startTime=new Date().getTime()}},this.handleMouseMove=function(_){var S,M;if(y.isStopPropagation&&_.stopPropagation(),!!y.isStartDragging&&(y.sumDeltaX+=_.clientX-y.startX,y.sumDeltaY+=_.clientY-y.startY,y.startX=_.clientX,y.startY=_.clientY,y.step<=1||Math.abs(y.sumDeltaX)>y.step||Math.abs(y.sumDeltaY)>y.step)){var w=y.sumDeltaX%y.step,A=y.sumDeltaY%y.step,m=y.sumDeltaX-w,O=y.sumDeltaY-A;y.sumDeltaX=w,y.sumDeltaY=A;var P=(S=y.model)===null||S===void 0?void 0:S.getData();y.isDragging||((M=y.eventCenter)===null||M===void 0||M.emit(C["".concat(y.eventType,"_DRAGSTART")],{e:_,data:y.data||P}),y.onDragStart({event:_})),y.isDragging=!0,Promise.resolve().then(function(){var T,B;y.onDragging({deltaX:m,deltaY:O,event:_}),(T=y.eventCenter)===null||T===void 0||T.emit(C["".concat(y.eventType,"_MOUSEMOVE")],{deltaX:m,deltaY:O,e:_,data:y.data||P}),(B=y.eventCenter)===null||B===void 0||B.emit(C["".concat(y.eventType,"_DRAG")],{e:_,data:y.data||P})})}},this.handleMouseUp=function(_){var S=window.document;y.isStartDragging=!1,y.isStopPropagation&&_.stopPropagation(),Promise.resolve().then(function(){var M,w,A;S.removeEventListener("mousemove",y.handleMouseMove,!1),S.removeEventListener("mouseup",y.handleMouseUp,!1);var m=(M=y.model)===null||M===void 0?void 0:M.getData();(w=y.eventCenter)===null||w===void 0||w.emit(C["".concat(y.eventType,"_MOUSEUP")],{e:_,data:y.data||m}),y.isDragging&&(y.isDragging=!1,y.onDragEnd({event:_}),(A=y.eventCenter)===null||A===void 0||A.emit(C["".concat(y.eventType,"_DROP")],{e:_,data:y.data||m}))})},this.cancelDrag=function(){var _=window==null?void 0:window.document;_.removeEventListener("mousemove",y.handleMouseMove,!1),_.removeEventListener("mouseup",y.handleMouseUp,!1),y.onDragEnd({event:void 0}),y.isDragging=!1},this.destroy=function(){y.isStartDragging&&y.cancelDrag()},this.onDragStart=n,this.onDragging=i,this.onDragEnd=s,this.step=c,this.isStopPropagation=v,this.eventType=u,this.eventCenter=f,this.model=h,this.data=g}return r.prototype.setStep=function(t){this.step=t},r.prototype.setModel=function(t){this.model=t},r}(),Sf=function(r){var t=r.x,e=r.y,n=r.width,o=r.height;return{x:t-n/2,y:e-o/2,x1:t+n/2,y1:e+o/2}},wf=function(r){var t=r.startPoint,e=r.endPoint,n=(t.x+e.x)/2,o=(t.y+e.y)/2,i=Math.abs(t.x-e.x)+10,a=Math.abs(t.y-e.y)+10;return{x:n-i/2,y:o-a/2,x1:n+i/2,y1:o+a/2}},Mf=function(r){var t=r.points,e=Re(t),n=Rr(e,8),o=n.x,i=n.y,a=n.width,s=n.height;return{x:o-a/2,y:i-s/2,x1:o+a/2,y1:i+s/2}},Af=function(r){var t=r.path,e=mi(t),n=Rr(e,8),o=n.x,i=n.y,a=n.width,s=n.height;return{x:o-a/2,y:i-s/2,x1:o+a/2,y1:i+s/2}},Pf=function(r){if(r.modelType===Y.LINE_EDGE)return wf(r);if(r.modelType===Y.POLYLINE_EDGE)return Mf(r);if(r.modelType===Y.BEZIER_EDGE)return Af(r)},Tf=function(r,t,e,n){var o=(t.y-r.y)*(n.x-e.x)-(r.x-t.x)*(e.y-n.y);if(o===0)return!1;var i=((t.x-r.x)*(n.x-e.x)*(e.y-r.y)+(t.y-r.y)*(n.x-e.x)*r.x-(n.y-e.y)*(t.x-r.x)*e.x)/o,a=-((t.y-r.y)*(n.y-e.y)*(e.x-r.x)+(t.x-r.x)*(n.y-e.y)*r.y-(n.x-e.x)*(t.y-r.y)*e.y)/o;return(i-r.x)*(i-t.x)<=0&&(a-r.y)*(a-t.y)<=0&&(i-e.x)*(i-n.x)<=0&&(a-e.y)*(a-n.y)<=0?{x:i,y:a}:!1},Nr=function(r,t,e){var n=r.x,o=r.y,i=t.x,a=t.y,s=e.x,l=e.y,u=(l-a)/(s-i),f=a-u*i;return(n>=i&&n<=s||n<=i&&n>=s)&&(o>=a&&o<=l||o<=a&&o>=l)&&Math.abs(o-u*n-f)<Number.EPSILON},Cr=function(r){var t=r.start,e=r.end,n=r.offset,o=r.verticalLength,i=r.type,a={leftX:0,leftY:0,rightX:0,rightY:0},s=Math.atan((e.y-t.y)/(e.x-t.x)),l=Math.atan(n/o),u=Math.sqrt(o*o+n*n);return i==="start"?e.x>=t.x?(a.leftX=t.x+u*Math.sin(s+l),a.leftY=t.y-u*Math.cos(s+l),a.rightX=t.x-u*Math.sin(s-l),a.rightY=t.y+u*Math.cos(s-l)):(a.leftX=t.x-u*Math.sin(s+l),a.leftY=t.y+u*Math.cos(s+l),a.rightX=t.x+u*Math.sin(s-l),a.rightY=t.y-u*Math.cos(s-l)):i==="end"&&(e.x>=t.x?(a.leftX=e.x+u*Math.sin(s-l),a.leftY=e.y-u*Math.cos(s-l),a.rightX=e.x-u*Math.sin(s+l),a.rightY=e.y+u*Math.cos(s+l)):(a.leftX=e.x-u*Math.sin(s-l),a.leftY=e.y+u*Math.cos(s-l),a.rightX=e.x+u*Math.sin(s+l),a.rightY=e.y-u*Math.cos(s+l))),a},ze=function(){return ze=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},ze.apply(this,arguments)},At=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i},ye=function(r,t,e){if(e||arguments.length===2)for(var n=0,o=t.length,i;n<o;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return r.concat(i||Array.prototype.slice.call(t))},Df=function(r,t){return Math.abs(r.centerX-t.centerX)*2<r.width+t.width&&Math.abs(r.centerY-t.centerY)*2<r.height+t.height},No=function(r){var t=[],e={};return r.forEach(function(n){var o="".concat(n.x,"-").concat(n.y);n.id=o,e[o]=n}),Object.keys(e).forEach(function(n){t.push(e[n])}),t},Mn=function(r,t){return r.width===0&&r.height===0?r:{x:r.x,y:r.y,centerX:r.centerX,centerY:r.centerY,minX:r.minX-t,minY:r.minY-t,maxX:r.maxX+t,maxY:r.maxY+t,height:r.height+2*t,width:r.width+2*t}},Nf=function(r,t){var e=Math.abs(r.x-t.centerX),n=Math.abs(r.y-t.centerY);return e/t.width>n/t.height?rt.HORIZONTAL:rt.VERTICAL},An=function(r,t,e){var n=Nf(e,t);return n===rt.HORIZONTAL?{x:e.x>r.centerX?r.maxX:r.minX,y:e.y}:{x:e.x,y:e.y>r.centerY?r.maxY:r.minY}},pa=function(r,t){var e=Math.min(r.minX,t.minX),n=Math.min(r.minY,t.minY),o=Math.max(r.maxX,t.maxX),i=Math.max(r.maxY,t.maxY);return{x:(e+o)/2,y:(n+i)/2,centerX:(e+o)/2,centerY:(n+i)/2,minX:e,minY:n,maxX:o,maxY:i,height:i-n,width:o-e}},Rr=function(r,t){r===void 0&&(r=[]);var e=[],n=[];r.forEach(function(f){e.push(f.x),n.push(f.y)});var o=Math.min.apply(Math,ye([],At(e),!1)),i=Math.max.apply(Math,ye([],At(e),!1)),a=Math.min.apply(Math,ye([],At(n),!1)),s=Math.max.apply(Math,ye([],At(n),!1)),l=i-o,u=s-a;return t&&(l+=t,u+=t),{centerX:(o+i)/2,centerY:(a+s)/2,maxX:i,maxY:s,minX:o,minY:a,x:(o+i)/2,y:(a+s)/2,height:u,width:l}},Pn=function(r){var t=r.minX,e=r.minY,n=r.maxX,o=r.maxY;return[{x:t,y:e},{x:n,y:e},{x:n,y:o},{x:t,y:o}]},Zr=function(r,t){var e=r.x,n=r.y;return e<t.minX||e>t.maxX||n<t.minY||n>t.maxY},Cf=function(r,t){return t<r.minX||t>r.maxX?[]:[{x:t,y:r.minY},{x:t,y:r.maxY}]},Rf=function(r,t){return t<r.minY||t>r.maxY?[]:[{x:r.minX,y:t},{x:r.maxX,y:t}]},jf=function(r,t){return ye(ye([],At(Cf(r,t.x)),!1),At(Rf(r,t.y)),!1)},Co=function(r,t){return Math.abs(r.x-t.x)+Math.abs(r.y-t.y)},Lf=function(r,t){var e=-2,n=0;return t.forEach(function(o){o&&(r.x===o.x&&(n+=e),r.y===o.y&&(n+=e))}),n},ha=function(r,t,e,n,o){return Co(r,t)+Co(r,e)+Lf(r,[t,e,n,o])},hl=function(r,t,e,n,o){o||(o=0),r.unshift(t[n]),e[n]&&e[n]!==n&&o<=100&&hl(r,t,e,e[n],o+1)},If=function(r,t){var e=r.indexOf(t);e>-1&&r.splice(e,1)},hr=function(r,t,e,n){var o=t.x-r.x,i=t.y-r.y,a=n.x-e.x,s=n.y-e.y,l=(-i*(r.x-e.x)+o*(r.y-e.y))/(-a*i+o*s),u=(a*(r.y-e.y)-s*(r.x-e.x))/(-a*i+o*s);return l>=0&&l<=1&&u>=0&&u<=1},va=function(r,t,e){if(e.width===0&&e.height===0)return!1;var n=At(Pn(e),4),o=n[0],i=n[1],a=n[2],s=n[3];return hr(r,t,o,i)||hr(r,t,o,s)||hr(r,t,i,a)||hr(r,t,a,s)},Bf=function(r,t,e,n){var o=[];return r.forEach(function(i){i!==t&&(i.x===t.x||i.y===t.y)&&!va(i,t,e)&&!va(i,t,n)&&o.push(i)}),No(o)},Xf=function(r,t,e,n,o,i,a){var s=[],l=[t],u={},f={},d={};t.id&&(f[t.id]=0,d[t.id]=ha(t,e,t));var c={};r.forEach(function(h){h.id&&(c[h.id]=h)});for(var p=function(){var h,g=1/0;if(l.forEach(function(_){_.id&&d[_.id]<g&&(g=d[_.id],h=_)}),h===e&&e.id){var y=[];return hl(y,c,u,e.id),{value:y}}if(!h)return{value:[t,e]};If(l,h),s.push(h),Bf(r,h,n,o).forEach(function(_){if(s.indexOf(_)===-1&&(l.indexOf(_)===-1&&l.push(_),h!=null&&h.id&&(_!=null&&_.id))){var S=d[h.id]+Co(h,_);if(f[_.id]&&S>=f[_.id])return;u[_.id]=h.id,f[_.id]=S,d[_.id]=f[_.id]+ha(_,e,t,i,a)}})};l.length;){var v=p();if(typeof v=="object")return v.value}return[t,e]},ya=function(r){return Ot(r)},vl=function(r){for(var t=1;t<r.length-1;){var e=r[t-1],n=r[t],o=r[t+1];e.x===n.x&&n.x===o.x||e.y===n.y&&n.y===o.y?r.splice(t,1):t++}return r},ga=function(r,t,e,n,o){var i=ya(e),a=ya(n),s=Mn(i,o),l=Mn(a,o),u=An(s,i,r),f=An(l,a,t);if(Df(s,l)){var d=Hf(r,t,u,f);return ye(ye([r,u],At(d),!1),[f,t],!1)}var c=Rr([u,f]),p=pa(s,c),v=pa(l,c),h=[];h=h.concat(Pn(p)),h=h.concat(Pn(v));var g={x:(r.x+t.x)/2,y:(r.y+t.y)/2};[c,p,v].forEach(function(_){h=h.concat(jf(_,g).filter(function(S){return Zr(S,s)&&Zr(S,l)}))}),[{x:u.x,y:f.y},{x:f.x,y:u.y}].forEach(function(_){Zr(_,s)&&Zr(_,l)&&h.push(_)}),h.unshift(u),h.push(f),h=No(h);var y=Xf(h,u,f,i,a,r,t);return y.unshift(r),y.push(t),y.length>2&&(y=vl(y)),No(y)},kf=function(r){if(r.length===1){var t=At(r,1),e=t[0];return[e,e]}else{for(var n=r[0],o=r[1],i=kt(n.x,n.y,o.x,o.y),a=1;a<r.length-1;a++){var s=r[a],l=r[a+1],u=kt(s.x,s.y,l.x,l.y);u>i&&(i=u,n=s,o=l)}return[n,o]}},_a=function(r,t,e){var n=se(r,e),o=se(t,e);return n&&o},ma=function(r,t,e){var n=se(r,e),o=se(t,e),i=n&&o,a=n||o;return!i&&a},xa=function(r,t,e){for(var n=void 0,o=Ot(e),i=Pn(o),a=0;a<i.length;a++){var s=hr(r,t,i[a],i[(a+1)%i.length]);s&&(n=[i[a],i[(a+1)%i.length]])}if(n)return Tf(r,t,n[0],n[1])},Tn=function(r,t){var e=void 0;return r.x===t.x?e=rt.VERTICAL:r.y===t.y&&(e=rt.HORIZONTAL),e},Re=function(r){var t=r.split(" "),e=[];return t&&t.forEach(function(n){var o=At(n.split(","),2),i=o[0],a=o[1];e.push({x:Number(i),y:Number(a)})}),e},Hf=function(r,t,e,n){var o=[],i=Tn(r,e),a=Tn(t,n);if(i===a)r.y===e.y?(o.push({x:e.x,y:(e.y+n.y)/2}),o.push({x:n.x,y:(e.y+n.y)/2})):(o.push({x:(e.x+n.x)/2,y:e.y}),o.push({x:(e.x+n.x)/2,y:n.y}));else{var s={x:e.x,y:n.y},l=Nr(s,r,e),u=Nr(s,t,n);if(l||u)s={x:n.x,y:e.y};else{var f=Ea(s,r,e),d=Ea(s,t,n);f&&d&&(s={x:n.x,y:e.y})}o.push(s)}return o},Ea=function(r,t,e){return r.x===t.x&&r.x===e.x||r.y===t.y&&r.y===e.y},yl=function(r){if(!r)return 0;for(var t=0,e=0;e<r.length;e++){var n=r.charCodeAt(e);r.match(/[A-Z]/)?t+=1.5:n>=1&&n<=126||n>=65376&&n<=65439?t+=1:t+=2}return t},Yf=function(r){var t=r.start,e=r.end,n;if(t.x===e.x&&t.y===e.y)n="";else{var o={start:t,end:e,offset:10,verticalLength:5},i=Cr(ze(ze({},o),{type:"start"})),a=Cr(ze(ze({},o),{type:"end"}));n="M".concat(i.leftX," ").concat(i.leftY,`
    L`).concat(i.rightX," ").concat(i.rightY,`
    L`).concat(a.rightX," ").concat(a.rightY,`
    L`).concat(a.leftX," ").concat(a.leftY," z")}return{d:n,fill:"transparent",stroke:"transparent",strokeWidth:1,strokeDasharray:"4, 4"}},ba=function(r){var t=r.start,e=r.end,n=r.sourceNode,o=r.targetNode,i=r.offset,a=Ot(n),s=Ot(o),l=Mn(a,i),u=Mn(s,i),f=An(l,a,t),d=An(u,s,e);return{sNext:f,ePre:d}},mi=function(r){var t=r.replace(/M/g,"").replace(/C/g,",").split(","),e=qr(t[0]),n=qr(t[1]),o=qr(t[2]),i=qr(t[3]);return[e,n,o,i]},qr=function(r){var t=At(r.replace(/(^\s*)/g,"").split(" "),2),e=t[0],n=t[1];return{x:+e,y:+n}},Oa=function(r,t){var e=At(r,4),n=e[0],o=e[1],i=e[2],a=e[3],s=Nc(n,o,i,a,t);return[s,r[3]]},gl=function(r,t){for(var e=r.x,n=r.y,o=Re(t),i=Number.MAX_SAFE_INTEGER,a,s=[],l=0;l<o.length;l++)s.push({start:o[l],end:o[(l+1)%o.length]});if(s.forEach(function(c){var p=c.start,v=c.end;if(p.x===v.x){var h={x:p.x,y:n},g=Nr(h,p,v);if(g){var y=Math.abs(p.x-e);y<i&&(i=y,a=h)}}else if(p.y===v.y){var h={x:e,y:p.y},g=Nr(h,p,v);if(g){var y=Math.abs(p.y-n);y<i&&(i=y,a=h)}}}),!a){var u=s[0],f=u.start,d=u.end;a={x:f.x+(d.x-f.x)/2,y:f.y+(d.y-f.y)/2}}return a},Gf=function(r){return Ye(r,["id","type","sourceNodeId","sourceAnchorId","targetNodeId","targetAnchorId","pointsList","startPoint","endPoint","properties"])},Sa=function(r,t){return Math.sqrt(Math.pow(r.x-t.x,2)+Math.pow(r.y-t.y,2))};function zf(r,t){return typeof t!="function"?function(e,n,o){return Object.assign({type:r.edgeType},o)}:function(e,n,o){var i=t(e,n,o);return i?typeof i=="string"?Object.assign({},o,{type:i}):Object.assign({type:i},o):{type:r.edgeType}}}var Ff=function(r){var t=r.rows,e=r.rowsLength,n=r.fontSize,o=0;return at(t,function(i){var a=yl(i);o=a>o?a:o}),{width:Math.ceil(o/2)*n+n/4,height:e*(n+2)+n/4}},Le=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i},Jr=function(r,t,e){if(e||arguments.length===2)for(var n=0,o=t.length,i;n<o;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return r.concat(i||Array.prototype.slice.call(t))};function er(r,t,e){return e&&t*Math.round(r/t)||r}function Uf(r,t,e){if(!r)return[];var n=Math.min.apply(Math,Jr([],Le(r.map(function(h){return h[0]})),!1)),o=Math.max.apply(Math,Jr([],Le(r.map(function(h){return h[0]})),!1)),i=Math.min.apply(Math,Jr([],Le(r.map(function(h){return h[1]})),!1)),a=Math.max.apply(Math,Jr([],Le(r.map(function(h){return h[1]})),!1)),s=-n,l=-i,u=r.map(function(h){var g=Le(h,2),y=g[0],_=g[1];return[y+s,_+l]}),f=o-n,d=a-i,c=t?t/f:1,p=e?e/d:1,v=Math.min(c,p);return u.map(function(h){var g=Le(h,2),y=g[0],_=g[1];return[y*v,_*v]})}var io=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i},ao=function(r,t,e){var n=io(r,2),o=n[0],i=n[1],a=io(t,2),s=a[0],l=a[1],u=io(e,2),f=u[0],d=u[1];return o>s&&o<f&&i>l&&i<d},_l=function(r,t){var e=t.multipleSelectKey,n=!1;switch(e){case"meta":n=r.metaKey;break;case"alt":n=r.altKey;break;case"shift":n=r.shiftKey;break;case"ctrl":n=r.ctrlKey;break;default:n=!1;break}return n},xi=function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();function wa(r,t){return r instanceof ht&&t instanceof ht}var ml=function(r){xi(t,r);function t(e,n,o){var i=r.call(this,3)||this;return i[0]=e,i[1]=n,i[2]=o,i.x=e,i.y=n,i.z=o,Object.setPrototypeOf(i,t.prototype),i}return t.prototype.add=function(e){if(wa(this,e))return new ht(this.x+e.x,this.y+e.y);var n=this.z+e.z;return new Ro((this.x+e.x)/n,(this.y+e.y)/n)},t.prototype.subtract=function(e){if(wa(this,e))return new ht(this.x-e.x,this.y-e.y);var n=this.z-e.z;return n===0?new ht(this.x-e.x,this.y-e.y):new Ro((this.x-e.x)/n,(this.y-e.y)/n)},t}(Array),ht=function(r){xi(t,r);function t(e,n,o){var i=r.call(this,e,n,o??0)||this;return Object.setPrototypeOf(i,t.prototype),i}return t.prototype.toString=function(){return"Vector"},t.prototype.dot=function(e){var n=this;return e.reduce(function(o,i,a){return o+i*n[a]})},t.prototype.cross=function(e){return new t(this.y*e.z-this.z*e.y,this.z*e.x-this.x*e.z,this.x*e.y-this.y*e.x)},t.prototype.getLength=function(){return Math.hypot(this.x,this.y)},t.prototype.normalize=function(){var e=this.getLength();return new t(this.x/e,this.y/e)},t.prototype.crossZ=function(e){return this.x*e.y-this.y*e.x},t.prototype.angle=function(e){var n=this.crossZ(e),o=Math.acos(this.normalize().dot(e.normalize()));return n>=0?o:-o},t}(ml),Ro=function(r){xi(t,r);function t(e,n){var o=r.call(this,e,n,1)||this;return Object.setPrototypeOf(o,t.prototype),o}return t.prototype.toString=function(){return"Point"},t}(ml),qn=function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Ie=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i},so=function(r,t,e){if(e||arguments.length===2)for(var n=0,o=t.length,i;n<o;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return r.concat(i||Array.prototype.slice.call(t))},zr=function(r){qn(t,r);function t(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var o=r.call(this,e.length)||this;return o.fill(new Array(3)),e.forEach(function(i,a){o[a]=i}),o.columns=e[0].length,o.rows=e.length,Object.setPrototypeOf(o,t.prototype),o}return t.prototype.getRow=function(e){return this[e]},t.prototype.getColumn=function(e){return so([],Ie(this.map(function(n){return n[e]})),!1)},t.prototype.transpose=function(){for(var e=[],n=0;n<this.columns;n++)e.push(this.getColumn(n));return new(t.bind.apply(t,so([void 0],Ie(e),!1)))},t.prototype.cross=function(e){var n=new Array(this.rows).fill("").map(function(){return[]});if(this.columns===e.rows)for(var o=0;o<this.rows;o++)for(var i=this.getRow(o),a=function(l){var u=e.getColumn(l);n[o][l]=i.reduce(function(f,d,c){return f+d*u[c]},0)},s=0;s<e.columns;s++)a(s);return new(t.bind.apply(t,so([void 0],Ie(n),!1)))},t.prototype.to2D=function(){return this.map(function(e){return[e[0],e[1]]})},t.prototype.toPoints=function(){return this.map(function(e){return new Ro(e[0],e[1])})},t.prototype.toString=function(){var e=Ie(this[0],2),n=e[0],o=e[1],i=Ie(this[1],2),a=i[0],s=i[1],l=Ie(this[2],2),u=l[0],f=l[1];return"matrix(".concat(n," ").concat(o," ").concat(a," ").concat(s," ").concat(u," ").concat(f,")")},t.prototype.translate=function(e,n){return this.cross(new Dn(e,n))},t.prototype.rotate=function(e){return this.cross(new $f(e))},t.prototype.scale=function(e,n){return this.cross(new Vf(e,n))},t}(Array),$f=function(r){qn(t,r);function t(e){var n=r.call(this,new ht(+Math.cos(e).toFixed(2),+Math.sin(e).toFixed(2),0),new ht(-Math.sin(e).toFixed(2),+Math.cos(e).toFixed(2),0),new ht(0,0,1))||this;return Object.setPrototypeOf(n,t.prototype),n}return t.prototype.inverse=function(){return this.transpose()},t}(zr),Vf=function(r){qn(t,r);function t(e,n){var o=r.call(this,new ht(e,0,0),new ht(0,n,0),new ht(0,0,1))||this;return o.sx=e,o.sy=n,Object.setPrototypeOf(o,t.prototype),o}return t.prototype.inverse=function(){return new t(1/this.sx,1/this.sy)},t}(zr),Dn=function(r){qn(t,r);function t(e,n){var o=r.call(this,new ht(1,0,0),new ht(0,1,0),new ht(e,n,1))||this;return o.tx=e,o.ty=n,Object.setPrototypeOf(o,t.prototype),o}return t.prototype.inverse=function(){return new t(-this.tx,-this.ty)},t}(zr);Od({});var Nn=function(){return Nn=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},Nn.apply(this,arguments)},Wf=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i},jo=function(r){var t=r.anchors;return t},Cn=function(r,t){for(var e=t.nodes,n,o=e.length-1;o>=0;o--){var i=e[o],a=qf(r,i);if(a){var s=i.getTargetAnchor(r);if(s){var l={node:i,anchorIndex:s.index,anchor:s.anchor};(!n||Kf(i,n.node,t))&&(n=l)}}}return n},Kf=function(r,t,e){return r.zIndex>t.zIndex?!0:e.nodesMap[r.id].index>e.nodesMap[t.id].index},Zf=function(r,t){for(var e=jo(t),n,o=Number.MAX_SAFE_INTEGER,i=0;i<e.length;i++){var a=kt(r.x,r.y,e[i].x,e[i].y);a<o&&(o=a,n={index:i,anchor:Nn(Nn({},e[i]),{x:e[i].x,y:e[i].y,id:e[i].id})})}return n},kt=function(r,t,e,n){return Math.hypot(r-e,t-n)},se=function(r,t,e){e===void 0&&(e=0);var n=!1,o=Ot(t),i=Wf(new zr([r.x,r.y,1]).translate(-t.x,-t.y).rotate(-t.rotate).translate(t.x,t.y)[0],2),a=i[0],s=i[1],l={x:a,y:s};return l.x>=o.minX-e&&l.x<=o.maxX+e&&l.y>=o.minY-e&&l.y<=o.maxY+e&&(n=!0),n},qf=function(r,t){return se(r,t,5)},Ot=function(r){var t=r.x,e=r.y,n=r.width,o=r.height;return{minX:t-n/2,minY:e-o/2,maxX:t+n/2,maxY:e+o/2,x:t,y:e,width:n,height:o,centerX:t,centerY:e}},Jf=function(r){var t=r,e=t.x,n=t.y,o=t.width,i=t.height,a=t.radius;return[{x:e-o/2+a,y:n-i/2+a,r:a},{x:e+o/2-a,y:n-i/2+a,r:a},{x:e-o/2+a,y:n+i/2-a,r:a},{x:e+o/2-a,y:n+i/2-a,r:a}]},Ma=function(r,t,e){var n=Jf(e),o,i=Number.MAX_SAFE_INTEGER;return n.forEach(function(a){var s=kt(r.x,r.y,a.x,a.y);s<i&&(i=s,o=a)}),Lo(r,t,o)},Lo=function(r,t,e){var n,o=e.x,i=e.y,a=e.r;if(t===rt.HORIZONTAL){var s=o-Math.sqrt(a*a-(r.y-i)*(r.y-i)),l=o+Math.sqrt(a*a-(r.y-i)*(r.y-i)),u=Math.abs(s-r.x)<Math.abs(l-r.x)?s:l;n={x:u,y:r.y}}else if(t===rt.VERTICAL){var f=i-Math.sqrt(a*a-(r.x-o)*(r.x-o)),d=i+Math.sqrt(a*a-(r.x-o)*(r.x-o)),c=Math.abs(f-r.y)<Math.abs(d-r.y)?f:d;n={x:r.x,y:c}}return n},Aa=function(r,t){var e=t,n=!1,o=e.x,i=e.y,a=e.width,s=e.height,l=e.radius,u={minX:o-a/2+l,maxX:o+a/2-l,minY:i-s/2+l,maxY:i+s/2-l};return r.y===i+s/2||r.y===i-s/2?n=r.x>u.minX&&r.x<u.maxX:(r.x===o+a/2||r.x===o-a/2)&&(n=r.y>u.minY&&r.y<u.maxY),n},Pa=function(r,t,e){var n,o=e,i=o.x,a=o.y,s=o.rx,l=o.ry;if(t===rt.HORIZONTAL){var u=i-Math.sqrt(s*s-(r.y-a)*(r.y-a)*s*s/(l*l)),f=i+Math.sqrt(s*s-(r.y-a)*(r.y-a)*s*s/(l*l)),d=Math.abs(u-r.x)<Math.abs(f-r.x)?u:f;n={x:d,y:r.y}}else if(t===rt.VERTICAL){var c=a-Math.sqrt(l*l-(r.x-i)*(r.x-i)*l*l/(s*s)),p=a+Math.sqrt(l*l-(r.x-i)*(r.x-i)*l*l/(s*s)),v=Math.abs(c-r.y)<Math.abs(p-r.y)?c:p;n={x:r.x,y:v}}return n},Qr=function(r,t,e){for(var n=e.pointsPosition,o=Number.MAX_SAFE_INTEGER,i,a=[],s=0;s<n.length;s++)a.push({start:n[s],end:n[(s+1)%n.length]});return a.forEach(function(l){var u=l.start,f=l.end,d=u,c=f;u.x>f.x&&(d=f,c=u);var p={x:r.x,y:r.y};if(d.x===c.x&&t===rt.HORIZONTAL&&(p={x:d.x,y:r.y}),d.y===c.y&&t===rt.VERTICAL&&(p={x:r.x,y:d.y}),d.x!==c.x&&d.y!==c.y){var v=(c.y-d.y)/(c.x-d.x),h=(d.x*c.y-c.x*d.y)/(d.x-c.x);t===rt.HORIZONTAL?p={x:(r.y-h)/v,y:r.y}:t===rt.VERTICAL&&(p={x:r.x,y:v*r.x+h})}var g=Nr(p,u,f);if(g){var y=kt(p.x,p.y,r.x,r.y);y<o&&(o=y,i=p)}}),i},Qf=function(r){var t=Ye(r,["id","type","x","y","text","label","properties","virtual","rotate","resizable","rotatable"]);return t},Ta=function(r,t,e,n){var o=r.x,i=r.y;return t.x>r.x?o=r.x+e/2:t.x<r.x&&(o=r.x-e/2),t.y>r.y?i=r.y+n/2:t.y<r.y&&(i=r.y-n/2),{x:o,y:i}},xl=function(r){var t=r.rows,e=r.style,n=r.rowsLength,o=r.className,i=document.createElement("div");i.className=o,i.style.fontSize="".concat(e.fontSize),i.style.width="".concat(e.width),i.style.lineHeight="".concat(e.lineHeight),i.style.padding="".concat(e.padding),e.fontFamily&&(i.style.fontFamily="".concat(e.fontFamily)),n>1?t.forEach(function(s){var l=document.createElement("div");l.textContent=s,i.appendChild(l)}):i.textContent=t[0],document.body.appendChild(i);var a=i.clientHeight;return document.body.removeChild(i),a},Da=function(r){var t=r.rows,e=r.rowsLength,n=r.fontSize,o=0;return t&&t.forEach(function(i){var a=yl(i);o=a>o?a:o}),{width:Math.ceil(o/2)*n+n/4,height:e*(n+2)+n/4}},Rn=function(r){return typeof r!="object"?{isAllPass:!!r,msg:r?"":"不允许连接"}:r};let tn;const tc=new Uint8Array(16);function ec(){if(!tn&&(tn=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!tn))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return tn(tc)}const ct=[];for(let r=0;r<256;++r)ct.push((r+256).toString(16).slice(1));function rc(r,t=0){return ct[r[t+0]]+ct[r[t+1]]+ct[r[t+2]]+ct[r[t+3]]+"-"+ct[r[t+4]]+ct[r[t+5]]+"-"+ct[r[t+6]]+ct[r[t+7]]+"-"+ct[r[t+8]]+ct[r[t+9]]+"-"+ct[r[t+10]]+ct[r[t+11]]+ct[r[t+12]]+ct[r[t+13]]+ct[r[t+14]]+ct[r[t+15]]}const nc=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Na={randomUUID:nc};function oc(r,t,e){if(Na.randomUUID&&!r)return Na.randomUUID();r=r||{};const n=r.random||(r.rng||ec)();return n[6]=n[6]&15|64,n[8]=n[8]&63|128,rc(n)}var De=function(){return oc()},gr=new Map,El=function(r){var t=De();function e(){r();var o=gr.get(t);if(o){var i=window.requestAnimationFrame(e);gr.set(t,i)}}var n=window.requestAnimationFrame(e);return gr.set(t,n),t},jn=function(r){var t=gr.get(r);t&&(window.cancelAnimationFrame(t),gr.delete(r))},jr=function(){return jr=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},jr.apply(this,arguments)},ic=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i};function bl(r){var t=r.x,e=t===void 0?0:t,n=r.y,o=n===void 0?0:n,i=r.value,a=r.fontSize,s=a===void 0?12:a,l=r.fill,u=l===void 0?"currentColor":l,f=r.overflowMode,d=f===void 0?"default":f,c=r.textWidth,p=c===void 0?void 0:c,v=r.model,h={x:e,y:o,fill:u,fontSize:s,textAnchor:"middle",dominantBaseline:"central"};if(at(me(r),function(w){var A=ic(w,2),m=A[0],O=A[1];typeof O!="object"&&(h[m]=O)}),i){var g=String(i).split(/[\r\n]/g),y=g.length;if(d!=="default"){var _=v.BaseType,S=v.modelType;if(_===ot.NODE&&S!==Y.TEXT_NODE||_===ot.EDGE&&p)return ac(r)}if(y>1){var M=g.map(function(w,A){var m=s+2,O=(A-(y-1)/2)*m;return b("tspan",{className:"lf-text-tspan",x:e,y:o+O,children:w})});return b("text",jr({},h,{children:M}))}return b("text",jr({},h,{children:i}))}return null}function ac(r){var t=r.x,e=r.y,n=r.value,o=r.model,i=r.textWidth,a=r.fontSize,s=a===void 0?12:a,l=r.lineHeight,u=r.fontFamily,f=u===void 0?"":u,d=r.wrapPadding,c=d===void 0?"0, 0":d,p=r.overflowMode,v=o.width,h=o.height,g=o.textHeight,y=i||v,_=String(n).split(/[\r\n]/g),S=_.length,M=xl({rows:_,style:{fontSize:"".concat(s,"px"),width:"".concat(y,"px"),fontFamily:f,lineHeight:l,padding:c},rowsLength:S,className:"lf-get-text-height"}),w=h>M?h:M;g&&(w=g);var A=p==="ellipsis";return A&&(w=s+2),b("g",{children:b("foreignObject",{width:y,height:w,x:t-y/2,y:e-w/2,style:{overflow:"visible",textAlign:"left"},children:b("div",{className:"lf-node-text-auto-wrap",style:{minHeight:w,width:y,padding:c},children:b("div",{className:A?"lf-node-text-ellipsis-content":"lf-node-text-auto-wrap-content",title:A?_.join(""):"",style:jr({},r),children:_.map(function(m){return b("div",{className:"lf-node-text--auto-wrap-inner",children:m})})})})})})}var Io=function(){return Io=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},Io.apply(this,arguments)},sc=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i};function rr(r){var t={x1:10,y1:10,x2:20,y2:20,stroke:"black"};return at(me(r),function(e){var n=sc(e,2),o=n[0],i=n[1];(o==="style"||typeof i!="object")&&(t[o]=i)}),b("line",Io({},t))}var Bo=function(){return Bo=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},Bo.apply(this,arguments)},lc=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i};function qt(r){var t=r.x,e=r.y,n=r.width,o=r.height,i=r.className,a=r.strokeWidth,s=r.radius,l=s===void 0?0:s,u=t-n/2,f=e-o/2,d={};return d["stroke-width"]=a,at(me(r),function(c){var p=lc(c,2),v=p[0],h=p[1];typeof h!="object"&&(d[v]=h)}),i?d.className="lf-basic-shape ".concat(i):d.className="lf-basic-shape",l&&(d.rx=l,d.ry=l),d.x=u,d.y=f,b("rect",Bo({},d))}var Xo=function(){return Xo=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},Xo.apply(this,arguments)},uc=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i};function Lr(r){var t={d:""};return at(me(r),function(e){var n=uc(e,2),o=n[0],i=n[1];(o==="style"||typeof i!="object")&&(t[o]=i)}),b("path",Xo({},t))}var ko=function(){return ko=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},ko.apply(this,arguments)},dc=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i};function nr(r){var t=r.x,e=t===void 0?0:t,n=r.y,o=n===void 0?0:n,i=r.r,a=i===void 0?4:i,s=r.className,l={cx:e,cy:o,r:a,fill:"transparent",fillOpacity:1,strokeWidth:1,stroke:"#000",strokeOpacity:1};return at(me(r),function(u){var f=dc(u,2),d=f[0],c=f[1];typeof c!="object"&&(l[d]=c)}),s?l.className="lf-basic-shape ".concat(s):l.className="lf-basic-shape",b("circle",ko({},l))}var Ho=function(){return Ho=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},Ho.apply(this,arguments)},fc=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i};function cc(r){var t=r.x,e=t===void 0?0:t,n=r.y,o=n===void 0?0:n,i=r.rx,a=i===void 0?4:i,s=r.ry,l=s===void 0?4:s,u=r.className,f={cx:e,cy:o,rx:a,ry:l,fill:"transparent",fillOpacity:1,strokeWidth:1,stroke:"#000",strokeOpacity:1};return at(me(r),function(d){var c=fc(d,2),p=c[0],v=c[1];typeof v!="object"&&(f[p]=v)}),u?f.className="lf-basic-shape ".concat(u):f.className="lf-basic-shape",b("ellipse",Ho({},f))}var Yo=function(){return Yo=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},Yo.apply(this,arguments)},pc=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i};function Ol(r){var t=r.points,e=t===void 0?[]:t,n=r.className,o={fill:"transparent",fillOpacity:1,strokeWidth:1,stroke:"#000",strokeOpacity:1,points:""};return at(me(r),function(i){var a=pc(i,2),s=a[0],l=a[1];typeof l!="object"&&(o[s]=l)}),n?o.classNmae="lf-basic-shape ".concat(n):o.className="lf-basic-shape",o.points=e.map(function(i){return i.join(",")}).join(" "),b("polygon",Yo({},o))}var Go=function(){return Go=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},Go.apply(this,arguments)},hc=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i};function vc(r){var t=r.className,e={points:"",fill:"none"};return at(me(r),function(n){var o=hc(n,2),i=o[0],a=o[1];(i==="style"||typeof a!="object")&&(e[i]=a)}),t&&(e.className="".concat(t)),b("polyline",Go({},e))}var Sl=function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Ir=function(){return Ir=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},Ir.apply(this,arguments)},yc=function(r,t){var e={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&t.indexOf(n)<0&&(e[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(r);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(r,n[o])&&(e[n[o]]=r[n[o]]);return e},gc=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i},J;(function(r){r[r.LEFT_TOP=0]="LEFT_TOP",r[r.RIGHT_TOP=1]="RIGHT_TOP",r[r.RIGHT_BOTTOM=2]="RIGHT_BOTTOM",r[r.LEFT_BOTTOM=3]="LEFT_BOTTOM"})(J||(J={}));var _c=function(r){Sl(t,r);function t(e){var n=r.call(this)||this;n.updateEdgePointByAnchors=function(){var s=n.nodeModel,l=s.id,u=s.anchors,f=n.graphModel.getNodeEdges(l);at(f,function(d){if(d.sourceNodeId===l){var c=Ne(u,function(p){return p.id===d.sourceAnchorId});c&&d.updateStartPoint({x:c.x,y:c.y})}else if(d.targetNodeId===l){var c=Ne(u,function(v){return v.id===d.targetAnchorId});c&&d.updateEndPoint({x:c.x,y:c.y})}})},n.triggerResizeEvent=function(s,l,u,f,d,c){n.graphModel.eventCenter.emit(C.NODE_RESIZE,{preData:s,data:l,deltaX:u,deltaY:f,index:d,model:c})},n.recalcResizeInfo=function(s,l,u,f,d){u===void 0&&(u=1),f===void 0&&(f=!1),d===void 0&&(d=!1);var c=k(l),p=c.deltaX,v=c.deltaY,h=c.width,g=c.height,y=c.PCTResizeInfo;if(y){var _=4,S=0,M=0;switch(s){case J.LEFT_TOP:M=(p*-1-v)/_;break;case J.RIGHT_TOP:M=(p-v)/_;break;case J.RIGHT_BOTTOM:M=(p+v)/_;break;case J.LEFT_BOTTOM:M=(p*-1+v)/_;break}M!==0&&(S=Math.round(M/y.ResizeBasis.basisHeight*1e5)/1e3),y.ResizePCT.widthPCT=Math.max(Math.min(y.ResizePCT.widthPCT+S,y.ScaleLimit.maxScaleLimit),y.ScaleLimit.minScaleLimit),y.ResizePCT.heightPCT=Math.max(Math.min(y.ResizePCT.heightPCT+S,y.ScaleLimit.maxScaleLimit),y.ScaleLimit.minScaleLimit);var w=Math.round(y.ResizePCT.widthPCT*y.ResizeBasis.basisWidth/100),A=Math.round(y.ResizePCT.heightPCT*y.ResizeBasis.basisHeight/100);switch(s){case J.LEFT_TOP:p=h-w,v=g-A;break;case J.RIGHT_TOP:p=w-h,v=g-A;break;case J.RIGHT_BOTTOM:p=w-h,v=A-g;break;case J.LEFT_BOTTOM:p=h-w,v=A-g;break}return c}switch(s){case J.LEFT_TOP:c.width=f?h:h-p*u,c.height=d?g:g-v*u;break;case J.RIGHT_TOP:c.width=f?h:h+p*u,c.height=d?g:g-v*u;break;case J.RIGHT_BOTTOM:c.width=f?h:h+p*u,c.height=d?g:g+v*u;break;case J.LEFT_BOTTOM:c.width=f?h:h-p*u,c.height=d?g:g+v*u;break}return c},n.resizeNode=function(s){var l=s.deltaX,u=s.deltaY,f=n.index,d=n.props,c=d.model,p=d.graphModel,v=d.x,h=d.y;Ac({x:v,y:h,deltaX:l,deltaY:u,index:f,nodeModel:c,graphModel:p,cancelCallback:function(){n.dragHandler.cancelDrag()}})},n.onDragStart=function(){n.graphModel.selectNodeById(n.nodeModel.id)},n.onDragging=function(s){var l=s.deltaX,u=s.deltaY,f=n.graphModel.transformModel,d=gc(f.fixDeltaXY(l,u),2),c=d[0],p=d[1];n.resizeNode({deltaX:c,deltaY:p})},n.onDragEnd=function(){var s=n.nodeModel.x,l=n.nodeModel.y;n.nodeModel.moveTo(s,l),n.updateEdgePointByAnchors()};var o=e.index,i=e.model,a=e.graphModel;return n.index=o,n.nodeModel=i,n.graphModel=a,n.dragHandler=new re({onDragStart:n.onDragStart,onDragging:n.onDragging,onDragEnd:n.onDragEnd,step:a.gridSize}),n}return t.prototype.componentWillUnmount=function(){this.dragHandler.destroy()},t.prototype.render=function(){var e=this.props,n=e.x,o=e.y,i=e.direction,a=e.model,s=a.getResizeControlStyle(),l=s.width,u=s.height,f=yc(s,["width","height"]);return b("g",{className:"lf-resize-control lf-resize-control-".concat(i),children:[b(qt,Ir({className:"lf-resize-control-content",x:n,y:o,width:l??7,height:u??7},f)),b(qt,{className:"lf-resize-control-content",x:n,y:o,width:25,height:25,fill:"transparent",stroke:"transparent",onMouseDown:this.dragHandler.handleMouseDown})]})},t}(z),mc=function(r){Sl(t,r);function t(){return r.call(this)||this}return t.prototype.getResizeControl=function(){var e=this.props,n=e.model,o=e.graphModel,i=Ot(n),a=i.minX,s=i.minY,l=i.maxX,u=i.maxY,f=[{index:J.LEFT_TOP,direction:"nw",x:a,y:s},{index:J.RIGHT_TOP,direction:"ne",x:l,y:s},{index:J.RIGHT_BOTTOM,direction:"se",x:l,y:u},{index:J.LEFT_BOTTOM,direction:"sw",x:a,y:u}];return le(f,function(d){return b(_c,Ir({},d,{model:n,graphModel:o}))})},t.prototype.getResizeOutline=function(){var e=this.props.model,n=e.x,o=e.y,i=e.width,a=e.height,s=e.getResizeOutlineStyle();return b(qt,Ir({},s,{x:n,y:o,width:i,height:a}))},t.prototype.render=function(){return b("g",{className:"lf-resize-control-group",children:[this.getResizeOutline(),this.getResizeControl()]})},t}(z);function xc(r,t){var e=r.x,n=r.y,o=t.x,i=t.y,a={x:e+(o-e)/2,y:n+(i-n)/2};return a}function vr(r,t,e){var n=Ec(e),o=r.x-t.x,i=r.y-t.y,a=o*Math.cos(n)-i*Math.sin(n)+t.x,s=o*Math.sin(n)+i*Math.cos(n)+t.y;return{x:a,y:s}}function Ec(r){return r*Math.PI/180}function bc(r){return r/Math.PI*180}function Oc(r,t,e,n,o,i,a,s,l){s===void 0&&(s=!1),l===void 0&&(l=!1);var u=t.deltaX,f=t.deltaY,d=t.width,c=t.height,p=bc(e),v={x:n,y:o},h={x:i,y:a},g=vr(v,h,p),y={x:g.x+u,y:g.y+f},_=Pc(g,y,h,p,s,l,d,c),S=_.width,M=_.height,w=_.center;return t.width=S*r,t.height=M*r,t.deltaX=(w.x-h.x)*2,t.deltaY=(w.y-h.y)*2,t}var Sc=function(r,t,e,n,o,i,a,s,l,u){e===void 0&&(e=1),n===void 0&&(n=!1),o===void 0&&(o=!1),i===void 0&&(i=0);var f=k(t),d=f.deltaX,c=f.deltaY,p=f.width,v=f.height,h=f.PCTResizeInfo;if(h){var g=4,y=0,_=0;switch(r){case J.LEFT_TOP:_=(d*-1-c)/g;break;case J.RIGHT_TOP:_=(d-c)/g;break;case J.RIGHT_BOTTOM:_=(d+c)/g;break;case J.LEFT_BOTTOM:_=(d*-1+c)/g;break}_!==0&&(y=Math.round(_/h.ResizeBasis.basisHeight*1e5)/1e3),h.ResizePCT.widthPCT=Math.max(Math.min(h.ResizePCT.widthPCT+y,h.ScaleLimit.maxScaleLimit),h.ScaleLimit.minScaleLimit),h.ResizePCT.heightPCT=Math.max(Math.min(h.ResizePCT.heightPCT+y,h.ScaleLimit.maxScaleLimit),h.ScaleLimit.minScaleLimit);var S=Math.round(h.ResizePCT.widthPCT*h.ResizeBasis.basisWidth/100),M=Math.round(h.ResizePCT.heightPCT*h.ResizeBasis.basisHeight/100);switch(r){case J.LEFT_TOP:d=p-S,c=v-M;break;case J.RIGHT_TOP:d=S-p,c=v-M;break;case J.RIGHT_BOTTOM:d=S-p,c=M-v;break;case J.LEFT_BOTTOM:d=p-S,c=M-v;break}return f}if(i%(2*Math.PI)!==0&&a!==void 0&&s!==void 0)return Oc(e,f,i,a,s,l,u,n,o);switch(r){case J.LEFT_TOP:f.width=n?p:p-d*e,f.height=o?v:v-c*e;break;case J.RIGHT_TOP:f.width=n?p:p+d*e,f.height=o?v:v-c*e;break;case J.RIGHT_BOTTOM:f.width=n?p:p+d*e,f.height=o?v:v+c*e;break;case J.LEFT_BOTTOM:f.width=n?p:p-d*e,f.height=o?v:v+c*e;break}return f},wc=function(r,t){var e=r.id,n=r.anchors,o=t.getNodeEdges(e);at(o,function(i){if(i.sourceNodeId===e){var a=Ne(n,function(s){return s.id===i.sourceAnchorId});a&&i.updateStartPoint({x:a.x,y:a.y})}else if(i.targetNodeId===e){var a=Ne(n,function(l){return l.id===i.targetAnchorId});a&&i.updateEndPoint({x:a.x,y:a.y})}})},Mc=function(r,t,e,n,o,i,a){a.eventCenter.emit(C.NODE_RESIZE,{preData:r,data:t,deltaX:e,deltaY:n,index:o,model:i})},Ac=function(r){var t=r.x,e=r.y,n=r.deltaX,o=r.deltaY,i=r.index,a=r.nodeModel,s=r.graphModel,l=r.cancelCallback,u=a.r,f=a.rx,d=a.ry,c=a.width,p=a.height,v=a.PCTResizeInfo,h=a.minWidth,g=a.minHeight,y=a.maxWidth,_=a.maxHeight,S=a.rotate,M=a.x,w=a.y,A=h===y,m=g===_,O={width:u||f||c,height:u||d||p,deltaX:n,deltaY:o,PCTResizeInfo:v},P=u||f&&d?1/2:1,T=t,B=e,I=Sc(i,O,P,A,m,S,T,B,M,w);if(I.width<h||I.width>y||I.height<g||I.height>_){l==null||l();return}(S%(2*Math.PI)==0||v||T===void 0||B===void 0)&&(I.deltaX=A?0:I.deltaX,I.deltaY=m?0:I.deltaY);var et=a.getData(),K=a.resize(I);et.x===K.x&&et.y===K.y||(wc(a,s),Mc(et,K,n,o,i,a,s))};function Pc(r,t,e,n,o,i,a,s){o===void 0&&(o=!1),i===void 0&&(i=!1);var l={x:e.x-(r.x-e.x),y:e.y-(r.y-e.y)},u=xc(l,t),f=vr(t,u,-n),d=vr(l,u,-n);if(o){var c=Math.abs(f.x-d.x),p=c-a;u.x>f.x?u.x=u.x+p/2:u.x=u.x-p/2}if(i){var v=Math.abs(f.y-d.y),h=v-s;u.y>f.y?u.y=u.y+h/2:u.y=u.y-h/2}if(o||i){var g=vr(d,u,n),y=g.x-l.x,_=g.y-l.y;u.x=u.x-y,u.y=u.y-_,d=vr(l,u,-n),f={x:u.x-(d.x-u.x),y:u.y-(d.y-u.y)}}var S=Math.abs(f.x-d.x),M=Math.abs(f.y-d.y);return o&&(S=a),i&&(M=s),{width:S,height:M,center:u}}var Tc=100,Dc={x:1,y:0};function Nc(r,t,e,n,o){for(var i=function(p){if(p<0||p>1)throw new RangeError('The value range of parameter "t" is [0,1]');return{x:r.x*Math.pow(1-p,3)+3*t.x*p*Math.pow(1-p,2)+3*e.x*Math.pow(p,2)*(1-p)+n.x*Math.pow(p,3),y:r.y*Math.pow(1-p,3)+3*t.y*p*Math.pow(1-p,2)+3*e.y*Math.pow(p,2)*(1-p)+n.y*Math.pow(p,3)}},a=0,s=2,l=n.x,u=n.y,f=n;a<o&&s<50;){f=i(1-s/Tc);var d=f.x,c=f.y;a=kt(l,u,d,c),s++}return f}function Cc(r,t){return r.x*t.y-r.y*t.x}function Rc(r,t){var e=[r.x,r.y,r.z],n=[t.x,t.y,t.z];return n.reduce(function(o,i,a){return o+i*e[a]})}function jc(r,t){var e=Cc(r,t),n=Math.acos(Rc(Ca(r),Ca(t)));return e>=0?n:-n}function Ca(r){var t=Math.hypot(r.x,r.y);return{x:r.x/t,y:r.y/t,z:0}}function Lc(r){return jc(Dc,r)}function Ic(r){return r*(180/Math.PI)}var Bc={baseNode:{fill:"#fff",stroke:"#000",strokeWidth:2},baseEdge:{stroke:"#000",strokeWidth:2},rect:{},circle:{},diamond:{},ellipse:{},polygon:{},text:{color:"#000",stroke:"none",fontSize:12,background:{fill:"transparent"}},anchor:{stroke:"#000",fill:"#fff",r:4,hover:{r:10,fill:"#949494",fillOpacity:.5,stroke:"#949494"}},anchorLine:{stroke:"#000",strokeWidth:2,strokeDasharray:"3,2"},nodeText:{color:"#000",overflowMode:"default",fontSize:12,lineHeight:1.2},edgeText:{textWidth:100,overflowMode:"default",fontSize:12,background:{fill:"#fff"}},line:{},polyline:{},bezier:{fill:"none",adjustLine:{stroke:"#949494"},adjustAnchor:{r:4,fill:"#949494",fillOpacity:1,stroke:"#949494"}},arrow:{offset:10,verticalLength:5},snapline:{stroke:"#949494",strokeWidth:1},edgeAdjust:{r:4,fill:"#fff",stroke:"#949494",strokeWidth:2},outline:{fill:"transparent",stroke:"#949494",strokeDasharray:"3,3",hover:{stroke:"#949494"}},edgeAnimation:{stroke:"red",strokeDasharray:"10,10",strokeDashoffset:"100%",animationName:"lf_animate_dash",animationDuration:"20s",animationIterationCount:"infinite",animationTimingFunction:"linear",animationDirection:"normal"},rotateControl:{stroke:"#000",fill:"#fff",strokeWidth:1.5},resizeControl:{width:7,height:7,fill:"#fff",stroke:"#000"},resizeOutline:{fill:"none",stroke:"transparent",strokeWidth:1,strokeDasharray:"3,3"}},wl=function(r){var t=k(Bc);return r&&(t=ni(t,r)),t},Xc=wl,kc=1e3,Hc=999,Ei=function(){return++kc},Yc=function(){return--Hc},lt=function(){return lt=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},lt.apply(this,arguments)},R=function(r,t,e,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,t,e,n);else for(var s=r.length-1;s>=0;s--)(a=r[s])&&(i=(o<3?a(i):o>3?a(t,e,i):a(t,e))||i);return o>3&&i&&Object.defineProperty(t,e,i),i},Jn=function(){function r(t,e){var n;this.BaseType=ot.EDGE,this.id="",this.type="",this.sourceNodeId="",this.targetNodeId="",this.textMode=Tt.TEXT,this.text={value:"",x:0,y:0,draggable:!1,editable:!0},this.points="",this.pointsList=[],this.virtual=!1,this.isSelected=!1,this.isHovered=!1,this.isHitable=!0,this.isHittable=!0,this.draggable=!0,this.visible=!0,this.isAnimation=!1,this.isShowAdjustPoint=!1,this.zIndex=0,this.state=V.DEFAULT,this.modelType=Y.EDGE,this.customTextPosition=!1,this.style={},this.arrowConfig={markerEnd:"url(#marker-end-".concat(this.id,")"),markerStart:"url(#marker-start-".concat(this.id,")")},this.graphModel=e,this.properties=(n=t.properties)!==null&&n!==void 0?n:{},this.initEdgeData(t),this.setAttributes()}return r.prototype.initEdgeData=function(t){if(t.properties||(t.properties={}),!t.id){var e=this.graphModel.idGenerator,n=e&&e(t.type),o=this.createId();t.id=o||n||De()}this.arrowConfig.markerEnd="url(#marker-end-".concat(t.id,")"),this.arrowConfig.markerStart="url(#marker-start-".concat(t.id,")");var i=this.graphModel.editConfigModel.adjustEdgeStartAndEnd;this.isShowAdjustPoint=i,Q(this,Gf(t));var a=this.graphModel.overlapMode;a===Bt.INCREASE&&(this.zIndex=t.zIndex||Ei()),this.setAnchors(),this.initPoints(),this.formatText(t)},r.prototype.setAttributes=function(){},r.prototype.createId=function(){return null},r.prototype.getEdgeStyle=function(){return lt(lt({},this.graphModel.theme.baseEdge),this.style)},r.prototype.getAdjustPointStyle=function(){return lt({},this.graphModel.theme.edgeAdjust)},r.prototype.getTextStyle=function(){var t=this.graphModel.theme.edgeText;return k(t)},r.prototype.getEdgeAnimationStyle=function(){var t=this.graphModel.theme.edgeAnimation;return k(t)},r.prototype.getArrowStyle=function(){var t=this.getEdgeStyle(),e=this.getEdgeAnimationStyle(),n=this.graphModel.theme.arrow,o=this.isAnimation?e.stroke:t.stroke;return lt(lt(lt({},t),{fill:o,stroke:o}),n)},r.prototype.getOutlineStyle=function(){var t=this.graphModel,e=t.theme.outline;return k(e)},r.prototype.getTextPosition=function(){return{x:0,y:0}},Object.defineProperty(r.prototype,"sourceNode",{get:function(){var t,e;return(e=(t=this.graphModel)===null||t===void 0?void 0:t.nodesMap[this.sourceNodeId])===null||e===void 0?void 0:e.model},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"targetNode",{get:function(){var t,e;return(e=(t=this.graphModel)===null||t===void 0?void 0:t.nodesMap[this.targetNodeId])===null||e===void 0?void 0:e.model},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"textPosition",{get:function(){return this.getTextPosition()},enumerable:!1,configurable:!0}),r.prototype.getBeginAnchor=function(t,e,n){var o,i,a=jo(t);if(n){if(o=Ne(a,function(s){return s.id===n}),o)return o;console.warn("未在节点上找到指定的起点锚点".concat(n,"，已使用默认锚点作为起点"))}return a.forEach(function(s){var l=Sa(s,e);(i===void 0||l<i)&&(i=l,o=s)}),o},r.prototype.getEndAnchor=function(t,e){var n=this,o,i,a=jo(t);if(e){if(o=Ne(a,function(s){return s.id===e}),o)return o;console.warn("未在节点上找到指定的终点锚点".concat(e,"，已使用默认锚点作为终点"))}return a.forEach(function(s){if(n.startPoint){var l=Sa(s,n.startPoint);(i===void 0||l<i)&&(i=l,o=s)}}),o},r.prototype.getProperties=function(){return Vt(this.properties)},r.prototype.getData=function(){var t=this.properties;Qe(t)&&(t=Vt(t));var e={id:this.id,type:this.type,properties:t,sourceNodeId:this.sourceNodeId,targetNodeId:this.targetNodeId,sourceAnchorId:this.sourceAnchorId,targetAnchorId:this.targetAnchorId,startPoint:Q({},this.startPoint),endPoint:Q({},this.endPoint)};this.graphModel.overlapMode===Bt.INCREASE&&(e.zIndex=this.zIndex);var n=this.text,o=n.x,i=n.y,a=n.value;return a&&(e.text={x:o,y:i,value:a}),e},r.prototype.getHistoryData=function(){return this.getData()},r.prototype.setProperty=function(t,e){vi(this.properties,t,vt(e)),this.setAttributes()},r.prototype.deleteProperty=function(t){delete this.properties[t],this.setAttributes()},r.prototype.setProperties=function(t){this.properties=lt(lt({},Vt(this.properties)),vt(t)),this.setAttributes()},r.prototype.changeEdgeId=function(t){var e=this.arrowConfig,n=e.markerEnd,o=e.markerStart;o&&o==="url(#marker-start-".concat(this.id,")")&&(this.arrowConfig.markerStart="url(#marker-start-".concat(t,")")),n&&n==="url(#marker-end-".concat(this.id,")")&&(this.arrowConfig.markerEnd="url(#marker-end-".concat(t,")")),this.id=t},r.prototype.setStyle=function(t,e){var n;this.style=lt(lt({},this.style),(n={},n[t]=vt(e),n))},r.prototype.setStyles=function(t){this.style=lt(lt({},this.style),vt(t))},r.prototype.updateStyles=function(t){this.style=lt({},vt(t))},r.prototype.setTextMode=function(t){this.textMode=t},r.prototype.formatText=function(t){var e,n,o,i=this.graphModel.editConfigModel,a=i.edgeTextDraggable,s=i.edgeTextEdit,l=this.textPosition,u=l.x,f=l.y,d=t.text,c={value:"",x:u,y:f,draggable:a,editable:s};d&&(typeof d=="string"?c=lt(lt({},c),{value:d}):(c=lt(lt({},c),{x:(e=d.x)!==null&&e!==void 0?e:u,y:(n=d.y)!==null&&n!==void 0?n:f,value:(o=d.value)!==null&&o!==void 0?o:""}),Ue(d.draggable)||(c.draggable=d.draggable),Ue(d.editable)||(c.editable=d.editable))),this.text=c},r.prototype.resetTextPosition=function(){var t=this.textPosition,e=t.x,n=t.y;this.text.x=e,this.text.y=n},r.prototype.moveText=function(t,e){var n=this.text,o=n.x,i=n.y,a=n.value,s=n.draggable,l=n.editable;this.text={value:a,editable:l,draggable:s,x:o+t,y:i+e}},r.prototype.setText=function(t){t&&Q(this.text,t)},r.prototype.updateText=function(t){this.text=lt(lt({},Vt(this.text)),{value:t})},r.prototype.setAnchors=function(){if(!this.sourceAnchorId||!this.startPoint){var t=this.getBeginAnchor(this.sourceNode,this.targetNode,this.sourceAnchorId);if(!t)throw new Error("无法获取beginAnchor，请检查anchors相关逻辑，anchors不能为空");this.startPoint||(this.startPoint={x:t.x,y:t.y}),this.sourceAnchorId||(this.sourceAnchorId=t.id)}if(!this.targetAnchorId||!this.endPoint){var t=this.getEndAnchor(this.targetNode,this.targetAnchorId);if(!t)throw new Error("无法获取endAnchor，请检查anchors相关逻辑，anchors不能为空");this.endPoint||(this.endPoint={x:t.x,y:t.y}),this.targetAnchorId||(this.targetAnchorId=t.id)}},r.prototype.setSelected=function(t){t===void 0&&(t=!0),this.isSelected=t},r.prototype.setHovered=function(t){t===void 0&&(t=!0),this.isHovered=t},r.prototype.setHitable=function(t){t===void 0&&(t=!0),this.isHitable=t},r.prototype.setHittable=function(t){t===void 0&&(t=!0),this.isHittable=t},r.prototype.openEdgeAnimation=function(){this.isAnimation=!0},r.prototype.closeEdgeAnimation=function(){this.isAnimation=!1},r.prototype.setElementState=function(t,e){this.state=t,this.additionStateData=e},r.prototype.updateStartPoint=function(t){this.startPoint=t},r.prototype.moveStartPoint=function(t,e){this.startPoint&&(this.startPoint.x+=t,this.startPoint.y+=e)},r.prototype.updateEndPoint=function(t){this.endPoint=t},r.prototype.moveEndPoint=function(t,e){this.endPoint&&(this.endPoint.x+=t,this.endPoint.y+=e)},r.prototype.setZIndex=function(t){t===void 0&&(t=0),this.zIndex=t},r.prototype.initPoints=function(){},r.prototype.updateAttributes=function(t){Q(this,t)},r.prototype.getAdjustStart=function(){return this.startPoint},r.prototype.getAdjustEnd=function(){return this.endPoint},r.prototype.updateAfterAdjustStartAndEnd=function(t){var e=t.startPoint,n=t.endPoint;this.updateStartPoint({x:e.x,y:e.y}),this.updateEndPoint({x:n.x,y:n.y})},r.BaseType=ot.EDGE,R([E],r.prototype,"type",void 0),R([E],r.prototype,"sourceNodeId",void 0),R([E],r.prototype,"targetNodeId",void 0),R([E],r.prototype,"startPoint",void 0),R([E],r.prototype,"endPoint",void 0),R([E],r.prototype,"textMode",void 0),R([E],r.prototype,"text",void 0),R([E],r.prototype,"properties",void 0),R([E],r.prototype,"points",void 0),R([E],r.prototype,"pointsList",void 0),R([E],r.prototype,"isSelected",void 0),R([E],r.prototype,"isHovered",void 0),R([E],r.prototype,"isHitable",void 0),R([E],r.prototype,"isHittable",void 0),R([E],r.prototype,"draggable",void 0),R([E],r.prototype,"visible",void 0),R([E],r.prototype,"isAnimation",void 0),R([E],r.prototype,"isShowAdjustPoint",void 0),R([E],r.prototype,"zIndex",void 0),R([E],r.prototype,"state",void 0),R([E],r.prototype,"style",void 0),R([E],r.prototype,"arrowConfig",void 0),R([tt],r.prototype,"sourceNode",null),R([tt],r.prototype,"targetNode",null),R([tt],r.prototype,"textPosition",null),R([x],r.prototype,"setProperty",null),R([x],r.prototype,"deleteProperty",null),R([x],r.prototype,"setProperties",null),R([x],r.prototype,"changeEdgeId",null),R([x],r.prototype,"setStyle",null),R([x],r.prototype,"setStyles",null),R([x],r.prototype,"updateStyles",null),R([x],r.prototype,"setTextMode",null),R([x],r.prototype,"formatText",null),R([x],r.prototype,"resetTextPosition",null),R([x],r.prototype,"moveText",null),R([x],r.prototype,"setText",null),R([x],r.prototype,"updateText",null),R([x],r.prototype,"setAnchors",null),R([x],r.prototype,"setSelected",null),R([x],r.prototype,"setHovered",null),R([x],r.prototype,"setHitable",null),R([x],r.prototype,"setHittable",null),R([x],r.prototype,"openEdgeAnimation",null),R([x],r.prototype,"closeEdgeAnimation",null),R([x],r.prototype,"setElementState",null),R([x],r.prototype,"updateStartPoint",null),R([x],r.prototype,"moveStartPoint",null),R([x],r.prototype,"updateEndPoint",null),R([x],r.prototype,"moveEndPoint",null),R([x],r.prototype,"setZIndex",null),R([x],r.prototype,"initPoints",null),R([x],r.prototype,"updateAttributes",null),R([x],r.prototype,"getAdjustStart",null),R([x],r.prototype,"getAdjustEnd",null),R([x],r.prototype,"updateAfterAdjustStartAndEnd",null),r}(),Gc=function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Se=function(){return Se=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},Se.apply(this,arguments)},wt=function(r,t,e,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,t,e,n);else for(var s=r.length-1;s>=0;s--)(a=r[s])&&(i=(o<3?a(i):o>3?a(t,e,i):a(t,e))||i);return o>3&&i&&Object.defineProperty(t,e,i),i},lo=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i},Ra=function(r){Gc(t,r);function t(e,n){var o=r.call(this,e,n)||this;return o.modelType=Y.BEZIER_EDGE,o.path="",o.initEdgeData(e),o.setAttributes(),o}return t.prototype.initEdgeData=function(e){this.offset=zn(e,"properties.offset",100),r.prototype.initEdgeData.call(this,e)},t.prototype.getEdgeStyle=function(){var e=this.graphModel.theme.bezier,n=r.prototype.getEdgeStyle.call(this),o=this.properties.style,i=o===void 0?{}:o;return Se(Se(Se({},n),k(e)),k(i))},t.prototype.getTextPosition=function(){if(this.pointsList&&this.pointsList.length>0){var e=0,n=0;return this.pointsList.forEach(function(o){var i=o.x,a=o.y;e+=i,n+=a}),{x:e/this.pointsList.length,y:n/this.pointsList.length}}return{x:(this.startPoint.x+this.endPoint.x)/2,y:(this.startPoint.y+this.endPoint.y)/2}},t.prototype.getData=function(){var e=r.prototype.getData.call(this),n=this.pointsList.map(function(o){var i=o.x,a=o.y;return{x:i,y:a}});return Se(Se({},e),{pointsList:n})},t.prototype.getControls=function(){var e=this.startPoint,n=this.endPoint,o=ba({start:e,end:n,sourceNode:this.sourceNode,targetNode:this.targetNode,offset:this.offset});return o},t.prototype.getPath=function(e){var n=lo(e,4),o=n[0],i=n[1],a=n[2],s=n[3];return"M ".concat(o.x," ").concat(o.y,`
    C `).concat(i.x," ").concat(i.y,`,
    `).concat(a.x," ").concat(a.y,`,
    `).concat(s.x," ").concat(s.y)},t.prototype.initPoints=function(){this.pointsList.length>0?this.path=this.getPath(this.pointsList):this.updatePoints()},t.prototype.updatePoints=function(){var e=this.getControls(),n=e.sNext,o=e.ePre;this.updatePath(n,o)},t.prototype.updatePath=function(e,n){e=k(e),n=k(n);var o={x:this.startPoint.x,y:this.startPoint.y},i={x:this.endPoint.x,y:this.endPoint.y};if(!e||!n){var a=this.getControls();e=a.sNext,n=a.ePre}this.pointsList=[o,e,n,i],this.path=this.getPath(this.pointsList)},t.prototype.updateStartPoint=function(e){this.startPoint=Object.assign({},e),this.updatePoints()},t.prototype.updateEndPoint=function(e){this.endPoint=Object.assign({},e),this.updatePoints()},t.prototype.moveStartPoint=function(e,n){this.startPoint.x+=e,this.startPoint.y+=n;var o=lo(this.pointsList,3),i=o[1],a=o[2];i.x+=e,i.y+=n,this.updatePath(i,a)},t.prototype.moveEndPoint=function(e,n){this.endPoint.x+=e,this.endPoint.y+=n;var o=lo(this.pointsList,3),i=o[1],a=o[2];a.x+=e,a.y+=n,this.updatePath(i,a)},t.prototype.updateAdjustAnchor=function(e,n){var o;n==="sNext"?this.pointsList[1]=e:n==="ePre"&&(this.pointsList[2]=e),this.path=this.getPath(this.pointsList),!((o=this.text)===null||o===void 0)&&o.value&&this.setText(Q({},this.text,this.textPosition))},t.prototype.getAdjustStart=function(){return this.pointsList[0]||this.startPoint},t.prototype.getAdjustEnd=function(){var e=this.pointsList;return e[e.length-1]||this.endPoint},t.prototype.updateAfterAdjustStartAndEnd=function(e){var n=e.startPoint,o=e.endPoint,i=e.sourceNode,a=e.targetNode,s=ba({start:n,end:o,sourceNode:i,targetNode:a,offset:this.offset}),l=s.sNext,u=s.ePre;this.pointsList=[n,l,u,o],this.initPoints()},wt([E],t.prototype,"offset",void 0),wt([E],t.prototype,"path",void 0),wt([x],t.prototype,"initPoints",null),wt([x],t.prototype,"updatePoints",null),wt([x],t.prototype,"updateStartPoint",null),wt([x],t.prototype,"updateEndPoint",null),wt([x],t.prototype,"moveStartPoint",null),wt([x],t.prototype,"moveEndPoint",null),wt([x],t.prototype,"updateAdjustAnchor",null),wt([x],t.prototype,"getAdjustStart",null),wt([x],t.prototype,"getAdjustEnd",null),wt([x],t.prototype,"updateAfterAdjustStartAndEnd",null),t}(Jn),zc=function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),_r=function(){return _r=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},_r.apply(this,arguments)},ja=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i},Fc=function(r,t,e){if(e||arguments.length===2)for(var n=0,o=t.length,i;n<o;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return r.concat(i||Array.prototype.slice.call(t))},La=function(r){zc(t,r);function t(){var e=r.apply(this,Fc([],ja(arguments),!1))||this;return e.modelType=Y.LINE_EDGE,e}return t.prototype.getEdgeStyle=function(){var e=this.graphModel.theme.line,n=r.prototype.getEdgeStyle.call(this),o=this.properties.style,i=o===void 0?{}:o;return _r(_r(_r({},n),k(e)),k(i))},t.prototype.initEdgeData=function(e){r.prototype.initEdgeData.call(this,e),this.points=this.getPath([this.startPoint,this.endPoint])},t.prototype.getPath=function(e){var n=ja(e,2),o=n[0],i=n[1];return"".concat(o.x,",").concat(o.y," ").concat(i.x,",").concat(i.y)},t.prototype.getTextPosition=function(){return{x:(this.startPoint.x+this.endPoint.x)/2,y:(this.startPoint.y+this.endPoint.y)/2}},t}(Jn),Uc=function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),mr=function(){return mr=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},mr.apply(this,arguments)},ft=function(r,t,e,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,t,e,n);else for(var s=r.length-1;s>=0;s--)(a=r[s])&&(i=(o<3?a(i):o>3?a(t,e,i):a(t,e))||i);return o>3&&i&&Object.defineProperty(t,e,i),i},Ia=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i},$c=function(r,t,e){if(e||arguments.length===2)for(var n=0,o=t.length,i;n<o;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return r.concat(i||Array.prototype.slice.call(t))},Ba=function(r){Uc(t,r);function t(){var e=r.apply(this,$c([],Ia(arguments),!1))||this;return e.modelType=Y.POLYLINE_EDGE,e.draggingPointList=[],e}return t.prototype.initEdgeData=function(e){this.offset=zn(e,"properties.offset",30),e.pointsList&&(this.pointsList=e.pointsList),r.prototype.initEdgeData.call(this,e)},t.prototype.getEdgeStyle=function(){var e=this.graphModel.theme.polyline,n=r.prototype.getEdgeStyle.call(this),o=this.properties.style,i=o===void 0?{}:o;return mr(mr(mr({},n),k(e)),k(i))},t.prototype.getTextPosition=function(){var e,n=(e=this.text)===null||e===void 0?void 0:e.value;if(this.dbClickPosition&&!n){var o=this.dbClickPosition,i=o.x,a=o.y;return{x:i,y:a}}var s=Re(this.points),l=Ia(kf(s),2),u=l[0],f=l[1];return{x:(u.x+f.x)/2,y:(u.y+f.y)/2}},t.prototype.getAfterAnchor=function(e,n,o){var i,a;return o.forEach(function(s){var l;e===rt.HORIZONTAL?l=Math.abs(n.y-s.y):e===rt.VERTICAL&&(l=Math.abs(n.x-s.x)),(!a||a>l)&&(a=l,i=s)}),i},t.prototype.getCrossPoint=function(e,n,o){var i;return e===rt.HORIZONTAL?i={x:o.x,y:n.y}:e===rt.VERTICAL&&(i={x:n.x,y:o.y}),i},t.prototype.removeCrossPoints=function(e,n,o){var i=o.map(function(y){return y});if(e===1){var a=i[e],s=i[n],l=i[e-1],u=_a(l,a,this.sourceNode);if(u){var f=ma(a,s,this.sourceNode);if(f){var d=xa(a,s,this.sourceNode);d&&(i[e]=d,i.splice(e-1,1),e--,n--)}}else{var c=this.sourceNode.anchors;c.forEach(function(y){if(y.x===l.x&&y.x===a.x||y.y===l.y&&y.y===a.y){var _=kt(y.x,y.y,a.x,a.y),S=kt(l.x,l.y,a.x,a.y);_<S&&(i[e-1]=y)}})}}if(n===o.length-2){var p=i[e],v=i[n],h=i[n+1],g=_a(v,h,this.targetNode);if(g){var f=ma(p,v,this.targetNode);if(f){var d=xa(p,v,this.targetNode);d&&(i[n]=d,i.splice(n+1,1))}}else{var c=this.targetNode.anchors;c.forEach(function(_){if(_.x===h.x&&_.x===v.x||_.y===h.y&&_.y===v.y){var S=kt(_.x,_.y,v.x,v.y),M=kt(h.x,h.y,v.x,v.y);S<M&&(i[n+1]=_)}})}}return i},t.prototype.getDraggingPoints=function(e,n,o,i,a){var s=a.map(function(f){return f}),l=this.getAfterAnchor(e,o,i),u=this.getCrossPoint(e,o,l);return n==="start"?(s.unshift(u),s.unshift(l)):(s.push(u),s.push(l)),s},t.prototype.updateCrossPoints=function(e){var n=e.map(function(_){return _}),o=e[0],i=e[1],a=e[n.length-2],s=e[n.length-1],l=this,u=l.sourceNode,f=l.targetNode,d=u.modelType,c=f.modelType,p=Tn(o,i),v=n[0];switch(d){case Y.RECT_NODE:if(u.radius!==0){var h=Aa(o,u);h||(v=Ma(o,p,u))}break;case Y.CIRCLE_NODE:v=Lo(o,p,u);break;case Y.ELLIPSE_NODE:v=Pa(o,p,u);break;case Y.DIAMOND_NODE:v=Qr(o,p,u);break;case Y.POLYGON_NODE:v=Qr(o,p,u);break}v&&(n[0]=v);var g=Tn(a,s),y=n[n.length-1];switch(c){case Y.RECT_NODE:if(f.radius!==0){var h=Aa(s,f);h||(y=Ma(s,g,f))}break;case Y.CIRCLE_NODE:y=Lo(s,g,f);break;case Y.ELLIPSE_NODE:y=Pa(s,g,f);break;case Y.DIAMOND_NODE:y=Qr(s,g,f);break;case Y.POLYGON_NODE:y=Qr(s,g,f);break}return y&&(n[n.length-1]=y),n},t.prototype.updatePath=function(e){this.pointsList=e,this.points=this.getPath(this.pointsList)},t.prototype.getData=function(){var e=r.prototype.getData.call(this),n=this.pointsList.map(function(o){var i=o.x,a=o.y;return{x:i,y:a}});return Object.assign({},e,{pointsList:n})},t.prototype.getPath=function(e){return e.map(function(n){return"".concat(n.x,",").concat(n.y)}).join(" ")},t.prototype.initPoints=function(){this.pointsList.length>0?this.points=this.getPath(this.pointsList):this.updatePoints()},t.prototype.updatePoints=function(){var e=ga({x:this.startPoint.x,y:this.startPoint.y},{x:this.endPoint.x,y:this.endPoint.y},this.sourceNode,this.targetNode,this.offset||0);this.pointsList=e,this.points=e.map(function(n){return"".concat(n.x,",").concat(n.y)}).join(" ")},t.prototype.updateStartPoint=function(e){this.startPoint=Object.assign({},e),this.updatePoints()},t.prototype.moveStartPoint=function(e,n){this.startPoint.x+=e,this.startPoint.y+=n,this.updatePoints()},t.prototype.updateEndPoint=function(e){this.endPoint=Object.assign({},e),this.updatePoints()},t.prototype.moveEndPoint=function(e,n){this.endPoint.x+=e,this.endPoint.y+=n,this.updatePoints()},t.prototype.updatePointsList=function(e,n){this.pointsList.forEach(function(a){a.x+=e,a.y+=n});var o=this.pointsList[0];this.startPoint=Object.assign({},o);var i=this.pointsList[this.pointsList.length-1];this.endPoint=Object.assign({},i),this.initPoints()},t.prototype.dragAppendStart=function(){this.draggingPointList=this.pointsList.map(function(e){return e})},t.prototype.dragAppendSimple=function(e,n){var o;this.isDragging=!0;var i=e.start,a=e.end,s=e.startIndex,l=e.endIndex,u=e.direction,f=this.pointsList,d=f;return u===rt.HORIZONTAL?(f[s]={x:i.x,y:i.y+n.y},f[l]={x:a.x,y:a.y+n.y},d=this.pointsList.map(function(c){return c})):u===rt.VERTICAL&&(f[s]={x:i.x+n.x,y:i.y},f[l]={x:a.x+n.x,y:a.y},d=this.pointsList.map(function(c){return c})),this.updatePointsAfterDrag(d),this.draggingPointList=d,!((o=this.text)===null||o===void 0)&&o.value&&this.setText(Q({},this.text,this.textPosition)),{start:Q({},f[s]),end:Q({},f[l]),startIndex:s,endIndex:l,direction:u}},t.prototype.dragAppend=function(e,n){var o;this.isDragging=!0;var i=e.start,a=e.end,s=e.startIndex,l=e.endIndex,u=e.direction,f=this.pointsList;if(u===rt.HORIZONTAL){f[s]={x:i.x,y:i.y+n.y},f[l]={x:a.x,y:a.y+n.y};var d=this.pointsList.map(function(g){return g});if(s!==0&&l!==this.pointsList.length-1&&(d=this.removeCrossPoints(s,l,d)),s===0){var c={x:i.x,y:i.y+n.y},p=se(c,this.sourceNode);if(!p){var v=this.sourceNode.anchors;d=this.getDraggingPoints(u,"start",c,v,d)}}if(l===this.pointsList.length-1){var h={x:a.x,y:a.y+n.y},p=se(h,this.targetNode);if(!p){var v=this.targetNode.anchors;d=this.getDraggingPoints(u,"end",h,v,d)}}this.updatePointsAfterDrag(d),this.draggingPointList=d}else if(u===rt.VERTICAL){f[s]={x:i.x+n.x,y:i.y},f[l]={x:a.x+n.x,y:a.y};var d=this.pointsList.map(function(y){return y});if(s!==0&&l!==this.pointsList.length-1&&(d=this.removeCrossPoints(s,l,d)),s===0){var c={x:i.x+n.x,y:i.y},p=se(c,this.sourceNode);if(!p){var v=this.sourceNode.anchors;d=this.getDraggingPoints(u,"start",c,v,d)}}if(l===this.pointsList.length-1){var h={x:a.x+n.x,y:a.y},p=se(h,this.targetNode);if(!p){var v=this.targetNode.anchors;d=this.getDraggingPoints(u,"end",h,v,d)}}this.updatePointsAfterDrag(d),this.draggingPointList=d}return!((o=this.text)===null||o===void 0)&&o.value&&this.setText(Q({},this.text,this.textPosition)),{start:Q({},f[s]),end:Q({},f[l]),startIndex:s,endIndex:l,direction:u}},t.prototype.dragAppendEnd=function(){if(this.draggingPointList){var e=vl(Re(this.points));this.pointsList=e.map(function(i){return i}),this.draggingPointList=[];var n=e[0];this.startPoint=Q({},n);var o=e[e.length-1];this.endPoint=Q({},o)}this.isDragging=!1},t.prototype.updatePointsAfterDrag=function(e){var n=this.updateCrossPoints(e);this.points=n.map(function(o){return"".concat(o.x,",").concat(o.y)}).join(" ")},t.prototype.getAdjustStart=function(){return this.pointsList[0]||this.startPoint},t.prototype.getAdjustEnd=function(){var e=this.pointsList;return e[e.length-1]||this.endPoint},t.prototype.updateAfterAdjustStartAndEnd=function(e){var n=e.startPoint,o=e.endPoint,i=e.sourceNode,a=e.targetNode;this.pointsList=ga({x:n.x,y:n.y},{x:o.x,y:o.y},i,a,this.offset||0),this.initPoints()},ft([E],t.prototype,"offset",void 0),ft([E],t.prototype,"dbClickPosition",void 0),ft([x],t.prototype,"initPoints",null),ft([x],t.prototype,"updatePoints",null),ft([x],t.prototype,"updateStartPoint",null),ft([x],t.prototype,"moveStartPoint",null),ft([x],t.prototype,"updateEndPoint",null),ft([x],t.prototype,"moveEndPoint",null),ft([x],t.prototype,"updatePointsList",null),ft([x],t.prototype,"dragAppendStart",null),ft([x],t.prototype,"dragAppendSimple",null),ft([x],t.prototype,"dragAppend",null),ft([x],t.prototype,"dragAppendEnd",null),ft([x],t.prototype,"updatePointsAfterDrag",null),ft([x],t.prototype,"getAdjustStart",null),ft([x],t.prototype,"getAdjustEnd",null),ft([x],t.prototype,"updateAfterAdjustStartAndEnd",null),t}(Jn),ut=function(){return ut=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},ut.apply(this,arguments)},j=function(r,t,e,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,t,e,n);else for(var s=r.length-1;s>=0;s--)(a=r[s])&&(i=(o<3?a(i):o>3?a(t,e,i):a(t,e))||i);return o>3&&i&&Object.defineProperty(t,e,i),i},Xa=function(r){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&r[t],n=0;if(e)return e.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Vc=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i},Ee=function(){function r(t,e){var n;this.BaseType=ot.NODE,this.id="",this.type="",this.x=0,this.y=0,this.textMode=Tt.TEXT,this.text={value:"",x:0,y:0,draggable:!1,editable:!0},this._width=100,this._height=80,this.minWidth=30,this.minHeight=30,this.maxWidth=2e3,this.maxHeight=2e3,this.anchorsOffset=[],this.virtual=!1,this.isSelected=!1,this.isHovered=!1,this.isShowAnchor=!1,this.isDragging=!1,this.isHitable=!0,this.isHittable=!0,this.draggable=!0,this.visible=!0,this.rotatable=!0,this.resizable=!0,this.zIndex=1,this.state=V.DEFAULT,this.autoToFront=!0,this.style={},this._rotate=0,this.modelType=Y.NODE,this.additionStateData={},this.targetRules=[],this.sourceRules=[],this.moveRules=[],this.resizeRules=[],this.hasSetTargetRules=!1,this.hasSetSourceRules=!1,this.graphModel=e,this.properties=(n=t.properties)!==null&&n!==void 0?n:{},this.initNodeData(t),this.setAttributes()}return Object.defineProperty(r.prototype,"width",{get:function(){return this._width},set:function(t){this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"height",{get:function(){return this._height},set:function(t){this._height=t},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"rotate",{get:function(){return this._rotate},set:function(t){this._rotate=t;var e=this,n=e.x,o=n===void 0?0:n,i=e.y,a=i===void 0?0:i;this.transform=new Dn(-o,-a).rotate(t).translate(o,a).toString()},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"incoming",{get:function(){return{nodes:this.graphModel.getNodeIncomingNode(this.id),edges:this.graphModel.getNodeIncomingEdge(this.id)}},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"outgoing",{get:function(){return{nodes:this.graphModel.getNodeOutgoingNode(this.id),edges:this.graphModel.getNodeOutgoingEdge(this.id)}},enumerable:!1,configurable:!0}),r.prototype.initNodeData=function(t){if(t.properties||(t.properties={}),!t.id){var e=this.graphModel.idGenerator,n=e&&e(t.type),o=this.createId();t.id=o||n||De()}this.formatText(t),Q(this,Qf(t));var i=this.graphModel.overlapMode;i===Bt.INCREASE&&(this.zIndex=t.zIndex||Ei())},r.prototype.setAttributes=function(){},r.prototype.createId=function(){return null},r.prototype.setTextMode=function(t){this.textMode=t},r.prototype.formatText=function(t){var e,n,o,i=this.graphModel.editConfigModel,a=i.nodeTextDraggable,s=i.nodeTextEdit,l=t.x,u=t.y,f=t.text,d={value:"",x:l,y:u,draggable:a,editable:s};f&&(typeof f=="string"?d.value=f:(d=ut(ut({},d),{x:(e=f.x)!==null&&e!==void 0?e:l,y:(n=f.y)!==null&&n!==void 0?n:u,value:(o=f.value)!==null&&o!==void 0?o:""}),Ue(f.draggable)||(d.draggable=f.draggable),Ue(f.editable)||(d.editable=f.editable))),t.text=d},r.prototype.resize=function(t){var e=t.width,n=t.height,o=t.deltaX,i=t.deltaY,a=this.isAllowResizeNode(o,i,e,n);return a?(this.move(o/2,i/2),this.width=e,this.height=n,this.setProperties({width:e,height:n}),this.getData()):this.getData()},r.prototype.proportionalResize=function(){},r.prototype.getData=function(){var t=this.text,e=t.x,n=t.y,o=t.value,i=this.properties;Qe(i)&&(i=Vt(i)),Xt(i.width)&&(i.width=this.width),Xt(i.height)&&(i.height=this.height);var a={id:this.id,type:this.type,x:this.x,y:this.y,properties:i};return this.rotate&&(a.rotate=this.rotate),this.graphModel.overlapMode===Bt.INCREASE&&(a.zIndex=this.zIndex),o&&(a.text={x:e,y:n,value:o}),a},r.prototype.getHistoryData=function(){return this.getData()},r.prototype.getProperties=function(){return Vt(this.properties)},r.prototype.getOuterGAttributes=function(){return{className:""}},r.prototype.getNodeStyle=function(){return ut(ut({},this.graphModel.theme.baseNode),this.style)},r.prototype.getTextStyle=function(){var t=this.graphModel.theme.nodeText,e=this.properties.textStyle,n=e===void 0?{}:e;return ut(ut({},k(t)),k(n))},r.prototype.getRotateControlStyle=function(){var t=this.graphModel.theme.rotateControl;return k(t)},r.prototype.getResizeControlStyle=function(){var t=this.graphModel.theme.resizeControl;return k(t)},r.prototype.getResizeOutlineStyle=function(){var t=this.graphModel.theme.resizeOutline;return k(t)},r.prototype.getAnchorStyle=function(t){var e=this.graphModel.theme.anchor;return k(e)},r.prototype.getAnchorLineStyle=function(t){var e=this.graphModel.theme.anchorLine;return k(e)},r.prototype.getOutlineStyle=function(){var t=this.graphModel.theme.outline;return k(t)},r.prototype.isAllowConnectedAsSource=function(t,e,n,o){var i=this.hasSetSourceRules?this.sourceRules:this.getConnectedSourceRules();this.hasSetSourceRules=!0;for(var a=!0,s="",l=0;l<i.length;l++){var u=i[l];if(!u.validate.call(this,this,t,e,n,o)){a=!1,s=u.message;break}}return{isAllPass:a,msg:s}},r.prototype.getConnectedSourceRules=function(){return this.sourceRules},r.prototype.isAllowConnectedAsTarget=function(t,e,n,o){var i=this.hasSetTargetRules?this.targetRules:this.getConnectedTargetRules();this.hasSetTargetRules=!0;for(var a=!0,s="",l=0;l<i.length;l++){var u=i[l];if(!u.validate.call(this,t,this,e,n,o)){a=!1,s=u.message;break}}return{isAllPass:a,msg:s}},r.prototype.isAllowMoveNode=function(t,e){var n,o,i=!0,a=!0,s=this.moveRules.concat(this.graphModel.nodeMoveRules);try{for(var l=Xa(s),u=l.next();!u.done;u=l.next()){var f=u.value,d=f(this,t,e);if(!d)return!1;if(typeof d=="object"){var c=d;if(!c.x&&!c.y)return!1;i=i&&c.x,a=a&&c.y}}}catch(p){n={error:p}}finally{try{u&&!u.done&&(o=l.return)&&o.call(l)}finally{if(n)throw n.error}}return{x:i,y:a}},r.prototype.getConnectedTargetRules=function(){return this.targetRules},r.prototype.getAnchorsByOffset=function(){var t=this,e=t.anchorsOffset,n=t.id,o=t.x,i=t.y;return e&&e.length>0?e.map(function(a,s){return a.length?(a=a,{id:"".concat(n,"_").concat(s),x:o+a[0],y:i+a[1]}):(a=a,ut(ut({},a),{x:o+a.x,y:i+a.y,id:a.id||"".concat(n,"_").concat(s)}))}):this.getDefaultAnchor()},r.prototype.getDefaultAnchor=function(){return[]},r.prototype.getTargetAnchor=function(t){return Zf(t,this)},r.prototype.getBounds=function(){return{minX:this.x-this.width/2,minY:this.y-this.height/2,maxX:this.x+this.width/2,maxY:this.y+this.height/2}},Object.defineProperty(r.prototype,"anchors",{get:function(){var t=this.getAnchorsByOffset(),e=this,n=e.x,o=e.y,i=e.rotate;return t.forEach(function(a){var s=a.x,l=a.y,u=Vc(new zr([s,l,1]).translate(-n,-o).rotate(i).translate(n,o)[0],2),f=u[0],d=u[1];a.x=f,a.y=d}),t},enumerable:!1,configurable:!0}),r.prototype.getAnchorInfo=function(t){if(!Xt(t))for(var e=0;e<this.anchors.length;e++){var n=this.anchors[e];if(n.id===t)return n}},r.prototype.addNodeMoveRules=function(t){this.moveRules.includes(t)||this.moveRules.push(t)},r.prototype.isAllowMoveByXORY=function(t,e,n){var o,i;if(n)o=!0,i=!0;else{var a=this.isAllowMoveNode(t,e);typeof a=="boolean"?(o=a,i=a):(o=a.x,i=a.y)}return{isAllowMoveX:o,isAllowMoveY:i}},r.prototype.move=function(t,e,n){n===void 0&&(n=!1);var o=this.isAllowMoveByXORY(t,e,n),i=o.isAllowMoveX,a=o.isAllowMoveY;return i&&(this.x=this.x+t,this.text&&this.moveText(t,0)),a&&(this.y=this.y+e,this.text&&this.moveText(0,e)),(i||a)&&(this.rotate=this._rotate),i||a},r.prototype.getMoveDistance=function(t,e,n){n===void 0&&(n=!1);var o=this.isAllowMoveByXORY(t,e,n),i=o.isAllowMoveX,a=o.isAllowMoveY,s=0,l=0;return i&&t&&(this.x=this.x+t,this.text&&this.moveText(t,0),s=t),a&&e&&(this.y=this.y+e,this.text&&this.moveText(0,e),l=e),this.transform=new Dn(-this.x,-this.y).rotate(this.rotate).translate(this.x,this.y).toString(),[s,l]},r.prototype.moveTo=function(t,e,n){n===void 0&&(n=!1);var o=t-this.x,i=e-this.y;return!n&&!this.isAllowMoveNode(o,i)?!1:(this.text&&this.moveText(o,i),this.x=t,this.y=e,!0)},r.prototype.moveText=function(t,e){var n=this.text,o=n.x,i=n.y,a=n.value,s=n.draggable,l=n.editable;this.text={value:a,editable:l,draggable:s,x:o+t,y:i+e}},r.prototype.updateText=function(t){this.text=ut(ut({},Vt(this.text)),{value:t})},r.prototype.addNodeResizeRules=function(t){this.resizeRules.includes(t)||this.resizeRules.push(t)},r.prototype.isAllowResizeNode=function(t,e,n,o){var i,a,s=this.resizeRules.concat(this.graphModel.nodeResizeRules);try{for(var l=Xa(s),u=l.next();!u.done;u=l.next()){var f=u.value,d=f(this,t,e,n,o);if(!d)return!1}}catch(c){i={error:c}}finally{try{u&&!u.done&&(a=l.return)&&a.call(l)}finally{if(i)throw i.error}}return!0},r.prototype.setSelected=function(t){t===void 0&&(t=!0),this.isSelected=t},r.prototype.setHovered=function(t){t===void 0&&(t=!0),this.isHovered=t,this.setIsShowAnchor(t)},r.prototype.setIsShowAnchor=function(t){t===void 0&&(t=!0),this.isShowAnchor=t},r.prototype.setRotatable=function(t){t===void 0&&(t=!0),this.rotatable=t},r.prototype.setResizable=function(t){t===void 0&&(t=!0),this.resizable=t},r.prototype.setHitable=function(t){t===void 0&&(t=!0),this.isHitable=t},r.prototype.setHittable=function(t){t===void 0&&(t=!0),this.isHittable=t},r.prototype.setElementState=function(t,e){this.state=t,this.additionStateData=e},r.prototype.updateProperties=function(t,e){var n=Vt(this.properties);this.properties=t,this.setAttributes(),this.graphModel.eventCenter.emit(C.NODE_PROPERTIES_CHANGE,{id:this.id,keys:e,preProperties:n,properties:t})},r.prototype.setProperty=function(t,e){var n=Vt(this.properties),o=k(n);Zl(o,t,vt(e)),this.updateProperties(o,[t])},r.prototype.setProperties=function(t){var e=Vt(this.properties),n=ut(ut({},e),vt(t)),o=[];Au(t,function(i,a){(Si(e,a)&&e[a]!==i||!Si(e,a))&&o.push(a)}),this.updateProperties(n,o)},r.prototype.deleteProperty=function(t){delete this.properties[t],this.setAttributes()},r.prototype.setStyle=function(t,e){var n;this.style=ut(ut({},this.style),(n={},n[t]=vt(e),n))},r.prototype.setStyles=function(t){this.style=ut(ut({},this.style),vt(t))},r.prototype.updateStyles=function(t){this.style=ut({},vt(t))},r.prototype.setZIndex=function(t){t===void 0&&(t=1),this.zIndex=t},r.prototype.updateAttributes=function(t){Q(this,t)},r.BaseType=ot.NODE,j([E],r.prototype,"type",void 0),j([E],r.prototype,"x",void 0),j([E],r.prototype,"y",void 0),j([E],r.prototype,"textMode",void 0),j([E],r.prototype,"text",void 0),j([E],r.prototype,"properties",void 0),j([E],r.prototype,"_width",void 0),j([E],r.prototype,"_height",void 0),j([E],r.prototype,"anchorsOffset",void 0),j([E],r.prototype,"isSelected",void 0),j([E],r.prototype,"isHovered",void 0),j([E],r.prototype,"isShowAnchor",void 0),j([E],r.prototype,"isDragging",void 0),j([E],r.prototype,"isHitable",void 0),j([E],r.prototype,"isHittable",void 0),j([E],r.prototype,"draggable",void 0),j([E],r.prototype,"visible",void 0),j([E],r.prototype,"rotatable",void 0),j([E],r.prototype,"resizable",void 0),j([E],r.prototype,"zIndex",void 0),j([E],r.prototype,"state",void 0),j([E],r.prototype,"autoToFront",void 0),j([E],r.prototype,"style",void 0),j([E],r.prototype,"transform",void 0),j([E],r.prototype,"_rotate",void 0),j([tt],r.prototype,"incoming",null),j([tt],r.prototype,"outgoing",null),j([x],r.prototype,"setTextMode",null),j([x],r.prototype,"addNodeMoveRules",null),j([x],r.prototype,"move",null),j([x],r.prototype,"getMoveDistance",null),j([x],r.prototype,"moveTo",null),j([x],r.prototype,"moveText",null),j([x],r.prototype,"updateText",null),j([x],r.prototype,"addNodeResizeRules",null),j([x],r.prototype,"setSelected",null),j([x],r.prototype,"setHovered",null),j([x],r.prototype,"setIsShowAnchor",null),j([x],r.prototype,"setRotatable",null),j([x],r.prototype,"setResizable",null),j([x],r.prototype,"setHitable",null),j([x],r.prototype,"setHittable",null),j([x],r.prototype,"setElementState",null),j([x],r.prototype,"setProperty",null),j([x],r.prototype,"setProperties",null),j([x],r.prototype,"deleteProperty",null),j([x],r.prototype,"setStyle",null),j([x],r.prototype,"setStyles",null),j([x],r.prototype,"updateStyles",null),j([x],r.prototype,"setZIndex",null),j([x],r.prototype,"updateAttributes",null),r}(),Wc=function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),xr=function(){return xr=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},xr.apply(this,arguments)},uo=function(r,t,e,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,t,e,n);else for(var s=r.length-1;s>=0;s--)(a=r[s])&&(i=(o<3?a(i):o>3?a(t,e,i):a(t,e))||i);return o>3&&i&&Object.defineProperty(t,e,i),i},ka=function(r){Wc(t,r);function t(e,n){var o=r.call(this,e,n)||this;return o.modelType=Y.CIRCLE_NODE,o.r=50,o.initNodeData(e),o.setAttributes(),o}return Object.defineProperty(t.prototype,"width",{get:function(){return this.r*2},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.r*2},enumerable:!1,configurable:!0}),t.prototype.setAttributes=function(){r.prototype.setAttributes.call(this);var e=this.properties.r;e&&(this.r=e)},t.prototype.getNodeStyle=function(){var e=r.prototype.getNodeStyle.call(this),n=this.graphModel.theme.circle,o=this.properties.style,i=o===void 0?{}:o;return xr(xr(xr({},e),k(n)),k(i))},t.prototype.getDefaultAnchor=function(){var e=this,n=e.x,o=e.y,i=e.r;return[{x:n,y:o-i,id:"".concat(this.id,"_0")},{x:n+i,y:o,id:"".concat(this.id,"_1")},{x:n,y:o+i,id:"".concat(this.id,"_2")},{x:n-i,y:o,id:"".concat(this.id,"_3")}]},t.prototype.resize=function(e){var n=e.width,o=e.deltaX,i=e.deltaY;return this.move(o/2,i/2),this.r=n,this.setProperties({r:n}),this.getData()},uo([E],t.prototype,"r",void 0),uo([tt],t.prototype,"width",null),uo([tt],t.prototype,"height",null),t}(Ee),Kc=function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Er=function(){return Er=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},Er.apply(this,arguments)},Be=function(r,t,e,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,t,e,n);else for(var s=r.length-1;s>=0;s--)(a=r[s])&&(i=(o<3?a(i):o>3?a(t,e,i):a(t,e))||i);return o>3&&i&&Object.defineProperty(t,e,i),i},en=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i},Ha=function(r){Kc(t,r);function t(e,n){var o=r.call(this,e,n)||this;return o.modelType=Y.DIAMOND_NODE,o.rx=30,o.ry=50,o.initNodeData(e),o.setAttributes(),o}return t.prototype.setAttributes=function(){r.prototype.setAttributes.call(this);var e=this.properties,n=e.rx,o=e.ry;n&&(this.rx=n),o&&(this.ry=o)},t.prototype.getNodeStyle=function(){var e=r.prototype.getNodeStyle.call(this),n=this.graphModel.theme.diamond,o=this.properties.style,i=o===void 0?{}:o;return Er(Er(Er({},e),k(n)),k(i))},Object.defineProperty(t.prototype,"points",{get:function(){var e=this,n=e.x,o=e.y,i=e.rx,a=e.ry;return[[n,o-a],[n+i,o],[n,o+a],[n-i,o]]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pointsPosition",{get:function(){return le(this.points,function(e){var n=en(e,2),o=n[0],i=n[1];return{x:o,y:i}})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){var e=Number.MAX_SAFE_INTEGER,n=Number.MIN_SAFE_INTEGER;return at(this.points,function(o){var i=en(o,1),a=i[0];a<e&&(e=a),a>n&&(n=a)}),n-e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){var e=Number.MAX_SAFE_INTEGER,n=Number.MIN_SAFE_INTEGER;return at(this.points,function(o){var i=en(o,2),a=i[1];a<e&&(e=a),a>n&&(n=a)}),n-e},enumerable:!1,configurable:!0}),t.prototype.getDefaultAnchor=function(){var e=this;return le(this.points,function(n,o){var i=en(n,2),a=i[0],s=i[1];return{x:a,y:s,id:"".concat(e.id,"_").concat(o)}})},t.prototype.resize=function(e){var n=e.width,o=e.height,i=e.deltaX,a=e.deltaY;return this.move(i/2,a/2),this.rx=n,this.ry=o,this.setProperties({rx:n,ry:o}),this.getData()},Be([E],t.prototype,"rx",void 0),Be([E],t.prototype,"ry",void 0),Be([tt],t.prototype,"points",null),Be([tt],t.prototype,"pointsPosition",null),Be([tt],t.prototype,"width",null),Be([tt],t.prototype,"height",null),t}(Ee),Zc=function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),br=function(){return br=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},br.apply(this,arguments)},rn=function(r,t,e,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,t,e,n);else for(var s=r.length-1;s>=0;s--)(a=r[s])&&(i=(o<3?a(i):o>3?a(t,e,i):a(t,e))||i);return o>3&&i&&Object.defineProperty(t,e,i),i},Ya=function(r){Zc(t,r);function t(e,n){var o=r.call(this,e,n)||this;return o.modelType=Y.ELLIPSE_NODE,o.rx=30,o.ry=45,o.initNodeData(e),o.setAttributes(),o}return t.prototype.setAttributes=function(){r.prototype.setAttributes.call(this);var e=this.properties,n=e.rx,o=e.ry;n&&(this.rx=n),o&&(this.ry=o)},t.prototype.getNodeStyle=function(){var e=r.prototype.getNodeStyle.call(this),n=this.graphModel.theme.ellipse,o=this.properties.style,i=o===void 0?{}:o;return br(br(br({},e),k(n)),k(i))},Object.defineProperty(t.prototype,"width",{get:function(){return this.rx*2},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.ry*2},enumerable:!1,configurable:!0}),t.prototype.getDefaultAnchor=function(){var e=this,n=e.x,o=e.y,i=e.rx,a=e.ry;return[{x:n,y:o-a,id:"".concat(this.id,"_0")},{x:n+i,y:o,id:"".concat(this.id,"_1")},{x:n,y:o+a,id:"".concat(this.id,"_2")},{x:n-i,y:o,id:"".concat(this.id,"_3")}]},t.prototype.resize=function(e){var n=e.width,o=e.height,i=e.deltaX,a=e.deltaY;return this.move(i/2,a/2),this.rx=n,this.ry=o,this.setProperties({rx:n,ry:o}),this.getData()},rn([E],t.prototype,"rx",void 0),rn([E],t.prototype,"ry",void 0),rn([tt],t.prototype,"width",null),rn([tt],t.prototype,"height",null),t}(Ee),qc=function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Or=function(){return Or=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},Or.apply(this,arguments)},nn=function(r,t,e,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,t,e,n);else for(var s=r.length-1;s>=0;s--)(a=r[s])&&(i=(o<3?a(i):o>3?a(t,e,i):a(t,e))||i);return o>3&&i&&Object.defineProperty(t,e,i),i},on=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i},Ga=function(r){qc(t,r);function t(e,n){var o=r.call(this,e,n)||this;return o.modelType=Y.POLYGON_NODE,o.points=[[50,0],[100,50],[50,100],[0,50]],o.initNodeData(e),o.setAttributes(),o}return t.prototype.setAttributes=function(){r.prototype.setAttributes.call(this);var e=this.properties,n=e.points,o=e.width,i=e.height,a=n||this.points;this.points=Uf(a,o,i)},t.prototype.getNodeStyle=function(){var e=r.prototype.getNodeStyle.call(this),n=this.graphModel.theme.polygon,o=this.properties.style,i=o===void 0?{}:o;return Or(Or(Or({},e),k(n)),k(i))},Object.defineProperty(t.prototype,"pointsPosition",{get:function(){var e=this,n=e.x,o=e.y,i=e.width,a=e.height;return this.points.map(function(s){return{x:s[0]+n-i/2,y:s[1]+o-a/2}})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){var e=Number.MAX_SAFE_INTEGER,n=Number.MIN_SAFE_INTEGER;return this.points.forEach(function(o){var i=on(o,1),a=i[0];a<e&&(e=a),a>n&&(n=a)}),n-e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){var e=Number.MAX_SAFE_INTEGER,n=Number.MIN_SAFE_INTEGER;return this.points.forEach(function(o){var i=on(o,2),a=i[1];a<e&&(e=a),a>n&&(n=a)}),n-e},enumerable:!1,configurable:!0}),t.prototype.getDefaultAnchor=function(){var e=this,n=this,o=n.x,i=n.y,a=n.width,s=n.height,l=n.points;return l.map(function(u,f){var d=on(u,2),c=d[0],p=d[1];return{x:o+c-a/2,y:i+p-s/2,id:"".concat(e.id,"_").concat(f)}})},t.prototype.resize=function(e){var n=this,o=e.width,i=e.height,a=e.deltaX,s=e.deltaY;this.move(a/2,s/2);var l=le(this.points,function(u){var f=on(u,2),d=f[0],c=f[1];return[d*o/n.width,c*i/n.height]});return this.points=l,this.properties.points=l,this.getData()},nn([E],t.prototype,"points",void 0),nn([tt],t.prototype,"pointsPosition",null),nn([tt],t.prototype,"width",null),nn([tt],t.prototype,"height",null),t}(Ee),Jc=function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Sr=function(){return Sr=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},Sr.apply(this,arguments)},Qc=function(r,t,e,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,t,e,n);else for(var s=r.length-1;s>=0;s--)(a=r[s])&&(i=(o<3?a(i):o>3?a(t,e,i):a(t,e))||i);return o>3&&i&&Object.defineProperty(t,e,i),i},za=function(r){Jc(t,r);function t(e,n){var o=r.call(this,e,n)||this;return o.modelType=Y.RECT_NODE,o.radius=0,o.initNodeData(e),o.setAttributes(),o}return t.prototype.setAttributes=function(){r.prototype.setAttributes.call(this);var e=this.properties,n=e.width,o=e.height,i=e.radius;Xt(n)||(this.width=n),Xt(o)||(this.height=o),Xt(i)||(this.radius=i)},t.prototype.getDefaultAnchor=function(){var e=this,n=e.x,o=e.y,i=e.width,a=e.height;return[{x:n,y:o-a/2,id:"".concat(this.id,"_0")},{x:n+i/2,y:o,id:"".concat(this.id,"_1")},{x:n,y:o+a/2,id:"".concat(this.id,"_2")},{x:n-i/2,y:o,id:"".concat(this.id,"_3")}]},t.prototype.getNodeStyle=function(){var e=r.prototype.getNodeStyle.call(this),n=this.graphModel.theme.rect,o=this.properties.style,i=o===void 0?{}:o;return Sr(Sr(Sr({},e),k(n)),k(i))},Qc([E],t.prototype,"radius",void 0),t}(Ee),tp=function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),wr=function(){return wr=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},wr.apply(this,arguments)},Fa=function(r,t,e,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,t,e,n);else for(var s=r.length-1;s>=0;s--)(a=r[s])&&(i=(o<3?a(i):o>3?a(t,e,i):a(t,e))||i);return o>3&&i&&Object.defineProperty(t,e,i),i},ep=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i},rp=function(r,t,e){if(e||arguments.length===2)for(var n=0,o=t.length,i;n<o;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return r.concat(i||Array.prototype.slice.call(t))},Ua=function(r){tp(t,r);function t(){var e=r.apply(this,rp([],ep(arguments),!1))||this;return e.modelType=Y.TEXT_NODE,e}return t.prototype.getTextStyle=function(){var e=r.prototype.getTextStyle.call(this),n=this.graphModel.theme.text,o=this.properties.textStyle;return wr(wr(wr({},e),k(n)),k(o))},Object.defineProperty(t.prototype,"width",{get:function(){var e=String(this.text.value).split(/[\r\n]/g),n=this.getTextStyle().fontSize,o=Da({rows:e,fontSize:n,rowsLength:e.length}).width;return o},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){var e=String(this.text.value).split(/[\r\n]/g),n=this.getTextStyle().fontSize,o=Da({rows:e,fontSize:n,rowsLength:e.length}).height;return o},enumerable:!1,configurable:!0}),Fa([tt],t.prototype,"width",null),Fa([tt],t.prototype,"height",null),t}(Ee),np=function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),$a=function(r){np(t,r);function t(e,n){var o=r.call(this,e,n)||this;return o.modelType=Y.HTML_NODE,o.setAttributes(),o}return t.prototype.setAttributes=function(){r.prototype.setAttributes.call(this);var e=this.properties,n=e.width,o=e.height;n&&(this.width=n),o&&(this.height=o)},t.prototype.getDefaultAnchor=function(){var e=this,n=e.x,o=e.y,i=e.width,a=e.height;return[{x:n,y:o-a/2,id:"".concat(this.id,"_0")},{x:n+i/2,y:o,id:"".concat(this.id,"_1")},{x:n,y:o+a/2,id:"".concat(this.id,"_2")},{x:n-i/2,y:o,id:"".concat(this.id,"_3")}]},t}(Ee),$=function(r,t,e,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,t,e,n);else for(var s=r.length-1;s>=0;s--)(a=r[s])&&(i=(o<3?a(i):o>3?a(t,e,i):a(t,e))||i);return o>3&&i&&Object.defineProperty(t,e,i),i},op={stopZoomGraph:!1,stopScrollGraph:!1,stopMoveGraph:!1,adjustEdge:!1,adjustEdgeStartAndEnd:!1,adjustNodePosition:!1,hideAnchors:!0,allowRotate:!1,allowResize:!1,nodeSelectedOutline:!0,textEdit:!1,nodeTextEdit:!1,edgeTextEdit:!1,textDraggable:!1,nodeTextDraggable:!1,edgeTextDraggable:!1},an=["isSilentMode","stopZoomGraph","stopScrollGraph","stopMoveGraph","snapGrid","adjustEdge","adjustEdgeMiddle","adjustEdgeStartAndEnd","adjustEdgeStart","adjustEdgeEnd","adjustNodePosition","hideAnchors","allowRotate","allowResize","autoExpand","hoverOutline","nodeSelectedOutline","edgeSelectedOutline","textEdit","nodeTextEdit","edgeTextEdit","textDraggable","nodeTextDraggable","edgeTextDraggable","multipleSelectKey","textMode","nodeTextMode","edgeTextMode","nodeTextMultiple","edgeTextMultiple","nodeTextVertical","edgeTextVertical"],ip=function(){function r(t){this.isSilentMode=!1,this.stopZoomGraph=!1,this.stopMoveGraph=!1,this.stopScrollGraph=!1,this.snapGrid=!1,this.textMode=Tt.TEXT,this.textEdit=!0,this.textDraggable=!1,this.nodeTextEdit=!0,this.nodeTextDraggable=!1,this.nodeTextMultiple=!1,this.nodeTextVertical=!1,this.nodeTextMode=Tt.TEXT,this.edgeTextMode=Tt.TEXT,this.edgeTextEdit=!0,this.edgeTextDraggable=!1,this.edgeTextMultiple=!1,this.edgeTextVertical=!1,this.hideAnchors=!1,this.allowRotate=!1,this.allowResize=!1,this.hoverOutline=!0,this.nodeSelectedOutline=!0,this.adjustNodePosition=!0,this.autoExpand=!1,this.adjustEdge=!0,this.adjustEdgeMiddle=!1,this.adjustEdgeStartAndEnd=!1,this.adjustEdgeStart=!1,this.adjustEdgeEnd=!1,this.edgeSelectedOutline=!0,this.multipleSelectKey="",Q(this,this.computeConfig(t))}return r.prototype.updateEditConfig=function(t){var e=this.computeConfig(t);Q(this,e)},r.prototype.computeConfig=function(t){var e=t.isSilentMode,n=t.textDraggable,o=t.textMode,i=t.textEdit,a=t.adjustEdgeStartAndEnd,s={};if(e===!1&&Q(s,this.stagedConfig),e===!0&&e!==this.isSilentMode){var l=Ye(op,an);this.stagedConfig=Ye(this,an),Q(s,l)}Ue(i)||Q(s,{nodeTextEdit:i,edgeTextEdit:i}),Ue(n)||Q(s,{nodeTextDraggable:n,edgeTextDraggable:n}),o&&Q(s,{nodeTextMode:o,edgeTextMode:o}),mo(a)&&Q(s,{adjustEdgeStart:a,adjustEdgeEnd:a});var u=Ye(t,an);return Q(s,u)},r.prototype.updateTextMode=function(t){this.textMode=t,this.edgeTextMode=t,this.nodeTextMode=t},r.prototype.getConfig=function(){return Ye(this,an)},$([E],r.prototype,"isSilentMode",void 0),$([E],r.prototype,"stopZoomGraph",void 0),$([E],r.prototype,"stopMoveGraph",void 0),$([E],r.prototype,"stopScrollGraph",void 0),$([E],r.prototype,"snapGrid",void 0),$([E],r.prototype,"textMode",void 0),$([E],r.prototype,"textEdit",void 0),$([E],r.prototype,"textDraggable",void 0),$([E],r.prototype,"nodeTextEdit",void 0),$([E],r.prototype,"nodeTextDraggable",void 0),$([E],r.prototype,"nodeTextMultiple",void 0),$([E],r.prototype,"nodeTextVertical",void 0),$([E],r.prototype,"nodeTextMode",void 0),$([E],r.prototype,"edgeTextMode",void 0),$([E],r.prototype,"edgeTextEdit",void 0),$([E],r.prototype,"edgeTextDraggable",void 0),$([E],r.prototype,"edgeTextMultiple",void 0),$([E],r.prototype,"edgeTextVertical",void 0),$([E],r.prototype,"hideAnchors",void 0),$([E],r.prototype,"allowRotate",void 0),$([E],r.prototype,"allowResize",void 0),$([E],r.prototype,"hoverOutline",void 0),$([E],r.prototype,"nodeSelectedOutline",void 0),$([E],r.prototype,"adjustNodePosition",void 0),$([E],r.prototype,"autoExpand",void 0),$([E],r.prototype,"adjustEdge",void 0),$([E],r.prototype,"adjustEdgeMiddle",void 0),$([E],r.prototype,"adjustEdgeStartAndEnd",void 0),$([E],r.prototype,"adjustEdgeStart",void 0),$([E],r.prototype,"adjustEdgeEnd",void 0),$([E],r.prototype,"edgeSelectedOutline",void 0),$([x],r.prototype,"updateEditConfig",null),$([x],r.prototype,"updateTextMode",null),r}(),ap="*",sp=function(){function r(){this._events={}}return r.prototype.on=function(t,e,n){var o=this;t==null||t.split(",").forEach(function(i){i=i.trim(),o._events[i]||(o._events[i]=[]),o._events[i].push({callback:e,once:!!n})})},r.prototype.once=function(t,e){var n=this;t==null||t.split(",").forEach(function(o){o=o.trim(),n.on(o,e,!0)})},r.prototype.emit=function(t,e){var n=this;t==null||t.split(",").forEach(function(o){var i=n._events[o]||[],a=n._events[ap]||[],s=function(l){for(var u=l.length,f=0;f<u;f++)if(l[f]){var d=l[f],c=d.callback,p=d.once;p&&(l.splice(f,1),l.length===0&&delete n._events[o],u--,f--),c.apply(n,[e])}};s(i),s(a)})},r.prototype.off=function(t,e){var n=this;t||(this._events={}),t.split(",").forEach(function(o){if(!e)delete n._events[o];else{for(var i=n._events[o]||[],a=i.length,s=0;s<a;s++)i[s].callback===e&&(i.splice(s,1),a--,s--);i.length===0&&delete n._events[o]}})},r.prototype.getEvents=function(){return this._events},r.prototype.destroy=function(){this._events={}},r}(),lp=function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),zo=function(){return zo=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},zo.apply(this,arguments)},up=function(r,t,e,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,t,e,n);else for(var s=r.length-1;s>=0;s--)(a=r[s])&&(i=(o<3?a(i):o>3?a(t,e,i):a(t,e))||i);return o>3&&i&&Object.defineProperty(t,e,i),i},dp=function(r){lp(t,r);function t(e){var n=r.call(this)||this;n.stepScrollX=0,n.stepScrollY=0,n.onDragging=function(s){var l=s.deltaX,u=s.deltaY;n.setState({isDragging:!0});var f=n.props.graphModel,d=f.transformModel,c=f.editConfigModel;c.stopMoveGraph!==!0&&d.translate(l,u)},n.onDragEnd=function(){n.setState({isDragging:!1})},n.zoomHandler=function(s){var l=n.props,u=l.graphModel,f=u.editConfigModel,d=u.transformModel,c=u.gridSize,p=l.graphModel,v=s.deltaX,h=s.deltaY,g=f.stopScrollGraph,y=f.stopZoomGraph;if(!g&&!s.ctrlKey&&!s.metaKey){if(s.preventDefault(),n.stepScrollX+=v,n.stepScrollY+=h,Math.abs(n.stepScrollX)>=c){var _=n.stepScrollX%c,S=n.stepScrollX-_;d.translate(-S*d.SCALE_X,0),n.stepScrollX=_}if(Math.abs(n.stepScrollY)>=c){var M=n.stepScrollY%c,w=n.stepScrollY-M;d.translate(0,-w*d.SCALE_Y),n.stepScrollY=M}return}if(!y){s.preventDefault();var A=p.getPointByClient({x:s.clientX,y:s.clientY}),m=A.canvasOverlayPosition,O=m.x,P=m.y;d.zoom(s.deltaY<0,[O,P])}},n.clickHandler=function(s){var l=s.target;if(l.getAttribute("name")==="canvas-overlay"){var u=n.props.graphModel,f=u.selectElements;f.size>0&&u.clearSelectElements(),u.eventCenter.emit(C.BLANK_CLICK,{e:s})}},n.handleContextMenu=function(s){var l=s.target;if(l.getAttribute("name")==="canvas-overlay"){s.preventDefault();var u=n.props.graphModel,f=u.getPointByClient({x:s.clientX,y:s.clientY});u.eventCenter.emit(C.BLANK_CONTEXTMENU,{e:s,position:f})}},n.mouseDownHandler=function(s){var l=n.props.graphModel,u=l.eventCenter,f=l.editConfigModel,d=l.transformModel.SCALE_X,c=l.gridSize,p=f.adjustEdge,v=f.adjustNodePosition,h=f.stopMoveGraph,g=s.target,y=!p&&!v;(g.getAttribute("name")==="canvas-overlay"||y)&&(h!==!0?(n.stepDrag.setStep(c*d),n.stepDrag.handleMouseDown(s)):u.emit(C.BLANK_MOUSEDOWN,{e:s}),n.clickHandler(s))};var o=e.graphModel,i=o.gridSize,a=o.eventCenter;return n.stepDrag=new re({onDragging:n.onDragging,onDragEnd:n.onDragEnd,step:i,eventType:"BLANK",isStopPropagation:!1,eventCenter:a,model:void 0}),n.state={isDragging:!1},n}return t.prototype.render=function(){var e=this.props.graphModel.transformModel,n=e.getTransformStyle().transform,o=this.props,i=o.children,a=o.dnd,s=this.state.isDragging;return b("svg",zo({xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%",name:"canvas-overlay",onWheel:this.zoomHandler,onMouseDown:this.mouseDownHandler,onContextMenu:this.handleContextMenu,className:s?"lf-canvas-overlay lf-dragging":"lf-canvas-overlay lf-drag-able"},a.eventMap(),{children:b("g",{transform:n,children:i})}))},t=up([St],t),t}(z),Ml=function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Br=function(){return Br=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},Br.apply(this,arguments)},fp=function(r,t,e,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,t,e,n);else for(var s=r.length-1;s>=0;s--)(a=r[s])&&(i=(o<3?a(i):o>3?a(t,e,i):a(t,e))||i);return o>3&&i&&Object.defineProperty(t,e,i),i},cp=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i},Va=function(r){Ml(t,r);function t(){var e=r.call(this)||this;return e.onDragging=function(n){var o=n.event,i=e.props,a=i.graphModel,s=i.bezierModel,l=i.type,u=a.getPointByClient({x:o.clientX,y:o.clientY}).canvasOverlayPosition,f=u.x,d=u.y;s.updateAdjustAnchor({x:f,y:d},l),a.eventCenter.emit(C.EDGE_ADJUST,{data:s.getData()})},e.onDragEnd=function(){var n=e.props.bezierModel;n.isDragging=!1},e.dragHandler=new re({onDragging:e.onDragging,onDragEnd:e.onDragEnd}),e}return t.prototype.render=function(){var e=this,n=this.props.position,o=n.x,i=n.y,a=this.props.bezierModel,s=a.getEdgeStyle().adjustAnchor;return b(nr,Br({className:"lf-bezier-adjust-anchor",x:o,y:i},s,{onMouseDown:function(l){e.dragHandler.handleMouseDown(l)}}))},t}(z),pp=function(r){Ml(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.getBezierAdjust=function(e,n){var o=e.path,i=e.id,a=mi(o),s=cp(a,4),l=s[0],u=s[1],f=s[2],d=s[3],c=e.getEdgeStyle().adjustLine,p=[];return p.push(b(rr,Br({x1:l.x,y1:l.y,x2:u.x,y2:u.y},c))),p.push(b(Va,{position:u,bezierModel:e,graphModel:n,type:"sNext"},"".concat(i,"_ePre"))),p.push(b(rr,Br({x1:d.x,y1:d.y,x2:f.x,y2:f.y},c))),p.push(b(Va,{position:f,bezierModel:e,graphModel:n,type:"ePre"},"".concat(i,"_sNext"))),p},t.prototype.selectedBezierEdge=function(){for(var e=this.props.graphModel,n=e.edges,o=[],i=0;i<n.length;i++){var a=n[i];a.isSelected&&a.modelType===Y.BEZIER_EDGE&&a.draggable&&o.push(this.getBezierAdjust(a,e))}return o},t.prototype.render=function(){return b("g",{className:"lf-bezier-adjust",children:this.selectedBezierEdge()})},t=fp([St],t),t}(z),hp=function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),vp=function(r,t,e,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,t,e,n);else for(var s=r.length-1;s>=0;s--)(a=r[s])&&(i=(o<3?a(i):o>3?a(t,e,i):a(t,e))||i);return o>3&&i&&Object.defineProperty(t,e,i),i},yp=function(r){hp(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.render=function(){var e=this.props.background;return b("div",{className:"lf-background",children:b("div",{style:ql(e)?e:{},className:"lf-background-area"})})},t=vp([St],t),t}(z),gp=function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),_p=function(r,t,e,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,t,e,n);else for(var s=r.length-1;s>=0;s--)(a=r[s])&&(i=(o<3?a(i):o>3?a(t,e,i):a(t,e))||i);return o>3&&i&&Object.defineProperty(t,e,i),i},Ln=function(r){gp(t,r);function t(e){var n=r.call(this,e)||this;return n.id=De(),n.gridOptions=n.props.graphModel.grid,n}return t.prototype.renderDot=function(){var e=this.gridOptions,n=e.config,o=e.size,i=o===void 0?1:o,a=e.visible,s=n??{},l=s.color,u=s.thickness,f=u===void 0?2:u,d=Math.min(Math.max(2,f),i/4),c=a?1:0;return b("g",{fill:l,opacity:c,children:[b("circle",{cx:0,cy:0,r:d/2}),b("circle",{cx:0,cy:i,r:d/2}),b("circle",{cx:i,cy:0,r:d/2}),b("circle",{cx:i,cy:i,r:d/2})]})},t.prototype.renderMesh=function(){var e=this.gridOptions,n=e.config,o=e.size,i=o===void 0?1:o,a=e.visible,s=n??{},l=s.color,u=s.thickness,f=u===void 0?1:u,d=Math.min(Math.max(1,f),i/2),c="M 0 0 H ".concat(i," V ").concat(i," H 0 Z"),p=a?1:0;return b("path",{d:c,stroke:l,strokeWidth:d/2,opacity:p,fill:"transparent"})},t.prototype.render=function(){var e=this.props.graphModel.transformModel,n=this.gridOptions,o=n.type,i=n.size,a=i===void 0?1:i,s=e.SCALE_X,l=e.SKEW_Y,u=e.SKEW_X,f=e.SCALE_Y,d=e.TRANSLATE_X,c=e.TRANSLATE_Y,p=[s,l,u,f,d,c].join(","),v="matrix(".concat(p,")");return b("div",{className:"lf-grid",children:b("svg",{xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"100%",height:"100%",children:[b("defs",{children:b("pattern",{id:this.id,patternUnits:"userSpaceOnUse",patternTransform:v,x:"0",y:"0",width:a,height:a,children:[o==="dot"&&this.renderDot(),o==="mesh"&&this.renderMesh()]})}),b("rect",{width:"100%",height:"100%",fill:"url(#".concat(this.id,")")})]})})},t=_p([St],t),t}(z);(function(r){r.defaultProps={size:bf,visible:!0,type:"dot",config:{color:"#ababab",thickness:1}};function t(e){var n=k(r.defaultProps);return typeof e=="number"?Q(n,{size:e}):typeof e=="boolean"?Q(n,{visible:e}):Q(n,e)}r.getGridOptions=t})(Ln||(Ln={}));var mp=function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),xp=function(r,t,e,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,t,e,n);else for(var s=r.length-1;s>=0;s--)(a=r[s])&&(i=(o<3?a(i):o>3?a(t,e,i):a(t,e))||i);return o>3&&i&&Object.defineProperty(t,e,i),i},Ep=function(r){mp(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.render=function(){var e=this.props.graphModel.transformModel,n=e.getTransformStyle().transform,o=this.props.children;return b("svg",{xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"100%",height:"100%",className:"modification-overlay",children:b("g",{transform:n,children:o})})},t=xp([St],t),t}(z),bp=function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),fe=function(){return fe=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},fe.apply(this,arguments)},Op=function(r,t,e,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,t,e,n);else for(var s=r.length-1;s>=0;s--)(a=r[s])&&(i=(o<3?a(i):o>3?a(t,e,i):a(t,e))||i);return o>3&&i&&Object.defineProperty(t,e,i),i},Sp=function(r){bp(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.getNodesOutline=function(){var e=this.props.graphModel,n=e.nodes,o=e.editConfigModel,i=o.hoverOutline,a=o.nodeSelectedOutline,s=[];return n.forEach(function(l){if(l.isHovered||l.isSelected){var u=l.isHovered,f=l.isSelected,d=l.x,c=l.y,p=l.width,v=l.height;if(a&&f||i&&u){var h=l.getOutlineStyle(),g={};if(Object.keys(h).forEach(function(_){_!=="hover"&&(g[_]=h[_])}),u){var y=h.hover;g=fe(fe({},g),y)}s.push(b(qt,fe({transform:l.transform,className:"lf-outline-node",x:d,y:c,width:p+10,height:v+10},g)))}}}),s},t.prototype.getEdgeOutline=function(){for(var e=this.props.graphModel,n=e.edges,o=e.editConfigModel,i=o.edgeSelectedOutline,a=o.hoverOutline,s=[],l=0;l<n.length;l++){var u=n[l];(i&&u.isSelected||a&&u.isHovered)&&(u.modelType===Y.LINE_EDGE?s.push(this.getLineOutline(u)):u.modelType===Y.POLYLINE_EDGE?s.push(this.getPolylineOutline(u)):u.modelType===Y.BEZIER_EDGE&&s.push(this.getBezierOutline(u)))}return s},t.prototype.getLineOutline=function(e){var n=e.startPoint,o=e.endPoint,i=(n.x+o.x)/2,a=(n.y+o.y)/2,s=Math.abs(n.x-o.x)+10,l=Math.abs(n.y-o.y)+10,u=e.getOutlineStyle();return b(qt,fe({className:"lf-outline-edge",x:i,y:a,width:s,height:l},u))},t.prototype.getPolylineOutline=function(e){var n=e.points,o=Re(n),i=Rr(o,8),a=i.x,s=i.y,l=i.width,u=i.height,f=e.getOutlineStyle();return b(qt,fe({className:"lf-outline",x:a,y:s,width:l,height:u},f))},t.prototype.getBezierOutline=function(e){var n=e.path,o=mi(n),i=Rr(o,8),a=i.x,s=i.y,l=i.width,u=i.height,f=e.getOutlineStyle();return b(qt,fe({className:"lf-outline",x:a,y:s,width:l,height:u},f))},t.prototype.render=function(){return b("g",{className:"lf-outline",children:[this.getNodesOutline(),this.getEdgeOutline()]})},t=Op([St],t),t}(z),wp=function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),ce=function(){return ce=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},ce.apply(this,arguments)},Mp=function(r,t,e,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,t,e,n);else for(var s=r.length-1;s>=0;s--)(a=r[s])&&(i=(o<3?a(i):o>3?a(t,e,i):a(t,e))||i);return o>3&&i&&Object.defineProperty(t,e,i),i},Ap=function(r){wp(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.render=function(){var e=this.props.snaplineModel,n=e??{},o=n.position,i=n.isShowHorizontal,a=n.isShowVertical,s=e==null?void 0:e.getStyle(),l=o??{},u=l.x,f=u===void 0?0:u,d=l.y,c=d===void 0?0:d,p=ce(ce({x1:-1e5,y1:c,x2:1e5,y2:c},s),{stroke:i?s==null?void 0:s.stroke:"none"}),v=ce(ce({x1:f,y1:-1e5,x2:f,y2:1e5},s),{stroke:a?s==null?void 0:s.stroke:"none"});return b("g",{className:"lf-snapline",children:[b(rr,ce({},p)),b(rr,ce({},v))]})},t=Mp([St],t),t}(z),Pp=function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Tp=function(r,t,e,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,t,e,n);else for(var s=r.length-1;s>=0;s--)(a=r[s])&&(i=(o<3?a(i):o>3?a(t,e,i):a(t,e))||i);return o>3&&i&&Object.defineProperty(t,e,i),i},Dp=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i},Np=function(r,t,e){if(e||arguments.length===2)for(var n=0,o=t.length,i;n<o;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return r.concat(i||Array.prototype.slice.call(t))},Cp=function(r){Pp(t,r);function t(){var e=r.apply(this,Np([],Dp(arguments),!1))||this;return e.zoomHandler=function(n){var o;(o=e.props.getCanvasOverlay())===null||o===void 0||o.zoomHandler(n)},e}return t.prototype.componentDidMount=function(){this.triggerToolRender()},t.prototype.componentDidUpdate=function(){this.triggerToolRender()},t.prototype.getTools=function(){var e=this.props,n=e.tool,o=e.graphModel,i=o.textEditElement,a=n.getTools(),s=a.map(function(l){return $e(l,{textEditElement:i,graphModel:o,lf:n.instance})});return n.components=s,s},t.prototype.triggerToolRender=function(){var e=this.props,n=e.tool,o=e.graphModel,i=document.querySelector("#ToolOverlay_".concat(o.flowId)),a=n.getInstance();a.components.forEach(function(s){return s(a,i)}),a.components=[]},t.prototype.render=function(){var e=this.props.graphModel;return b("div",{className:"lf-tool-overlay",id:"ToolOverlay_".concat(e.flowId),onWheel:this.zoomHandler,children:this.getTools()})},t=Tp([St],t),t}(z),pe=function(){return pe=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},pe.apply(this,arguments)},D=function(r,t,e,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,t,e,n);else for(var s=r.length-1;s>=0;s--)(a=r[s])&&(i=(o<3?a(i):o>3?a(t,e,i):a(t,e))||i);return o>3&&i&&Object.defineProperty(t,e,i),i},Rp=function(r){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&r[t],n=0;if(e)return e.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},dt=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i},Mt=function(r,t,e){if(e||arguments.length===2)for(var n=0,o=t.length,i;n<o;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return r.concat(i||Array.prototype.slice.call(t))},jp=function(){function r(t){var e=this,n,o;this.modelMap=new Map,this.nodeModelMap=new Map,this.edgeModelMap=new Map,this.elementsModelMap=new Map,this.nodeMoveRules=[],this.nodeResizeRules=[],this.nodes=[],this.edges=[],this.overlapMode=Bt.DEFAULT,this.gridSize=1,this.partial=!1,this.waitCleanEffects=[];var i=t.container,a=t.partial,s=t.background,l=s===void 0?{}:s,u=t.grid,f=t.idGenerator,d=t.edgeGenerator,c=t.animation,p=t.customTrajectory;this.rootEl=i,this.partial=!!a,this.background=l,typeof u=="object"&&t.snapGrid&&(this.gridSize=u.size||1),this.theme=wl(t.style),this.grid=Ln.getGridOptions(u??!1),this.edgeType=t.edgeType||"polyline",this.animation=mf(c),this.overlapMode=t.overlapMode||Bt.DEFAULT,this.width=(n=t.width)!==null&&n!==void 0?n:this.rootEl.getBoundingClientRect().width,this.isContainerWidth=Xt(t.width),this.height=(o=t.height)!==null&&o!==void 0?o:this.rootEl.getBoundingClientRect().height,this.isContainerHeight=Xt(t.height);var v=new ResizeObserver(hs(function(h){var g,y;try{for(var _=Rp(h),S=_.next();!S.done;S=_.next()){var M=S.value;M.target===e.rootEl&&(e.resize(),e.eventCenter.emit("graph:resize",{target:e.rootEl,contentRect:M.contentRect}))}}catch(w){g={error:w}}finally{try{S&&!S.done&&(y=_.return)&&y.call(_)}finally{if(g)throw g.error}}},16));v.observe(this.rootEl),this.waitCleanEffects.push(function(){v.disconnect()}),this.eventCenter=new sp,this.editConfigModel=new ip(t),this.transformModel=new Bp(this.eventCenter,t),this.flowId=De(),this.idGenerator=f,this.edgeGenerator=zf(this,d),this.customTrajectory=p}return Object.defineProperty(r.prototype,"nodesMap",{get:function(){return this.nodes.reduce(function(t,e,n){return t[e.id]={index:n,model:e},t},{})},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"edgesMap",{get:function(){return this.edges.reduce(function(t,e,n){return t[e.id]={index:n,model:e},t},{})},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"modelsMap",{get:function(){return Mt(Mt([],dt(this.nodes),!1),dt(this.edges),!1).reduce(function(t,e){return t[e.id]=e,t},{})},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"sortElements",{get:function(){for(var t=Mt(Mt([],dt(this.nodes),!1),dt(this.edges),!1).sort(function(s,l){return s.zIndex-l.zIndex}),e=[],n=[-200,-200],o=[this.width+ca,this.height+ca],i=0;i<t.length;i++){var a=t[i];a.visible&&(!this.partial||a.isSelected||this.isElementInArea(a,n,o,!1,!1))&&e.push(a)}return e},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"textEditElement",{get:function(){var t=this.nodes.find(function(n){return n.state===V.TEXT_EDIT}),e=this.edges.find(function(n){return n.state===V.TEXT_EDIT});return t||e},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"selectElements",{get:function(){var t=new Map;return this.nodes.forEach(function(e){e.isSelected&&t.set(e.id,e)}),this.edges.forEach(function(e){e.isSelected&&t.set(e.id,e)}),t},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"selectNodes",{get:function(){var t=[];return this.nodes.forEach(function(e){e.isSelected&&t.push(e)}),t},enumerable:!1,configurable:!0}),r.prototype.getAreaElement=function(t,e,n,o,i){var a=this;n===void 0&&(n=!0),o===void 0&&(o=!0),i===void 0&&(i=!1);var s=[];return at(Mt(Mt([],dt(this.nodes),!1),dt(this.edges),!1),function(l){var u=a.isElementInArea(l,t,e,n,o);(!i||l.visible)&&u&&s.push(l)}),s},r.prototype.getModel=function(t){return this.modelMap.get(t)},r.prototype.getNodeModelById=function(t){var e;return this.fakeNode&&t===this.fakeNode.id?this.fakeNode:(e=this.nodesMap[t])===null||e===void 0?void 0:e.model},r.prototype.getPointByClient=function(t){var e=t.x,n=t.y,o=this.rootEl.getBoundingClientRect(),i={x:e-o.left,y:n-o.top},a=dt(this.transformModel.HtmlPointToCanvasPoint([i.x,i.y]),2),s=a[0],l=a[1],u={x:s,y:l};return{domOverlayPosition:i,canvasOverlayPosition:u}},r.prototype.isElementInArea=function(t,e,n,o,i){var a;if(o===void 0&&(o=!0),i===void 0&&(i=!0),t.BaseType===ot.NODE){t=t;for(var s=Ot(t),l=s.minX,u=s.minY,f=s.maxX,d=s.maxY,c=[{x:l,y:u},{x:f,y:u},{x:f,y:d},{x:l,y:d}],p=i,v=0;v<c.length;v++){var h=c[v],g=h.x,y=h.y;if(a=dt(this.transformModel.CanvasPointToHtmlPoint([g,y]),2),g=a[0],y=a[1],ao([g,y],e,n)!==i){p=!i;break}}return p}if(t.BaseType===ot.EDGE){t=t;var _=t.startPoint,S=t.endPoint,M=this.transformModel.CanvasPointToHtmlPoint([_.x,_.y]),w=this.transformModel.CanvasPointToHtmlPoint([S.x,S.y]),A=ao(M,e,n),m=ao(w,e,n);return o?A&&m:A||m}return!1},r.prototype.graphDataToModel=function(t){var e=this;if(!t){this.clearData();return}if(this.elementsModelMap.clear(),this.nodeModelMap.clear(),this.edgeModelMap.clear(),t.nodes?this.nodes=le(t.nodes,function(o){var i=e.getModelAfterSnapToGrid(o);return e.elementsModelMap.set(i.id,i),e.nodeModelMap.set(i.id,i),i}):this.nodes=[],t.edges){var n=this.edgeType;this.edges=le(t.edges,function(o){var i,a=e.getModel((i=o.type)!==null&&i!==void 0?i:n);if(!a)throw new Error("找不到".concat(o.type,"对应的边。"));var s=new a(o,e);return e.edgeModelMap.set(s.id,s),e.elementsModelMap.set(s.id,s),s})}else this.edges=[]},r.prototype.modelToGraphData=function(){var t=[];this.edges.forEach(function(n){var o=n.getData();o&&!n.virtual&&t.push(o)});var e=[];return this.nodes.forEach(function(n){var o=n.getData();o&&!n.virtual&&e.push(o)}),{nodes:e,edges:t}},r.prototype.modelToHistoryData=function(){for(var t=!1,e=[],n=0;n<this.nodes.length;n++){var o=this.nodes[n];if(o.isDragging){t=!0;break}else e.push(o.getHistoryData())}if(t)return!1;for(var i=!1,a=[],s=0;s<this.edges.length;s++){var l=this.edges[s];if(l.isDragging){i=!0;break}else a.push(l.getHistoryData())}return i?!1:{nodes:e,edges:a}},r.prototype.getEdgeModelById=function(t){var e;return(e=this.edgesMap[t])===null||e===void 0?void 0:e.model},r.prototype.getElement=function(t){return this.modelsMap[t]},r.prototype.getNodeEdges=function(t){for(var e=[],n=0;n<this.edges.length;n++){var o=this.edges[n],i=o.sourceNodeId===t,a=o.targetNodeId===t;(i||a)&&e.push(o)}return e},r.prototype.getSelectElements=function(t){t===void 0&&(t=!0);var e=this.selectElements,n={nodes:[],edges:[]};return e.forEach(function(o){if(o.BaseType===ot.NODE&&n.nodes.push(o.getData()),o.BaseType===ot.EDGE){var i=o.getData(),a=e.get(i.sourceNodeId)&&e.get(i.targetNodeId);(t||a)&&n.edges.push(i)}}),n},r.prototype.updateAttributes=function(t,e){var n=this.getElement(t);n==null||n.updateAttributes(e)},r.prototype.changeNodeId=function(t,e){return e||(e=De()),this.nodesMap[e]?(console.warn("当前流程图已存在节点".concat(e,", 修改失败")),""):this.nodesMap[t]?(this.edges.forEach(function(n){n.sourceNodeId===t&&(n.sourceNodeId=e),n.targetNodeId===t&&(n.targetNodeId=e)}),this.nodesMap[t].model.id=e,this.nodesMap[e]=this.nodesMap[t],e):(console.warn("当前流程图找不到节点".concat(t,", 修改失败")),"")},r.prototype.changeEdgeId=function(t,e){return e||(e=De()),this.edgesMap[e]?(console.warn("当前流程图已存在边: ".concat(e,", 修改失败")),""):this.edgesMap[t]?(this.edges.forEach(function(n){n.id===t&&n.changeEdgeId(e)}),e):(console.warn("当前流程图找不到边: ".concat(e,", 修改失败")),"")},r.prototype.getTextModel=function(t){var e=this.editConfigModel,n=e.textMode,o=e.nodeTextMode,i=e.edgeTextMode;if(t.BaseType===ot.NODE)return t.textMode||o||n||Tt.TEXT;if(t.BaseType===ot.EDGE)return t.textMode||i||n||Tt.TEXT},r.prototype.setTextMode=function(t,e){this.editConfigModel.updateEditConfig({textMode:t})},r.prototype.setFakeNode=function(t){this.fakeNode=t},r.prototype.removeFakeNode=function(){this.fakeNode=null},r.prototype.setModel=function(t,e){return this.modelMap.set(t,e)},r.prototype.toFront=function(t){var e,n,o,i=((e=this.nodesMap[t])===null||e===void 0?void 0:e.model)||((n=this.edgesMap[t])===null||n===void 0?void 0:n.model);i&&(this.overlapMode===Bt.DEFAULT&&((o=this.topElement)===null||o===void 0||o.setZIndex(),i.setZIndex(Ef),this.topElement=i),this.overlapMode===Bt.INCREASE&&this.setElementZIndex(t,"top"))},r.prototype.setElementZIndex=function(t,e){var n,o,i=((n=this.nodesMap[t])===null||n===void 0?void 0:n.model)||((o=this.edgesMap[t])===null||o===void 0?void 0:o.model);if(i){var a=void 0;typeof e=="number"?a=e:(e==="top"&&(a=Ei()),e==="bottom"&&(a=Yc())),i.setZIndex(a)}},r.prototype.deleteNode=function(t){var e=this.nodesMap[t].model,n=e.getData();this.deleteEdgeBySource(t),this.deleteEdgeByTarget(t),this.nodes.splice(this.nodesMap[t].index,1),this.eventCenter.emit(C.NODE_DELETE,{data:n,model:e})},r.prototype.addNode=function(t,e,n){e===void 0&&(e=C.NODE_ADD);var o=vt(t),i=o.id;i&&this.nodesMap[i]&&delete o.id;var a=this.getModelAfterSnapToGrid(o);this.nodes.push(a);var s=a.getData(),l={data:s};return n&&(l.e=n),this.eventCenter.emit(e,l),a},r.prototype.getModelAfterSnapToGrid=function(t){var e=this.getModel(t.type),n=this.editConfigModel.snapGrid;if(!e)throw new Error("找不到".concat(t.type,"对应的节点，请确认是否已注册此类型节点。"));var o=t.x,i=t.y;o&&i&&(t.x=er(o,this.gridSize,n),t.y=er(i,this.gridSize,n),typeof t.text=="object"&&t.text!==null&&(t.text.x+=t.x-o,t.text.y+=t.y-i));var a=new e(t,this);return this.nodeModelMap.set(a.id,a),this.elementsModelMap.set(a.id,a),a},r.prototype.cloneNode=function(t){var e=this.getNodeModelById(t),n=e==null?void 0:e.getData();if(n){n.x+=30,n.y+=30,n.id="",typeof n.text=="object"&&n.text!==null&&(n.text.x+=30,n.text.y+=30);var o=this.addNode(n);return o.setSelected(!0),e==null||e.setSelected(!1),o.getData()}},r.prototype.moveNode=function(t,e,n,o){var i;o===void 0&&(o=!1);var a=this.nodesMap[t];if(!a){console.warn("不存在id为".concat(t,"的节点"));return}var s=a.model;i=dt(s.getMoveDistance(e,n,o),2),e=i[0],n=i[1],this.moveEdge(t,e,n)},r.prototype.moveNode2Coordinate=function(t,e,n,o){o===void 0&&(o=!1);var i=this.nodesMap[t];if(!i){console.warn("不存在id为".concat(t,"的节点"));return}var a=i.model,s=a.x,l=a.y,u=e-s,f=n-l;this.moveNode(t,u,f,o)},r.prototype.editText=function(t){this.setElementStateById(t,V.TEXT_EDIT)},r.prototype.addEdge=function(t){var e=vt(t),n=e.type;n||(n=this.edgeType),e.id&&this.edgesMap[e.id]&&delete e.id;var o=this.getModel(n);if(!o)throw new Error("找不到".concat(n,"对应的边，请确认是否已注册此类型边。"));var i=new o(pe(pe({},e),{type:n}),this);this.edgeModelMap.set(i.id,i),this.elementsModelMap.set(i.id,i);var a=i.getData();return this.edges.push(i),this.eventCenter.emit(C.EDGE_ADD,{data:a}),i},r.prototype.moveEdge=function(t,e,n){for(var o=0;o<this.edges.length;o++){var i=this.edges[o],a=i.textPosition,s=a.x,l=a.y,u=this.edges[o].sourceNodeId===t,f=this.edges[o].targetNodeId===t;u&&i.moveStartPoint(e,n),f&&i.moveEndPoint(e,n),(u||f)&&this.handleEdgeTextMove(i,s,l)}},r.prototype.handleEdgeTextMove=function(t,e,n){var o;if(t.customTextPosition){t.resetTextPosition();return}if(t.modelType===Y.POLYLINE_EDGE&&(!((o=t.text)===null||o===void 0)&&o.value)){var i=t.text,a=gl(i,t.points);t.moveText(a.x-i.x,a.y-i.y)}var s=t.textPosition,l=s.x,u=s.y;t.moveText(l-e,u-n)},r.prototype.deleteEdgeBySourceAndTarget=function(t,e){for(var n=0;n<this.edges.length;n++)if(this.edges[n].sourceNodeId===t&&this.edges[n].targetNodeId===e){var o=this.edges[n].getData();this.edges.splice(n,1),n--,this.eventCenter.emit(C.EDGE_DELETE,{data:o})}},r.prototype.deleteEdgeById=function(t){var e=this.edgesMap[t];if(e){var n=this.edgesMap[t].index,o=this.edgesMap[t].model.getData();this.edges.splice(n,1),this.eventCenter.emit(C.EDGE_DELETE,{data:o})}},r.prototype.deleteEdgeBySource=function(t){for(var e=0;e<this.edges.length;e++)if(this.edges[e].sourceNodeId===t){var n=this.edges[e].getData();this.edges.splice(e,1),e--,this.eventCenter.emit(C.EDGE_DELETE,{data:n})}},r.prototype.deleteEdgeByTarget=function(t){for(var e=0;e<this.edges.length;e++)if(this.edges[e].targetNodeId===t){var n=this.edges[e].getData();this.edges.splice(e,1),e--,this.eventCenter.emit(C.EDGE_DELETE,{data:n})}},r.prototype.setElementStateById=function(t,e,n){this.nodes.forEach(function(o){o.id===t?o.setElementState(e,n):o.setElementState(V.DEFAULT)}),this.edges.forEach(function(o){o.id===t?o.setElementState(e,n):o.setElementState(V.DEFAULT)})},r.prototype.updateText=function(t,e){var n=Ne(Mt(Mt([],dt(this.nodes),!1),dt(this.edges),!1),function(o){return o.id===t});n==null||n.updateText(e)},r.prototype.selectNodeById=function(t,e){var n;e===void 0&&(e=!1),e||this.clearSelectElements();var o=(n=this.nodesMap[t])===null||n===void 0?void 0:n.model;o==null||o.setSelected(!0)},r.prototype.selectEdgeById=function(t,e){var n;e===void 0&&(e=!1),e||this.clearSelectElements();var o=(n=this.edgesMap[t])===null||n===void 0?void 0:n.model;o==null||o.setSelected(!0)},r.prototype.selectElementById=function(t,e){e===void 0&&(e=!1),e||this.clearSelectElements();var n=this.getElement(t);n==null||n.setSelected(!0)},r.prototype.clearSelectElements=function(){var t;this.selectElements.forEach(function(e){e==null||e.setSelected(!1)}),this.selectElements.clear(),this.overlapMode===Bt.DEFAULT&&((t=this.topElement)===null||t===void 0||t.setZIndex())},r.prototype.moveNodes=function(t,e,n,o){var i,a,s,l=this;o===void 0&&(o=!1);for(var u=t.reduce(function(S,M){var w,A=(w=l.nodesMap[M])===null||w===void 0?void 0:w.model;return A&&(S[M]=A.getMoveDistance(e,n,o)),S},{}),f=0;f<this.edges.length;f++){var d=this.edges[f],c=d.textPosition,p=c.x,v=c.y,h=u[d.sourceNodeId],g=u[d.targetNodeId],y=void 0,_=void 0;h&&g&&d.modelType===Y.POLYLINE_EDGE?(i=dt(h,2),y=i[0],_=i[1],d.updatePointsList(y,_)):(h&&(a=dt(h,2),y=a[0],_=a[1],d.moveStartPoint(y,_)),g&&(s=dt(g,2),y=s[0],_=s[1],d.moveEndPoint(y,_))),(h||g)&&this.handleEdgeTextMove(d,p,v)}},r.prototype.addNodeMoveRules=function(t){this.nodeMoveRules.includes(t)||this.nodeMoveRules.push(t)},r.prototype.addNodeResizeRules=function(t){this.nodeResizeRules.includes(t)||this.nodeResizeRules.push(t)},r.prototype.setDefaultEdgeType=function(t){this.edgeType=t},r.prototype.changeNodeType=function(t,e){var n=this.getNodeModelById(t);if(!n){console.warn("找不到id为".concat(t,"的节点"));return}var o=n.getData();o.type=e;var i=this.getModel(e);if(!i)throw new Error("找不到".concat(e,"对应的节点，请确认是否已注册此类型节点。"));var a=new i(o,this);this.nodes.splice(this.nodesMap[t].index,1,a);var s=this.getNodeEdges(t);s.forEach(function(l){if(l.sourceNodeId===t){var u=Ta(a,l.startPoint,a.width,a.height);l.updateStartPoint(u)}if(l.targetNodeId===t){var u=Ta(a,l.endPoint,a.width,a.height);l.updateEndPoint(u)}})},r.prototype.changeEdgeType=function(t,e){var n=this.getEdgeModelById(t);if(!n){console.warn("找不到id为".concat(t,"的边"));return}if(n.type!==e){var o=n.getData();o.type=e;var i=this.getModel(e);if(!i)throw new Error("找不到".concat(e,"对应的节点，请确认是否已注册此类型节点。"));delete o.pointsList;var a=new i(o,this);this.edges.splice(this.edgesMap[t].index,1,a)}},r.prototype.getNodeIncomingEdge=function(t){var e=[];return this.edges.forEach(function(n){n.targetNodeId===t&&e.push(n)}),e},r.prototype.getNodeOutgoingEdge=function(t){var e=[];return this.edges.forEach(function(n){n.sourceNodeId===t&&e.push(n)}),e},r.prototype.getAnchorIncomingEdge=function(t){var e=[];return this.edges.forEach(function(n){n.targetAnchorId===t&&e.push(n)}),e},r.prototype.getAnchorOutgoingEdge=function(t){var e=[];return this.edges.forEach(function(n){n.sourceAnchorId===t&&e.push(n)}),e},r.prototype.getNodeIncomingNode=function(t){var e=this,n=[];return this.edges.forEach(function(o){var i;o.targetNodeId===t&&n.push((i=e.nodesMap[o.sourceNodeId])===null||i===void 0?void 0:i.model)}),n},r.prototype.getNodeOutgoingNode=function(t){var e=this,n=[];return this.edges.forEach(function(o){o.sourceNodeId===t&&n.push(e.nodesMap[o.targetNodeId].model)}),n},r.prototype.setTheme=function(t){this.theme=Xc(pe(pe({},this.theme),t))},r.prototype.updateGridOptions=function(t){ni(this.grid,t)},r.prototype.updateGridSize=function(t){this.gridSize=t},r.prototype.updateBackgroundOptions=function(t){mo(t)||mo(this.background)?this.background=t:this.background=pe(pe({},this.background),t)},r.prototype.resize=function(t,e){this.width=t??this.rootEl.getBoundingClientRect().width,this.isContainerWidth=Xt(t),this.height=e??this.rootEl.getBoundingClientRect().height,this.isContainerHeight=Xt(e),(!this.width||!this.height)&&console.warn("渲染画布的时候无法获取画布宽高，请确认在container已挂载到DOM。@see https://github.com/didi/LogicFlow/issues/675")},r.prototype.clearData=function(){this.nodes=[],this.edges=[],this.edgeModelMap.clear(),this.nodeModelMap.clear(),this.elementsModelMap.clear()},r.prototype.getVirtualRectSize=function(){var t=this.nodes,e=[],n=[];t.forEach(function(c){var p=c.x,v=c.y,h=c.width,g=c.height,y=c.getNodeStyle().strokeWidth,_=y===void 0?0:y,S=p+h/2+_,M=p-h/2-_,w=v+g/2+_,A=v-g/2-_;e=e.concat([S,M].filter(function(m){return!Number.isNaN(m)})),n=n.concat([w,A].filter(function(m){return!Number.isNaN(m)}))});var o=Math.min.apply(Math,Mt([],dt(e),!1)),i=Math.max.apply(Math,Mt([],dt(e),!1)),a=Math.min.apply(Math,Mt([],dt(n),!1)),s=Math.max.apply(Math,Mt([],dt(n),!1)),l=i-o||0,u=s-a||0,f=o+l/2,d=a+u/2;return{width:l,height:u,x:f,y:d}},r.prototype.translateCenter=function(){var t=this,e=t.nodes,n=t.width,o=t.height,i=t.rootEl,a=t.transformModel;if(e.length){var s=n||i.clientWidth,l=o||i.clientHeight,u=this.getVirtualRectSize(),f=u.x,d=u.y;a.focusOn(f,d,s,l)}},r.prototype.fitView=function(t,e){t===void 0&&(t=20),e===void 0&&(e=20);var n=this,o=n.nodes,i=n.width,a=n.height,s=n.rootEl,l=n.transformModel;if(o.length){var u=i||s.clientWidth,f=a||s.clientHeight,d=this.getVirtualRectSize(),c=d.width,p=d.height,v=d.x,h=d.y,g=(c+e)/u,y=(p+t)/f,_=1/Math.max(g,y),S=[u/2,f/2];l.zoom(_,S),l.focusOn(v,h,u,f)}},r.prototype.openEdgeAnimation=function(t){var e=this.getEdgeModelById(t);e==null||e.openEdgeAnimation()},r.prototype.closeEdgeAnimation=function(t){var e=this.getEdgeModelById(t);e==null||e.closeEdgeAnimation()},r.prototype.getPartial=function(){return this.partial},r.prototype.setPartial=function(t){this.partial=t},r.prototype.destroy=function(){try{this.waitCleanEffects.forEach(function(t){t()})}catch(t){console.warn("error on destroy GraphModel",t)}this.waitCleanEffects.length=0,this.eventCenter.destroy()},D([E],r.prototype,"width",void 0),D([E],r.prototype,"height",void 0),D([E],r.prototype,"theme",void 0),D([E],r.prototype,"grid",void 0),D([E],r.prototype,"edgeType",void 0),D([E],r.prototype,"nodes",void 0),D([E],r.prototype,"edges",void 0),D([E],r.prototype,"fakeNode",void 0),D([E],r.prototype,"overlapMode",void 0),D([E],r.prototype,"background",void 0),D([E],r.prototype,"gridSize",void 0),D([E],r.prototype,"transformModel",void 0),D([E],r.prototype,"editConfigModel",void 0),D([E],r.prototype,"partial",void 0),D([tt],r.prototype,"nodesMap",null),D([tt],r.prototype,"edgesMap",null),D([tt],r.prototype,"modelsMap",null),D([tt],r.prototype,"sortElements",null),D([tt],r.prototype,"textEditElement",null),D([tt],r.prototype,"selectElements",null),D([tt],r.prototype,"selectNodes",null),D([x],r.prototype,"setTextMode",null),D([x],r.prototype,"setFakeNode",null),D([x],r.prototype,"removeFakeNode",null),D([x],r.prototype,"setModel",null),D([x],r.prototype,"toFront",null),D([x],r.prototype,"setElementZIndex",null),D([x],r.prototype,"deleteNode",null),D([x],r.prototype,"addNode",null),D([x],r.prototype,"cloneNode",null),D([x],r.prototype,"moveNode",null),D([x],r.prototype,"moveNode2Coordinate",null),D([x],r.prototype,"editText",null),D([x],r.prototype,"addEdge",null),D([x],r.prototype,"moveEdge",null),D([x],r.prototype,"deleteEdgeBySourceAndTarget",null),D([x],r.prototype,"deleteEdgeById",null),D([x],r.prototype,"deleteEdgeBySource",null),D([x],r.prototype,"deleteEdgeByTarget",null),D([x],r.prototype,"setElementStateById",null),D([x],r.prototype,"updateText",null),D([x],r.prototype,"selectNodeById",null),D([x],r.prototype,"selectEdgeById",null),D([x],r.prototype,"selectElementById",null),D([x],r.prototype,"clearSelectElements",null),D([x],r.prototype,"moveNodes",null),D([x],r.prototype,"setDefaultEdgeType",null),D([x],r.prototype,"changeNodeType",null),D([x],r.prototype,"changeEdgeType",null),D([x],r.prototype,"getNodeIncomingEdge",null),D([x],r.prototype,"getNodeOutgoingEdge",null),D([x],r.prototype,"getAnchorIncomingEdge",null),D([x],r.prototype,"getAnchorOutgoingEdge",null),D([x],r.prototype,"getNodeIncomingNode",null),D([x],r.prototype,"getNodeOutgoingNode",null),D([x],r.prototype,"setTheme",null),D([x],r.prototype,"resize",null),D([x],r.prototype,"clearData",null),D([x],r.prototype,"translateCenter",null),D([x],r.prototype,"fitView",null),D([x],r.prototype,"openEdgeAnimation",null),D([x],r.prototype,"closeEdgeAnimation",null),D([x],r.prototype,"setPartial",null),r}(),we=function(){return we=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},we.apply(this,arguments)},dr=function(r,t,e,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,t,e,n);else for(var s=r.length-1;s>=0;s--)(a=r[s])&&(i=(o<3?a(i):o>3?a(t,e,i):a(t,e))||i);return o>3&&i&&Object.defineProperty(t,e,i),i},Lp=function(){function r(t){this.isShowHorizontal=!1,this.isShowVertical=!1,this.position={x:0,y:0},this.graphModel=t}return r.prototype.getStyle=function(){return we({},this.graphModel.theme.snapline)},r.prototype.getCenterSnapLine=function(t,e){for(var n=t.x,o=t.y,i=!1,a=!1,s=0;s<e.length;s++){var l=e[s];if(l.id!==t.id&&(n===l.x&&(i=!0),o===l.y&&(a=!0),i&&a))break}return{isShowVertical:i,isShowHorizontal:a,position:{x:n,y:o}}},r.prototype.getHorizontalSnapline=function(t,e){var n=!1,o=0,i=t.id,a;if(i){var s=this.graphModel.fakeNode;if(s&&s.id===i)a=Ot(s);else{var l=this.graphModel.getNodeModelById(i);l&&(a=Ot(l))}}for(var u=0;u<e.length;u++){var f=e[u];if(f.id!==t.id){var d=Ot(f);if(d.minY===(a==null?void 0:a.minY)||d.maxY===(a==null?void 0:a.minY)){n=!0,o=a.minY;break}if(d.minY===(a==null?void 0:a.maxY)||d.maxY===(a==null?void 0:a.maxY)){n=!0,o=a.maxY;break}}}return{isShowHorizontal:n,isShowVertical:this.isShowVertical,position:we(we({},this.position),{y:o})}},r.prototype.getVerticalSnapline=function(t,e){var n=!1,o=0,i=t.id,a;if(i){var s=this.graphModel.fakeNode;if(s&&s.id===i)a=Ot(s);else{var l=this.graphModel.getNodeModelById(i);l&&(a=Ot(l))}}for(var u=0;u<e.length;u++){var f=e[u];if(f.id!==t.id){var d=Ot(f);if(d.minX===(a==null?void 0:a.minX)||d.maxX===(a==null?void 0:a.minX)){n=!0,o=a.minX;break}if(d.minX===(a==null?void 0:a.maxX)||d.maxX===(a==null?void 0:a.maxX)){n=!0,o=a.maxX;break}}}return{isShowHorizontal:this.isShowHorizontal,isShowVertical:n,position:we(we({},this.position),{x:o})}},r.prototype.getSnapLinePosition=function(t,e){var n=this.getCenterSnapLine(t,e),o=n.isShowHorizontal,i=n.isShowVertical;if(!o){var a=this.getHorizontalSnapline(t,e);a.isShowHorizontal&&(n.isShowHorizontal=a.isShowHorizontal,n.position.y=a.position.y)}if(!i){var s=this.getVerticalSnapline(t,e);s.isShowVertical&&(n.isShowVertical=s.isShowVertical,n.position.x=s.position.x)}return n},r.prototype.setSnaplineInfo=function(t){var e=t.isShowHorizontal,n=t.isShowVertical,o=t.position;this.position=o,this.isShowHorizontal=e,this.isShowVertical=n},r.prototype.clearSnapline=function(){this.position={x:0,y:0},this.isShowHorizontal=!1,this.isShowVertical=!1},r.prototype.setNodeSnapLine=function(t){var e=this.graphModel.nodes,n=this.getSnapLinePosition(t,e);this.setSnaplineInfo(n)},dr([E],r.prototype,"isShowHorizontal",void 0),dr([E],r.prototype,"isShowVertical",void 0),dr([E],r.prototype,"position",void 0),dr([x],r.prototype,"clearSnapline",null),dr([x],r.prototype,"setNodeSnapLine",null),r}(),Rt=function(r,t,e,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,t,e,n);else for(var s=r.length-1;s>=0;s--)(a=r[s])&&(i=(o<3?a(i):o>3?a(t,e,i):a(t,e))||i);return o>3&&i&&Object.defineProperty(t,e,i),i},Xe=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i},Ip={false:[-1/0,-1/0,1/0,1/0],true:[-1/0,-1/0,1/0,1/0],vertical:[-1/0,0,1/0,0],horizontal:[0,-1/0,0,1/0]},Bp=function(){function r(t,e){this.MINI_SCALE_SIZE=.2,this.MAX_SCALE_SIZE=16,this.SCALE_X=1,this.SKEW_Y=0,this.SKEW_X=0,this.SCALE_Y=1,this.TRANSLATE_X=0,this.TRANSLATE_Y=0,this.ZOOM_SIZE=.04,this.translateLimitMinX=-1/0,this.translateLimitMinY=-1/0,this.translateLimitMaxX=1/0,this.translateLimitMaxY=1/0,this.eventCenter=t;var n=e.stopMoveGraph,o=n===void 0?!1:n;this.updateTranslateLimits(o)}return r.prototype.setZoomMiniSize=function(t){this.MINI_SCALE_SIZE=t},r.prototype.setZoomMaxSize=function(t){this.MAX_SCALE_SIZE=t},r.prototype.HtmlPointToCanvasPoint=function(t){var e=Xe(t,2),n=e[0],o=e[1];return[(n-this.TRANSLATE_X)/this.SCALE_X,(o-this.TRANSLATE_Y)/this.SCALE_Y]},r.prototype.CanvasPointToHtmlPoint=function(t){var e=Xe(t,2),n=e[0],o=e[1];return[n*this.SCALE_X+this.TRANSLATE_X,o*this.SCALE_Y+this.TRANSLATE_Y]},r.prototype.moveCanvasPointByHtml=function(t,e,n){var o=Xe(t,2),i=o[0],a=o[1];return[i+e/this.SCALE_X,a+n/this.SCALE_Y]},r.prototype.fixDeltaXY=function(t,e){return[t/this.SCALE_X,e/this.SCALE_Y]},r.prototype.getTransformStyle=function(){var t=[this.SCALE_X,this.SKEW_Y,this.SKEW_X,this.SCALE_Y,this.TRANSLATE_X,this.TRANSLATE_Y].join(",");return{transform:"matrix(".concat(t,")")}},r.prototype.zoom=function(t,e){t===void 0&&(t=!1);var n=this.SCALE_X,o=this.SCALE_Y;return typeof t=="number"?(n=t,o=t):t?(n+=this.ZOOM_SIZE,o+=this.ZOOM_SIZE):(n-=this.ZOOM_SIZE,o-=this.ZOOM_SIZE),n<this.MINI_SCALE_SIZE||n>this.MAX_SCALE_SIZE?"".concat(this.SCALE_X*100,"%"):(e&&(this.TRANSLATE_X-=(n-this.SCALE_X)*e[0],this.TRANSLATE_Y-=(o-this.SCALE_Y)*e[1]),this.SCALE_X=n,this.SCALE_Y=o,this.emitGraphTransform("zoom"),"".concat(this.SCALE_X*100,"%"))},r.prototype.emitGraphTransform=function(t){this.eventCenter.emit(C.GRAPH_TRANSFORM,{type:t,transform:{SCALE_X:this.SCALE_X,SKEW_Y:this.SKEW_Y,SKEW_X:this.SKEW_X,SCALE_Y:this.SCALE_Y,TRANSLATE_X:this.TRANSLATE_X,TRANSLATE_Y:this.TRANSLATE_Y}})},r.prototype.resetZoom=function(){this.SCALE_X=1,this.SCALE_Y=1,this.emitGraphTransform("resetZoom")},r.prototype.translate=function(t,e){this.TRANSLATE_X+t<=this.translateLimitMaxX&&this.TRANSLATE_X+t>=this.translateLimitMinX&&(this.TRANSLATE_X+=t),this.TRANSLATE_Y+e<=this.translateLimitMaxY&&this.TRANSLATE_Y+e>=this.translateLimitMinY&&(this.TRANSLATE_Y+=e),this.emitGraphTransform("translate")},r.prototype.focusOn=function(t,e,n,o){var i=Xe(this.CanvasPointToHtmlPoint([t,e]),2),a=i[0],s=i[1],l=Xe([n/2-a,o/2-s],2),u=l[0],f=l[1];this.TRANSLATE_X+=u,this.TRANSLATE_Y+=f,this.emitGraphTransform("focusOn")},r.prototype.updateTranslateLimits=function(t){var e;e=Xe(Array.isArray(t)&&t.length===4?t:Ip[t.toString()],4),this.translateLimitMinX=e[0],this.translateLimitMinY=e[1],this.translateLimitMaxX=e[2],this.translateLimitMaxY=e[3]},Rt([E],r.prototype,"SCALE_X",void 0),Rt([E],r.prototype,"SKEW_Y",void 0),Rt([E],r.prototype,"SKEW_X",void 0),Rt([E],r.prototype,"SCALE_Y",void 0),Rt([E],r.prototype,"TRANSLATE_X",void 0),Rt([E],r.prototype,"TRANSLATE_Y",void 0),Rt([E],r.prototype,"ZOOM_SIZE",void 0),Rt([x],r.prototype,"zoom",null),Rt([x],r.prototype,"resetZoom",null),Rt([x],r.prototype,"translate",null),Rt([x],r.prototype,"focusOn",null),r}(),Xp=function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),kp=function(r,t,e,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,t,e,n);else for(var s=r.length-1;s>=0;s--)(a=r[s])&&(i=(o<3?a(i):o>3?a(t,e,i):a(t,e))||i);return o>3&&i&&Object.defineProperty(t,e,i),i},Hp=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i},Yp=function(r,t,e){if(e||arguments.length===2)for(var n=0,o=t.length,i;n<o;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return r.concat(i||Array.prototype.slice.call(t))},Gp=function(r){Xp(t,r);function t(){var e=r.apply(this,Yp([],Hp(arguments),!1))||this;return e.canvasOverlayRef=Un(),e.getCanvasOverlay=function(){return e.canvasOverlayRef.current},e.handleResize=function(){var n=e.props,o=n.graphModel,i=n.options,a=o.width,s=o.height,l=o.isContainerWidth,u=o.isContainerHeight,f=a,d=s,c=!1;l&&(f=void 0,c=!0),u&&(d=void 0,c=!0),c&&o.resize(f,d),i.width=a,i.height=s},e.throttleResize=Jl(e.handleResize,200),e}return t.prototype.componentDidMount=function(){window.addEventListener("resize",this.throttleResize)},t.prototype.componentDidUpdate=function(){var e=this.props.graphModel.modelToGraphData();this.props.graphModel.eventCenter.emit(C.GRAPH_UPDATED,{data:e})},t.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this.throttleResize)},t.prototype.getComponent=function(e,n,o){o===void 0&&(o="canvas-overlay");var i=this.props.getView,a=i(e.type);return a?b(a,{model:e,graphModel:n,overlay:o},e.id):null},t.prototype.render=function(){var e=this,n=this.props,o=n.graphModel,i=n.tool,a=n.options,s=n.dnd,l=n.snaplineModel,u={};a.width&&(u.width="".concat(o.width,"px")),a.height&&(u.height="".concat(o.height,"px"));var f=o.fakeNode,d=o.editConfigModel,c=o.background,p=d.adjustEdge;return b("div",{className:"lf-graph","flow-id":o.flowId,style:u,children:[b(dp,{ref:this.canvasOverlayRef,graphModel:o,dnd:s,children:[b("g",{className:"lf-base",children:le(o.sortElements,function(v){return e.getComponent(v,o)})}),f?this.getComponent(f,o):""]}),b(Ep,{graphModel:o,children:[b(Sp,{graphModel:o}),p?b(pp,{graphModel:o}):"",a.snapline!==!1?b(Ap,{snaplineModel:l}):""]}),b(Cp,{graphModel:o,tool:i,getCanvasOverlay:this.getCanvasOverlay}),c&&b(yp,{background:c}),b(Ln,{graphModel:o})]})},t=kp([St],t),t}(z),zp=function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),$t=function(){return $t=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},$t.apply(this,arguments)},Fp=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i},Up=function(r){zp(t,r);function t(){var e=r.call(this)||this;return e.onDragStart=function(n){var o=n.event,i=e.props,a=i.anchorData,s=i.nodeModel,l=i.graphModel;l.selectNodeById(s.id),s.autoToFront&&l.toFront(s.id),l.eventCenter.emit(C.ANCHOR_DRAGSTART,{data:a,e:o,nodeModel:s}),e.setState({startX:a.x,startY:a.y,endX:a.x,endY:a.y})},e.onDragging=function(n){var o=n.event,i=e.props,a=i.graphModel,s=i.nodeModel,l=i.anchorData,u=a.transformModel,f=a.eventCenter,d=a.width,c=a.height,p=a.editConfigModel,v=p.autoExpand,h=p.stopMoveGraph;if(o){var g=o.clientX,y=o.clientY,_=a.getPointByClient({x:g,y}),S=_.domOverlayPosition,M=S.x,w=S.y,A=_.canvasOverlayPosition,m=A.x,O=A.y;e.t&&jn(e.t);var P=[],T=10;M<10?P=[T,0]:M+10>d?P=[-10,0]:w<10?P=[0,T]:w+10>c&&(P=[0,-10]),e.setState({endX:m,endY:O,dragging:!0}),e.moveAnchorEnd(m,O),P.length>0&&!h&&v&&(e.t=El(function(){var B=Fp(P,2),I=B[0],et=B[1];u.translate(I,et);var K=e.state,it=K.endX,yt=K.endY;e.setState({endX:it-I,endY:yt-et}),e.moveAnchorEnd(it-I,yt-et)})),f.emit(C.ANCHOR_DRAG,{data:l,e:o,nodeModel:s})}},e.onDragEnd=function(n){var o=n.event;e.t&&jn(e.t);var i=e.checkEnd(o);e.setState({startX:0,startY:0,endX:0,endY:0,dragging:!1}),e.sourceRuleResults.clear(),e.targetRuleResults.clear();var a=e.props,s=a.graphModel,l=a.nodeModel,u=a.anchorData;s.eventCenter.emit(C.ANCHOR_DRAGEND,{data:u,e:o,nodeModel:l,edgeModel:i??void 0})},e.checkEnd=function(n){var o,i=e.props,a=i.graphModel,s=i.nodeModel,l=i.anchorData,u=l.x,f=l.y,d=l.id,c=e.state,p=c.endX,v=c.endY,h=c.dragging,g=Cn({x:p,y:v},a);if(e.preTargetNode&&e.preTargetNode.state!==V.DEFAULT&&e.preTargetNode.setElementState(V.DEFAULT),!!h&&g&&g.node){var y=g.node,_=g.anchor.id,S="".concat(s.id,"_").concat(y.id,"_").concat(_,"_").concat(d),M=e.sourceRuleResults.get(S)||{},w=M.isAllPass,A=M.msg,m=e.targetRuleResults.get(S)||{},O=m.isAllPass,P=m.msg;if(w&&O){y.setElementState(V.DEFAULT);var T=a.getNodeModelById(g.node.id),B=(o=a.edgeGenerator)===null||o===void 0?void 0:o.call(a,s.getData(),T==null?void 0:T.getData()),I=a.addEdge($t($t({},B),{sourceNodeId:s.id,sourceAnchorId:d,startPoint:{x:u,y:f},targetNodeId:g.node.id,targetAnchorId:g.anchor.id,endPoint:{x:g.anchor.x,y:g.anchor.y}})),et=e.props.anchorData;return a.eventCenter.emit(C.ANCHOR_DROP,{data:et,e:n,nodeModel:s,edgeModel:I}),I}var K=y.getData();return a.eventCenter.emit(C.CONNECTION_NOT_ALLOWED,{data:K,msg:P||A||"不允许添加连线"}),null}},e.sourceRuleResults=new Map,e.targetRuleResults=new Map,e.state={startX:0,startY:0,endX:0,endY:0,dragging:!1},e.dragHandler=new re({onDragStart:e.onDragStart,onDragging:e.onDragging,onDragEnd:e.onDragEnd}),e}return t.prototype.getAnchorShape=function(){var e=this.props,n=e.anchorData,o=e.style,i=e.node,a=i.getAnchorShape(n);if(a)return a;var s=n.x,l=n.y,u=$t($t({},o),o==null?void 0:o.hover);return b("g",{children:[b(nr,$t({className:"lf-node-anchor-hover"},u,{x:s,y:l})),b(nr,$t({className:"lf-node-anchor"},o,{x:s,y:l}))]})},Object.defineProperty(t.prototype,"customTrajectory",{get:function(){var e=this.props.graphModel.customTrajectory;return e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"relateEdges",{get:function(){var e=this.props,n=e.graphModel,o=n.getAnchorIncomingEdge,i=n.getAnchorOutgoingEdge,a=e.anchorData.id;return{incomingEdgeList:o(a),outgoingEdgeList:i(a)}},enumerable:!1,configurable:!0}),t.prototype.moveAnchorEnd=function(e,n){var o,i,a=this.props,s=a.graphModel,l=a.nodeModel,u=a.anchorData,f=Cn({x:e,y:n},s);if(f){var d=f.node,c=f.anchor.id;if(this.preTargetNode&&this.preTargetNode!==f.node&&this.preTargetNode.setElementState(V.DEFAULT),u.id===c)return;this.preTargetNode=d;var p="".concat(l.id,"_").concat(d.id,"_").concat(c,"_").concat(u.id);if(!this.targetRuleResults.has(p)){var v=f.anchor,h=l.isAllowConnectedAsSource(d,u,v),g=d.isAllowConnectedAsTarget(l,u,v);this.sourceRuleResults.set(p,Rn(h)),this.targetRuleResults.set(p,Rn(g))}var y=((o=this.sourceRuleResults.get(p))!==null&&o!==void 0?o:{}).isAllPass,_=((i=this.targetRuleResults.get(p))!==null&&i!==void 0?i:{}).isAllPass;y&&_?d.setElementState(V.ALLOW_CONNECT):d.setElementState(V.NOT_ALLOW_CONNECT)}else this.preTargetNode&&this.preTargetNode.state!==V.DEFAULT&&this.preTargetNode.setElementState(V.DEFAULT)},t.prototype.isShowLine=function(){var e=this.state,n=e.startX,o=e.startY,i=e.endX,a=e.endY,s=kt(n,o,i,a);return s>10},t.prototype.render=function(){var e=this,n=this.state,o=n.startX,i=n.startY,a=n.endX,s=n.endY,l=this.props,u=l.anchorData,f=l.edgeStyle,d=l.nodeModel,c=l.graphModel,p=u.edgeAddable;return b("g",{className:"lf-anchor",children:[b("g",{onClick:function(v){v.stopPropagation(),c.eventCenter.emit(C.ANCHOR_CLICK,{data:u,e:v,nodeModel:d})},onMouseDown:function(v){c.eventCenter.emit(C.ANCHOR_MOUSEDOWN,{data:u,e:v,nodeModel:d}),p!==!1&&e.dragHandler.handleMouseDown(v)},children:this.getAnchorShape()}),this.isShowLine()&&(this.customTrajectory?this.customTrajectory($t({sourcePoint:{x:o,y:i},targetPoint:{x:a,y:s}},f)):b(rr,$t({x1:o,y1:i,x2:a,y2:s},f,{"pointer-events":"none"})))]})},t}(z),$p=function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Fo=function(){return Fo=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},Fo.apply(this,arguments)},Vp=function(r){$p(t,r);function t(e){var n=r.call(this,e)||this;return n.style={},n.onDragging=function(o){var i,a=o.event,s=n.props,l=s.graphModel,u=s.nodeModel,f=s.eventCenter,d=l.selectNodes,c=u.x,p=u.y,v=a.clientX,h=a.clientY,g=l.getPointByClient({x:v,y:h}).canvasOverlayPosition,y=g.x,_=g.y,S=new ht(y-c,_-p),M=((i=n.normal)===null||i===void 0?void 0:i.angle(S))-n.defaultAngle,w=new Dn(-c,-p).rotate(M).translate(c,p).toString();u.transform=w,u.rotate=M;var A=le(d,function(O){return O.id});A.indexOf(u.id)===-1&&(A=[u.id]);var m=Tu(A,function(O,P){var T=l.getNodeModelById(P);return O[P]=T==null?void 0:T.getMoveDistance(0,0,!1),O},{});A.forEach(function(O){var P=l.getNodeEdges(O);P.forEach(function(T){if(m[T.sourceNodeId]){var B=l.getNodeModelById(T.sourceNodeId),I=B.anchors.find(function(et){return et.id===T.sourceAnchorId});T.updateStartPoint(I)}if(m[T.targetNodeId]){var B=l.getNodeModelById(T.targetNodeId),I=B.anchors.find(function(it){return it.id===T.targetAnchorId});T.updateEndPoint(I)}})}),f.emit(C.NODE_ROTATE,{e:a,model:u,data:u.getData()})},n.style=e.style,n.stepperDrag=new re({onDragging:n.onDragging}),n}return t.prototype.render=function(){var e=this,n=this.props.nodeModel,o=n.x,i=n.y,a=n.width,s=n.height,l=o+a/2+20,u=i-s/2-20;return this.normal=new ht(1,0),this.defaultAngle=this.normal.angle(new ht(l-o,u-i)),n.defaultAngle=this.defaultAngle,b("g",{className:"lf-rotate-control",children:b("g",{onMouseDown:function(f){e.stepperDrag.handleMouseDown(f)},children:b(nr,Fo({},this.style,{cx:l,cy:u}))})})},t}(z),fo={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/var Wa;function Wp(){return Wa||(Wa=1,function(r){(function(){var t={}.hasOwnProperty;function e(){for(var i="",a=0;a<arguments.length;a++){var s=arguments[a];s&&(i=o(i,n(s)))}return i}function n(i){if(typeof i=="string"||typeof i=="number")return i;if(typeof i!="object")return"";if(Array.isArray(i))return e.apply(null,i);if(i.toString!==Object.prototype.toString&&!i.toString.toString().includes("[native code]"))return i.toString();var a="";for(var s in i)t.call(i,s)&&i[s]&&(a=o(a,s));return a}function o(i,a){return a?i?i+" "+a:i+a:i}r.exports?(e.default=e,r.exports=e):window.classNames=e})()}(fo)),fo.exports}var Kp=Wp();const Zp=vs(Kp);var qp=function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Uo=function(){return Uo=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},Uo.apply(this,arguments)},Jp=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i},Al=function(r){qp(t,r);function t(e){var n=r.call(this)||this;n.mouseDownHandler=function(i){var a=n.props,s=a.draggable,l=a.model,u=a.graphModel,f=u.editConfigModel.nodeTextDraggable;(s??f)&&(i.stopPropagation(),n.stepperDrag.model=l,n.stepperDrag.handleMouseDown(i))},n.onDragging=function(i){var a=i.deltaX,s=i.deltaY,l=n.props,u=l.model,f=l.graphModel.transformModel;if(a||s){var d=Jp(f.fixDeltaXY(a,s),2),c=d[0],p=d[1];u.moveText(c,p)}},n.dbClickHandler=function(){var i=n.props,a=i.editable,s=i.graphModel.eventCenter,l=i.model;a&&l.setElementState(V.TEXT_EDIT),s.emit(C.TEXT_DBCLICK,{data:l.text,model:l})};var o=e.draggable;return n.stepperDrag=new re({onDragging:n.onDragging,step:1,eventType:"TEXT",isStopPropagation:o}),n}return t.prototype.getShape=function(){var e=this.props,n=e.model,o=e.graphModel,i=o.editConfigModel,a=n.text,s=a.value,l=a.x,u=a.y,f=a.editable,d=a.draggable,c={x:l,y:u,className:"",value:s},p=n.getTextStyle(),v=i.nodeTextDraggable||d;return b(bl,Uo({},c,p,{className:Zp({"lf-element-text":f,"lf-text-draggable":!f&&v,"lf-text-disabled":!f&&!v}),model:n}))},t.prototype.render=function(){var e=this.props.model.text;if(e)return b("g",{onMouseDown:this.mouseDownHandler,onDblClick:this.dbClickHandler,children:this.getShape()})},t}(z),Qp=function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),jt=function(){return jt=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},jt.apply(this,arguments)},sn=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i},th=function(r){Qp(t,r);function t(e){var n=r.call(this,e)||this;return n.setHoverOn=function(){n.setState({isHovered:!0})},n.setHoverOff=function(){n.setState({isHovered:!1})},n.state={isHovered:!1},n}return t.prototype.getBackground=function(){var e=this.state.isHovered,n=this.props.model,o=n.text,i=n.getTextStyle(),a=i.background||{};if(e&&i.hover&&i.hover.background&&(a=jt(jt({},a),i.hover.background)),o!=null&&o.value&&(a==null?void 0:a.fill)!=="transparent"){var s=i.fontSize,l=i.textWidth,u=i.lineHeight,f=i.overflowMode,d=a.wrapPadding,c=o==null?void 0:o.value.split(/[\r\n]/g),p=c.length,v=o.x,h=o.y,g={};if(f==="autoWrap"&&l){var y=xl({rows:c,style:{fontSize:"".concat(s,"px"),width:"".concat(l,"px"),lineHeight:u,padding:d},rowsLength:p,className:"lf-get-text-height"});g=jt(jt({},a),{x:v,y:h,width:l,height:y})}else{var _=Ff({rows:c,rowsLength:p,fontSize:s}),S=_.width,M=_.height;if(f==="ellipsis"&&(S=l,M=s+2),typeof a.wrapPadding=="string"){var w=a.wrapPadding.split(",").filter(function(gt){return gt.trim()}).map(function(gt){return parseFloat(gt.trim())});if(w.length>0&&w.length<=4){if(w.length===1){var A=sn(w,1),m=A[0];w=[m,m,m,m]}else if(w.length===2){var O=sn(w,2),P=O[0],T=O[1];w=[P,T,P,T]}else if(w.length===3){var B=sn(w,3),I=B[0],T=B[1],et=B[2];w=[I,T,et,T]}var K=sn(w,4),it=K[0],yt=K[1],Nt=K[2],ne=K[3];S+=yt+ne,M+=it+Nt,v=v+(yt-ne)/2,h=h+(Nt-it)/2}}g=jt(jt({},a),{x:v-1,y:h-1,width:S,height:M})}return b(qt,jt({},g))}return null},t.prototype.getShape=function(){var e=this.props.model,n=e.text,o=n.x,i=n.y,a=n.value;if(!a)return null;var s=e.getTextStyle(),l=jt({x:o,y:i,value:a,model:e,className:"lf-element-text"},s);return b("g",{className:"lf-line-text",onMouseEnter:this.setHoverOn,onMouseLeave:this.setHoverOff,children:[this.getBackground(),b(bl,jt({},l))]})},t}(Al),eh=function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),In=function(){return In=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},In.apply(this,arguments)},rh=function(r,t){var e={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&t.indexOf(n)<0&&(e[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(r);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(r,n[o])&&(e[n[o]]=r[n[o]]);return e},ln=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i},be=function(r){eh(t,r);function t(e){var n=r.call(this)||this;n.onDragStart=function(l){var u=l.event,f=n.props,d=f.model,c=f.graphModel;if(u){var p=c.getPointByClient({x:u.clientX,y:u.clientY}).canvasOverlayPosition,v=p.x,h=p.y;n.moveOffset={dx:d.x-v,dy:d.y-h}}},n.onDragging=function(l){var u,f,d,c,p=l.event,v=n.props,h=v.model,g=v.graphModel,y=g.editConfigModel,_=y.stopMoveGraph,S=y.autoExpand,M=y.snapGrid,w=g.transformModel,A=g.selectNodes,m=g.width,O=g.height,P=g.gridSize;h.isDragging=!0;var T=p,B=T.clientX,I=T.clientY,et=g.getPointByClient({x:B,y:I}).canvasOverlayPosition,K=et.x,it=et.y,yt=ln(w.CanvasPointToHtmlPoint([K,it]),2),Nt=yt[0],ne=yt[1];if(K=K+((f=(u=n.moveOffset)===null||u===void 0?void 0:u.dx)!==null&&f!==void 0?f:0),it=it+((c=(d=n.moveOffset)===null||d===void 0?void 0:d.dy)!==null&&c!==void 0?c:0),K=er(K,P,M),it=er(it,P,M),!m||!O){g.moveNode2Coordinate(h.id,K,it);return}var gt=Nt<0||ne<0||Nt>m||ne>O;if(!(S&&!_&&gt)){var bt=ln(w.CanvasPointToHtmlPoint([K-h.width/2,it-h.height/2]),2),X=bt[0],F=bt[1],q=ln(w.CanvasPointToHtmlPoint([K+h.width/2,it+h.height/2]),2),G=q[0],nt=q[1],mt=Math.max(P,20),U=[];X<0?U=[mt,0]:G>g.width?U=[-mt,0]:F<0?U=[0,mt]:nt>g.height&&(U=[0,-mt]),n.t&&jn(n.t);var st=A.map(function(Ct){return Ct.id});st.indexOf(h.id)===-1&&(st=[h.id]),U.length>0&&!_&&S?n.t=El(function(){var Ct=ln(U,2),_t=Ct[0],ue=Ct[1];w.translate(_t??0,ue??0);var to=-(_t??0)/w.SCALE_X,Dl=-(ue??0)/w.SCALE_X;g.moveNodes(st,to,Dl)}):g.moveNodes(st,K-h.x,it-h.y)}},n.onDragEnd=function(){n.t&&jn(n.t);var l=n.props.model;l.isDragging=!1},n.onMouseOut=function(l){xf()&&n.setHoverOff(l)},n.handleMouseUp=function(){var l=n.props.model;n.mouseUpDrag=l.isDragging},n.handleClick=function(l){var u=n.mouseUpDrag===!1;if(n.startTime){var f=n.props,d=f.model,c=f.graphModel;if(u){var p=d.getData(),v=c.getPointByClient({x:l.clientX,y:l.clientY}),h={data:p,e:l,position:v,isSelected:!1,isMultiple:!1},g=l.button===2,y=l.detail===2;if(!g){var _=c.editConfigModel,S=_l(l,_);h.isMultiple=S,d.isSelected&&!y&&S?(h.isSelected=!1,d.setSelected(!1)):(c.selectNodeById(d.id,S),h.isSelected=!0,_.isSilentMode||n.toFront()),y?(_.nodeTextEdit&&d.text.editable&&_.textMode===Tt.TEXT&&(d.setSelected(!1),c.setElementStateById(d.id,V.TEXT_EDIT)),c.eventCenter.emit(C.NODE_DBCLICK,h)):(c.eventCenter.emit(C.ELEMENT_CLICK,h),c.eventCenter.emit(C.NODE_CLICK,h))}}}},n.handleContextMenu=function(l){l.preventDefault();var u=n.props,f=u.model,d=u.graphModel,c=d.editConfigModel,p=f.getData(),v=d.getPointByClient({x:l.clientX,y:l.clientY});d.setElementStateById(f.id,V.SHOW_MENU,v.domOverlayPosition),f.isSelected||d.selectNodeById(f.id),d.eventCenter.emit(C.NODE_CONTEXTMENU,{data:p,e:l,position:v}),c.isSilentMode||n.toFront()},n.handleMouseDown=function(l){var u=n.props,f=u.model,d=u.graphModel;n.startTime=new Date().getTime();var c=d.editConfigModel;c.adjustNodePosition&&f.draggable&&n.stepDrag&&n.stepDrag.handleMouseDown(l)},n.handleFocus=function(){var l=n.props,u=l.model,f=l.graphModel;f.eventCenter.emit(C.NODE_FOCUS,{data:u.getData()})},n.handleBlur=function(){var l=n.props,u=l.model,f=l.graphModel;f.eventCenter.emit(C.NODE_BLUR,{data:u.getData()})},n.setHoverOn=function(l){var u=n.props,f=u.model,d=u.graphModel;if(!f.isHovered){var c=f.getData();f.setHovered(!0),d.eventCenter.emit(C.NODE_MOUSEENTER,{data:c,e:l})}},n.setHoverOff=function(l){var u=n.props,f=u.model,d=u.graphModel,c=f.getData();f.isHovered&&(f.setHovered(!1),d.eventCenter.emit(C.NODE_MOUSELEAVE,{data:c,e:l}))};var o=e.graphModel,i=o.gridSize,a=o.eventCenter,s=e.model;return n.stepDrag=new re({onDragStart:n.onDragStart,onDragging:n.onDragging,onDragEnd:n.onDragEnd,step:i,eventType:"NODE",isStopPropagation:!1,eventCenter:a,model:s}),n.modelDisposer=$s(function(){return n.props},function(l){l&&l.model&&n.stepDrag.setModel(l.model)}),n}return t.prototype.componentWillUnmount=function(){this.modelDisposer&&this.modelDisposer(),this.render.$mobx&&this.render.$mobx.dispose()},t.prototype.componentDidMount=function(){},t.prototype.componentDidUpdate=function(){},t.prototype.getAnchorShape=function(e){return null},t.prototype.getAnchors=function(){var e=this,n=this.props,o=n.model,i=n.graphModel,a=o.isSelected,s=o.isHitable,l=o.isDragging,u=o.isShowAnchor;return s&&(a||u)&&!l?le(o.anchors,function(f,d){var c=o.getAnchorLineStyle(f),p=o.getAnchorStyle(f);return b(Up,{anchorData:f,node:e,style:p,edgeStyle:c,anchorIndex:d,nodeModel:o,graphModel:i,setHoverOff:e.setHoverOff})}):[]},t.prototype.getRotateControl=function(){var e=this.props,n=e.model,o=e.graphModel,i=o.editConfigModel,a=i.isSilentMode,s=i.allowRotate,l=n.isSelected,u=n.isHitable,f=n.rotatable,d=n.isHovered,c=s&&f,p=n.getRotateControlStyle();if(!a&&u&&(l||d)&&c)return b(Vp,{graphModel:o,nodeModel:n,eventCenter:o.eventCenter,style:p})},t.prototype.getResizeControl=function(){var e=this.props,n=e.model,o=e.graphModel,i=o.editConfigModel,a=i.isSilentMode,s=i.allowResize,l=n.isSelected,u=n.isHitable,f=n.resizable,d=n.isHovered,c=s&&f,p=n.getResizeControlStyle();return!a&&u&&(l||d)&&c?b(mc,{style:p,model:n,graphModel:o}):null},t.prototype.getText=function(){var e,n=this.props,o=n.model,i=n.graphModel,a=i.editConfigModel;if(a.nodeTextMode!==Tt.TEXT||o.state===V.TEXT_EDIT)return null;if(o.text){var s=!1;return a.nodeTextDraggable&&o.text.draggable&&(s=!0),b(Al,{editable:a.nodeTextEdit&&((e=o.text.editable)!==null&&e!==void 0?e:!0),model:o,graphModel:i,draggable:s})}return null},t.prototype.getStateClassName=function(){var e=this.props.model,n=e.state,o=e.isDragging,i=e.isSelected,a="lf-node";switch(n){case V.ALLOW_CONNECT:a+=" lf-node-allow";break;case V.NOT_ALLOW_CONNECT:a+=" lf-node-not-allow";break;default:a+=" lf-node-default";break}return o&&(a+=" lf-dragging"),i&&(a+=" lf-node-selected"),a},t.prototype.toFront=function(){var e=this.props,n=e.model,o=e.graphModel;n.autoToFront&&o.toFront(n.id)},t.prototype.render=function(){var e=this.props,n=e.model,o=e.graphModel,i=o.editConfigModel,a=i.hideAnchors,s=i.adjustNodePosition,l=i.allowRotate,u=i.allowResize,f=o.gridSize,d=o.transformModel.SCALE_X,c=n.isHitable,p=n.draggable,v=n.transform,h=n.getOuterGAttributes(),g=h.className,y=g===void 0?"":g,_=rh(h,["className"]),S=b("g",{className:"lf-node-content",children:[b("g",{transform:v,children:[this.getShape(),this.getText(),l&&this.getRotateControl(),u&&this.getResizeControl()]}),!a&&this.getAnchors()]}),M;return c?(s&&p&&this.stepDrag.setStep(f*d),M=b("g",In({className:"".concat(this.getStateClassName()," ").concat(y),onMouseDown:this.handleMouseDown,onMouseUp:this.handleMouseUp,onClick:this.handleClick,onMouseEnter:this.setHoverOn,onMouseOver:this.setHoverOn,onMouseLeave:this.setHoverOff,onMouseOut:this.onMouseOut,onContextMenu:this.handleContextMenu,onFocus:this.handleFocus,onBlur:this.handleBlur},_,{children:S}))):M=b("g",In({className:"".concat(this.getStateClassName()," ").concat(y)},_,{children:S})),M},t.isObserved=!1,t}(z),nh=function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),$o=function(){return $o=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},$o.apply(this,arguments)},Ka=function(r){nh(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.getShape=function(){var e=this.props.model,n=e.getNodeStyle();return b(qt,$o({},n,{x:e.x,y:e.y,width:e.width,height:e.height,radius:e.radius}))},t}(be),oh=function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Vo=function(){return Vo=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},Vo.apply(this,arguments)},Za=function(r){oh(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.getShape=function(){var e=this.props.model,n=e.x,o=e.y,i=e.r,a=e.getNodeStyle();return b(nr,Vo({},a,{x:n,y:o,r:i}))},t}(be),ih=function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Bn=function(){return Bn=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},Bn.apply(this,arguments)},qa=function(r){ih(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.getShape=function(){var e=this.props.model,n=e,o=n.x,i=n.y,a=n.width,s=n.height,l=n.points,u=e.getNodeStyle(),f={transform:"matrix(1 0 0 1 ".concat(o-a/2," ").concat(i-s/2,")")};return b("g",Bn({},f,{children:b(Ol,Bn({},u,{points:l,x:o,y:i}))}))},t}(be),ah=function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Wo=function(){return Wo=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},Wo.apply(this,arguments)},Ja=function(r){ah(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.getShape=function(){var e=this.props.model,n=e.getNodeStyle();return b("g",{children:b(Ol,Wo({},n,{points:e.points,x:e.x,y:e.y}))})},t}(be),sh=function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Ko=function(){return Ko=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},Ko.apply(this,arguments)},Qa=function(r){sh(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.getShape=function(){var e=this.props.model,n=e.getNodeStyle();return b(cc,Ko({},n,{x:e.x,y:e.y,rx:e.rx,ry:e.ry}))},t}(be),lh=function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Mr=function(){return Mr=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},Mr.apply(this,arguments)},ts=function(r){lh(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.getBackground=function(){var e=this.props.model,n=e.getTextStyle(),o=e.width,i=e.height,a=e.x,s=e.y,l=Mr(Mr({},n.background),{x:a,y:s,width:o,height:i});return b(qt,Mr({},l))},t.prototype.getResizeControl=function(){return null},t.prototype.getShape=function(){return b("g",{children:this.getBackground()})},t}(be),uh=function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Zo=function(){return Zo=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},Zo.apply(this,arguments)},dh=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i},fh=function(r,t,e){if(e||arguments.length===2)for(var n=0,o=t.length,i;n<o;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return r.concat(i||Array.prototype.slice.call(t))},es=function(r){uh(t,r);function t(){var e=r.apply(this,fh([],dh(arguments),!1))||this;return e.ref=Un(),e}return Object.defineProperty(t.prototype,"rootEl",{get:function(){return this.ref.current},enumerable:!1,configurable:!0}),t.prototype.setHtml=function(e){e.appendChild(document.createElement("div"))},t.prototype.confirmUpdate=function(e){this.setHtml(e)},t.prototype.shouldUpdate=function(){return this.preProperties&&this.preProperties===this.currentProperties?!1:(this.preProperties=this.currentProperties,!0)},t.prototype.componentDidMount=function(){this.shouldUpdate()&&this.rootEl&&this.setHtml(this.rootEl)},t.prototype.componentDidUpdate=function(){this.shouldUpdate()&&this.rootEl&&this.confirmUpdate(this.rootEl)},t.prototype.componentWillUnmount=function(){r.prototype.componentWillUnmount.call(this),this.rootEl.innerHTML=""},t.prototype.getShape=function(){var e=this.props.model,n=e.x,o=e.y,i=e.height,a=e.width,s=e.getNodeStyle();return this.currentProperties=JSON.stringify(e.properties),b("foreignObject",Zo({},s,{x:n-a/2,y:o-i/2,width:a,height:i,ref:this.ref}))},t}(be),ch=function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Lt=function(){return Lt=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},Lt.apply(this,arguments)},ph=function(r,t){var e={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&t.indexOf(n)<0&&(e[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(r);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(r,n[o])&&(e[n[o]]=r[n[o]]);return e},hh=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i},Kt;(function(r){r.SOURCE="SOURCE",r.TARGET="TARGET"})(Kt||(Kt={}));var rs=function(r){ch(t,r);function t(e){var n=r.call(this)||this;n.handleMouseDown=function(l){n.stepDrag&&n.stepDrag.handleMouseDown(l)},n.onDragStart=function(){var l=n.props,u=l.x,f=l.y,d=l.edgeModel,c=d.startPoint,p=d.endPoint,v=d.pointsList;n.oldEdge={startPoint:c,endPoint:p,pointsList:v},n.setState({endX:u,endY:f,dragging:!0})},n.onDragging=function(l){var u=l.deltaX,f=l.deltaY,d=n.state,c=d.endX,p=d.endY,v=n.props,h=v.graphModel,g=v.type,y=h.transformModel,_=h.editConfigModel,S=hh(y.moveCanvasPointByHtml([c,p],u,f),2),M=S[0],w=S[1];n.setState({endX:M,endY:w,dragging:!0});var A=n.props.edgeModel,m=Cn({x:c,y:p},h);if(m&&m.node&&n.isAllowAdjust(m).pass){var O=A.startPoint,P=A.endPoint,T=A.sourceNode,B=A.targetNode,I=g===Kt.SOURCE?{startPoint:{x:m.anchor.x,y:m.anchor.y},endPoint:{x:P.x,y:P.y},sourceNode:m.node,targetNode:B}:{startPoint:{x:O.x,y:O.y},endPoint:{x:m.anchor.x,y:m.anchor.y},sourceNode:T,targetNode:m.node};A.updateAfterAdjustStartAndEnd(I)}else g===Kt.SOURCE?A.updateStartPoint({x:M,y:w}):A.updateEndPoint({x:M,y:w});A.text.value&&_.adjustEdge&&A.setText(Object.assign({},A.text,A.textPosition))},n.onDragEnd=function(l){var u,f,d,c=l.event;try{n.setState({dragging:!1});var p=n.props,v=p.graphModel,h=p.edgeModel,g=p.type,y=n.state,_=y.endX,S=y.endY,M=y.dragging,w=Cn({x:_,y:S},v);if(!M)return;var A=!1,m=void 0;if(w&&w.node){var O=n.isAllowAdjust(w),P=O.pass,T=O.msg,B=O.newTargetNode;if(P){var I=h.getData(),et=I.text,K=I.sourceAnchorId,it=K===void 0?"":K,yt=I.targetAnchorId,Nt=yt===void 0?"":yt,ne=ph(I,["text","sourceAnchorId","targetAnchorId"]);if(m=Lt(Lt({sourceAnchorId:it,targetAnchorId:Nt},ne),{text:(et==null?void 0:et.value)||""}),g===Kt.SOURCE){var gt=v.getNodeModelById(w.node.id),bt=v.getNodeModelById(h.targetNodeId),X=(u=v.edgeGenerator)===null||u===void 0?void 0:u.call(v,gt==null?void 0:gt.getData(),bt==null?void 0:bt.getData(),m);m=Lt(Lt({},X),{sourceNodeId:w.node.id,sourceAnchorId:w.anchor.id,startPoint:{x:w.anchor.x,y:w.anchor.y},targetNodeId:h.targetNodeId,endPoint:Lt({},h.endPoint)}),h.sourceNodeId===w.node.id&&h.sourceAnchorId===w.anchor.id&&(A=!0)}else if(g===Kt.TARGET){var gt=v.getNodeModelById(h.sourceNodeId),bt=v.getNodeModelById(w.node.id),X=(f=v.edgeGenerator)===null||f===void 0?void 0:f.call(v,gt==null?void 0:gt.getData(),bt==null?void 0:bt.getData(),m);m=Lt(Lt({},X),{sourceNodeId:h.sourceNodeId,startPoint:Lt({},h.startPoint),targetNodeId:w.node.id,targetAnchorId:w.anchor.id,endPoint:{x:w.anchor.x,y:w.anchor.y}}),h.targetNodeId===w.node.id&&h.targetAnchorId===w.anchor.id&&(A=!0)}}else{A=!0;var F=B.getData();v.eventCenter.emit(C.CONNECTION_NOT_ALLOWED,{data:F,msg:T})}}else A=!0;if(A)n.recoveryEdge();else{var q=h.getData();v.deleteEdgeById(h.id);var G=v.addEdge(Lt({},m));v.eventCenter.emit(C.EDGE_EXCHANGE_NODE,{data:{newEdge:G.getData(),oldEdge:q}})}(d=n.preTargetNode)===null||d===void 0||d.setElementState(V.DEFAULT)}finally{var v=n.props.graphModel;v.eventCenter.emit(C.ADJUST_POINT_DRAGEND,{e:c,data:n.stepDragData})}},n.recoveryEdge=function(){var l=n.props.edgeModel,u=n.oldEdge,f=u.startPoint,d=u.endPoint,c=u.pointsList;l.updateStartPoint(f),l.updateEndPoint(d),l.modelType!==Y.LINE_EDGE&&(l.pointsList=c??[],l.initPoints())},n.getAdjustPointStyle=function(){var l=n.props.graphModel.theme,u=l.edgeAdjust;return u},n.state={dragging:!1,endX:0,endY:0},n.targetRuleResults=new Map,n.sourceRuleResults=new Map;var o=e.type,i=e.edgeModel,a=e.graphModel,s=a.eventCenter;return n.stepDragData={type:o,edgeData:i.getData()},n.stepDrag=new re({onDragStart:n.onDragStart,onDragging:n.onDragging,onDragEnd:n.onDragEnd,eventType:"ADJUST_POINT",isStopPropagation:!1,eventCenter:s,data:n.stepDragData}),n}return t.prototype.isAllowAdjust=function(e){var n=this.props,o=n.edgeModel,i=o.id,a=o.sourceNode,s=o.targetNode,l=o.sourceAnchorId,u=o.targetAnchorId,f=n.type,d,c,p,v;if(f===Kt.SOURCE?(d=e.node,c=s,p=e.anchor,v=s.getAnchorInfo(u)):(d=a,c=e.node,v=e.anchor,p=a.getAnchorInfo(l)),this.preTargetNode&&this.preTargetNode!==e.node&&this.preTargetNode.setElementState(V.DEFAULT),this.preTargetNode=e.node,v.id===p.id)return{pass:!1,msg:"",newTargetNode:c};var h="".concat(d.id,"_").concat(c.id,"_").concat(p.id,"_").concat(v.id);if(!this.targetRuleResults.has(h)){var g=d.isAllowConnectedAsSource(c,p,v,i),y=c.isAllowConnectedAsTarget(d,p,v,i);this.sourceRuleResults.set(h,Rn(g)),this.targetRuleResults.set(h,Rn(y))}var _=this.sourceRuleResults.get(h),S=_.isAllPass,M=_.msg,w=this.targetRuleResults.get(h),A=w.isAllPass,m=w.msg,O=S&&A?V.ALLOW_CONNECT:V.NOT_ALLOW_CONNECT;return f===Kt.SOURCE?d.setElementState(O):c.setElementState(O),{pass:S&&A,msg:m||M,newTargetNode:c}},t.prototype.render=function(){var e=this.props,n=e.x,o=e.y,i=e.getAdjustPointShape,a=e.edgeModel,s=this.state.dragging;return b("g",{pointerEvents:s?"none":"",onMouseDown:this.handleMouseDown,children:s?"":i(n,o,a)})},t}(z),vh=function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),qo=function(){return qo=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},qo.apply(this,arguments)};(function(r){vh(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.getArrowAttributes=function(){var e=this.props,n=e.arrowInfo,o=e.style,i=n.start,a=n.end,s={start:i,end:a,offset:o.offset,verticalLength:o.verticalLength,type:"end"},l=Cr(s),u=l.leftX,f=l.leftY,d=l.rightX,c=l.rightY;return qo({d:"M".concat(u," ").concat(f," L").concat(a.x," ").concat(a.y," L").concat(d," ").concat(c," z")},o)},t.prototype.getShape=function(){var e=this.getArrowAttributes(),n=e.d,o=e.strokeWidth,i=e.stroke,a=e.fill;return b(Lr,{d:n,fill:a,strokeWidth:o,stroke:i})},t.prototype.render=function(){return b("g",{className:"lf-arrow",children:this.getShape()})},t})(z);var yh=function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Ar=function(){return Ar=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},Ar.apply(this,arguments)},gh=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i},Qn=function(r){yh(t,r);function t(){var e=r.call(this)||this;return e.textRef=Un(),e.handleHover=function(n,o){var i=e.props,a=i.model,s=i.graphModel.eventCenter;a.setHovered(n);var l=n?C.EDGE_MOUSEENTER:C.EDGE_MOUSELEAVE,u=a.getData();s.emit(l,{data:u,e:o})},e.setHoverOn=function(n){var o=e.props.model.isHovered;o||(e.textRef&&e.textRef.current&&e.textRef.current.setHoverOn(),e.handleHover(!0,n))},e.setHoverOff=function(n){var o=e.props.model.isHovered;o&&(e.textRef&&e.textRef.current&&e.textRef.current.setHoverOff(),e.handleHover(!1,n))},e.handleContextMenu=function(n){n.preventDefault(),e.contextMenuTime=new Date().getTime(),e.clickTimer&&clearTimeout(e.clickTimer);var o=e.props,i=o.model,a=o.graphModel,s=a.editConfigModel,l=a.getPointByClient({x:n.clientX,y:n.clientY});a.setElementStateById(i.id,V.SHOW_MENU,l.domOverlayPosition),s.isSilentMode||e.toFront(),i.isSelected||a.selectEdgeById(i.id);var u=i==null?void 0:i.getData();a.eventCenter.emit(C.EDGE_CONTEXTMENU,{data:u,e:n,position:l})},e.handleMouseDown=function(n){n.stopPropagation(),e.startTime=new Date().getTime()},e.handleMouseUp=function(){var n=e.props.model;e.mouseUpDrag=n.isDragging},e.handleClick=function(n){if(e.startTime&&!e.mouseUpDrag){var o=n.button===2;if(!o){var i=n.detail===2,a=e.props,s=a.model,l=a.graphModel,u=s==null?void 0:s.getData(),f=l.getPointByClient({x:n.clientX,y:n.clientY});if(i){var d=l.editConfigModel,c=l.textEditElement,p=s.id,v=s.text,h=s.modelType;if(c&&c.id===p&&l.setElementStateById(p,V.DEFAULT),d.edgeTextEdit&&v.editable&&(s.setSelected(!1),l.setElementStateById(p,V.TEXT_EDIT)),h===Y.POLYLINE_EDGE){var g=s,y=l.getPointByClient({x:n.x,y:n.y}).canvasOverlayPosition,_=y.x,S=y.y;g.dbClickPosition=gl({x:_,y:S},g.points)}l.eventCenter.emit(C.EDGE_DBCLICK,{data:u,e:n,position:f})}else l.eventCenter.emit(C.ELEMENT_CLICK,{data:u,e:n,position:f}),l.eventCenter.emit(C.EDGE_CLICK,{data:u,e:n,position:f});var M=l.editConfigModel;l.selectEdgeById(s.id,_l(n,M)),M.isSilentMode||e.toFront()}}},e.handleFocus=function(){var n=e.props,o=n.model,i=n.graphModel;i.eventCenter.emit(C.EDGE_FOCUS,{data:o.getData()})},e.handleBlur=function(){var n=e.props,o=n.model,i=n.graphModel;i.eventCenter.emit(C.EDGE_BLUR,{data:o.getData()})},e}return t.prototype.getShape=function(){return b("g",{children:this.getEdge()})},t.prototype.getTextStyle=function(){},t.prototype.getText=function(){var e,n=this.props,o=n.model,i=n.graphModel,a=i.editConfigModel;if(a.edgeTextMode!==Tt.TEXT||o.state===V.TEXT_EDIT)return null;if(o.text){var s=!1;return a.edgeTextDraggable&&o.text.draggable&&(s=!0),b(th,{ref:this.textRef,editable:a.edgeTextEdit&&((e=o.text.editable)!==null&&e!==void 0?e:!0),model:o,graphModel:i,draggable:s})}return null},t.prototype.getArrowInfo=function(){var e=this.props.model,n=e.startPoint,o=e.endPoint,i=e.isSelected,a=this.state.hover;return{start:n,end:o,hover:a,isSelected:i}},t.prototype.getLastTwoPoints=function(){var e=this.props.model,n=e.startPoint,o=e.endPoint;return[n,o]},t.prototype.getArrowStyle=function(){return console.error("getArrowStyle is deprecated in 1.2.0, please use model.getArrowStyle"),null},t.prototype.getArrow=function(){var e=this.props.model,n=e.id,o=e.getArrowStyle(),i=o.refY,a=i===void 0?0:i,s=o.refX,l=s===void 0?2:s,u=gh(this.getLastTwoPoints(),2),f=u[0],d=u[1],c="auto";return f!==null&&d!==null&&(c=Ic(Lc({x:d.x-f.x,y:d.y-f.y}))),b("g",{children:b("defs",{children:[b("marker",{id:"marker-start-".concat(n),refX:-l,refY:a,overflow:"visible",orient:"auto",markerUnits:"userSpaceOnUse",children:this.getStartArrow()}),b("marker",{id:"marker-end-".concat(n),refX:l,refY:a,overflow:"visible",orient:c,markerUnits:"userSpaceOnUse",children:this.getEndArrow()})]})})},t.prototype.getStartArrow=function(){return b("path",{})},t.prototype.getEndArrow=function(){var e=this.props.model,n=e.getArrowStyle(),o=n.stroke,i=n.strokeWidth,a=n.offset,s=n.verticalLength;return b("path",{stroke:o,fill:o,strokeWidth:i,transform:"rotate(180)",d:"M 0 0 L ".concat(a," -").concat(s," L ").concat(a," ").concat(s," Z")})},t.prototype.getAdjustPointShape=function(e,n,o){var i=o.getAdjustPointStyle();return b(nr,Ar({className:"lf-edge-adjust-point"},i,{x:e,y:n}))},t.prototype.getAdjustPoints=function(){var e=this.props,n=e.model,o=e.graphModel,i=o.editConfigModel,a=i.adjustEdgeStartAndEnd,s=i.adjustEdgeStart,l=i.adjustEdgeEnd,u=n.getAdjustStart(),f=n.getAdjustEnd();return b("g",{children:[a&&s&&b(rs,Ar({type:Kt.SOURCE},u,{getAdjustPointShape:this.getAdjustPointShape,edgeModel:n,graphModel:o})),a&&l&&b(rs,Ar({type:Kt.TARGET},f,{getAdjustPointShape:this.getAdjustPointShape,edgeModel:n,graphModel:o}))]})},t.prototype.getAnimation=function(){console.error("getAnimation is deprecated in 1.2.0, please use model.getEdgeAnimationStyle")},t.prototype.getAppendWidth=function(){return b("g",{})},t.prototype.getAppend=function(){return b("g",{className:"lf-edge-append",children:this.getAppendWidth()})},t.prototype.getEdge=function(){return null},t.prototype.toFront=function(){var e=this.props,n=e.graphModel,o=e.model;n.toFront(o.id)},t.prototype.render=function(){var e=this.props.model,n=e.isSelected,o=e.isHitable,i=e.isShowAdjustPoint;return b("g",{children:[b("g",{className:["lf-edge",!o&&"pointer-none",n&&"lf-edge-selected"].filter(Boolean).join(" "),onMouseDown:this.handleMouseDown,onMouseUp:this.handleMouseUp,onClick:this.handleClick,onContextMenu:this.handleContextMenu,onMouseOver:this.setHoverOn,onMouseEnter:this.setHoverOn,onMouseLeave:this.setHoverOff,onFocus:this.handleFocus,onBlur:this.handleBlur,children:[this.getShape(),this.getAppend(),this.getText(),this.getArrow()]}),i&&n?this.getAdjustPoints():""]})},t.isObserved=!1,t}(z),_h=function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Jo=function(){return Jo=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},Jo.apply(this,arguments)},mh=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i},ns=function(r){_h(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.getEdge=function(){var e=this.props.model,n=e.getEdgeStyle(),o=e,i=o.path,a=o.isAnimation,s=o.arrowConfig,l=e.getEdgeAnimationStyle(),u=l.strokeDasharray,f=l.stroke,d=l.strokeDashoffset,c=l.animationName,p=l.animationDuration,v=l.animationIterationCount,h=l.animationTimingFunction,g=l.animationDirection;return b(Lr,Jo({d:i},n,s,a?{strokeDasharray:u,stroke:f,style:{strokeDashoffset:d,animationName:c,animationDuration:p,animationIterationCount:v,animationTimingFunction:h,animationDirection:g}}:{}))},t.prototype.getAppendWidth=function(){var e=this.props.model.path;return b(Lr,{d:e,strokeWidth:10,stroke:"transparent",fill:"none"})},t.prototype.getArrowInfo=function(){var e=this.props.model,n=this.state.hover,o=e.isSelected,i=e.getArrowStyle().offset,a=e.pointsList.map(function(d){return{x:d.x,y:d.y}}),s=mh(Oa(a,i),2),l=s[0],u=s[1],f={start:l,end:u,hover:n,isSelected:o};return f},t.prototype.getLastTwoPoints=function(){var e=this.props.model,n=e.getArrowStyle().offset,o=e.pointsList.map(function(i){return{x:i.x,y:i.y}});return Oa(o,n)},t}(Qn),xh=function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Qo=function(){return Qo=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},Qo.apply(this,arguments)},os=function(r){xh(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.getEdge=function(){var e=this.props.model,n=e.startPoint,o=e.endPoint,i=e.isAnimation,a=e.arrowConfig,s=e.getEdgeStyle(),l=e.getEdgeAnimationStyle(),u=l.strokeDasharray,f=l.stroke,d=l.strokeDashoffset,c=l.animationName,p=l.animationDuration,v=l.animationIterationCount,h=l.animationTimingFunction,g=l.animationDirection;return b(rr,Qo({},s,{x1:n.x,y1:n.y,x2:o.x,y2:o.y},a,i?{strokeDasharray:u,stroke:f,style:{strokeDashoffset:d,animationName:c,animationDuration:p,animationIterationCount:v,animationTimingFunction:h,animationDirection:g}}:{}))},t.prototype.getAppendWidth=function(){var e=this.props.model,n=e.startPoint,o=e.endPoint,i={start:n,end:o},a=Yf(i),s=a.d,l=a.strokeWidth,u=a.fill,f=a.strokeDasharray,d=a.stroke;return b(Lr,{d:s,fill:u,strokeWidth:l,stroke:d,strokeDasharray:f})},t}(Qn),Eh=function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Me=function(){return Me=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},Me.apply(this,arguments)},bh=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i},is=function(r){Eh(t,r);function t(){var e=r.call(this)||this;return e.onDragStart=function(){var n=e.props.model;n.dragAppendStart(),e.isShowAdjustPointTemp=n.isShowAdjustPoint,n.isShowAdjustPoint=!1},e.onDragging=function(n){var o=n.deltaX,i=n.deltaY,a=e.props,s=a.model,l=a.graphModel;e.isDragging=!0;var u=l.transformModel,f=l.editConfigModel,d=bh(u.fixDeltaXY(o,i),2),c=d[0],p=d[1],v=s,h=f.adjustEdgeMiddle;h?e.appendInfo=v.dragAppendSimple(e.appendInfo,{x:c,y:p}):e.appendInfo=v.dragAppend(e.appendInfo,{x:c,y:p})},e.onDragEnd=function(){var n,o=e.props,i=o.model,a=o.graphModel.eventCenter,s=i;s.dragAppendEnd(),e.isDragging=!1,s.isShowAdjustPoint=(n=e.isShowAdjustPointTemp)!==null&&n!==void 0?n:!1,e.appendInfo=void 0,a.emit(C.EDGE_ADJUST,{data:s.getData()})},e.beforeDragStart=function(n,o){o.draggable&&e.drag.handleMouseDown(n),e.appendInfo=o},e.drag=new re({onDragStart:e.onDragStart,onDragging:e.onDragging,onDragEnd:e.onDragEnd,isStopPropagation:!1}),e}return t.prototype.getEdge=function(){var e=this.props.model,n=e.points,o=e.isAnimation,i=e.arrowConfig,a=e.getEdgeStyle(),s=e.getEdgeAnimationStyle(),l=s.strokeDasharray,u=s.stroke,f=s.strokeDashoffset,d=s.animationName,c=s.animationDuration,p=s.animationIterationCount,v=s.animationTimingFunction,h=s.animationDirection;return b(vc,Me({points:n},a,i,o?{strokeDasharray:l,stroke:u,style:{strokeDashoffset:f,animationName:d,animationDuration:c,animationIterationCount:p,animationTimingFunction:v,animationDirection:h}}:{}))},t.prototype.getArrowInfo=function(){var e=this.props.model,n=e.points,o=e.isSelected,i=this.state.hover,a=Re(n),s=a[0],l=a[0];return a.length>=2&&(s=a[a.length-2],l=a[a.length-1]),{start:s,end:l,hover:i,isSelected:o}},t.prototype.getLastTwoPoints=function(){var e=this.props.model,n=e.points,o=Re(n),i=o[0],a=o[0];return o.length>=2&&(i=o[o.length-2],a=o[o.length-1]),[i,a]},t.prototype.getAppendAttributes=function(e){var n=e.start,o=e.end,i;if(n.x===o.x&&n.y===o.y)i="";else{var a={start:n,end:o,offset:10,verticalLength:5},s=Cr(Me(Me({},a),{type:"start"})),l=Cr(Me(Me({},a),{type:"end"}));i="M".concat(s.leftX," ").concat(s.leftY,`
      L`).concat(s.rightX," ").concat(s.rightY,`
      L`).concat(l.rightX," ").concat(l.rightY,`
      L`).concat(l.leftX," ").concat(l.leftY," z")}return{d:i,fill:"transparent",stroke:"transparent",strokeWidth:1,strokeDasharray:"4, 4"}},t.prototype.getAppendShape=function(e){var n=this.getAppendAttributes(e),o=n.d,i=n.strokeWidth,a=n.fill,s=n.strokeDasharray,l=n.stroke;return b(Lr,{d:o,fill:a,strokeWidth:i,stroke:l,strokeDasharray:s})},t.prototype.getAppendWidth=function(){for(var e=this,n=this.props,o=n.model,i=n.graphModel,a=o.pointsList,s=o.draggable,l=[],u=a.length,f=function(p){var v="lf-polyline-append",h={start:{x:a[p].x,y:a[p].y},end:{x:a[p+1].x,y:a[p+1].y},startIndex:p,endIndex:p+1,direction:rt.HORIZONTAL,draggable:!0},g=b("g",{className:v,children:d.getAppendShape(h)}),y=i.editConfigModel,_=y.adjustEdge,S=y.adjustEdgeMiddle;if(_&&s){var M=h.startIndex,w=h.endIndex,A=S&&(M===0||w===u-1);h.draggable=!A,h.start.x===h.end.x?(h.draggable&&(v+="-ew-resize"),h.direction=rt.VERTICAL):h.start.y===h.end.y&&(h.draggable&&(v+="-ns-resize"),h.direction=rt.HORIZONTAL),g=b("g",{className:d.isDragging?"lf-dragging":"lf-drag-able",onMouseDown:function(m){return e.beforeDragStart(m,h)},children:b("g",{className:v,children:d.getAppendShape(h)})})}l.push(g)},d=this,c=0;c<u-1;c++)f(c);return b("g",{children:l})},t}(Qn),Fe=function(){return Fe=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},Fe.apply(this,arguments)},Oh=function(){function r(t){var e=this;this.nodeConfig=null,this.fakeNode=null,this.stopDrag=function(){e.nodeConfig=null,window.document.removeEventListener("mouseup",e.stopDrag)},this.dragEnter=function(o){!e.nodeConfig||e.fakeNode||(e.fakeNode=e.lf.createFakeNode(Fe(Fe({},e.nodeConfig),e.clientToLocalPoint({x:o.clientX,y:o.clientY}))))},this.onDragOver=function(o){if(o.preventDefault(),e.fakeNode){var i=e.clientToLocalPoint({x:o.clientX,y:o.clientY}),a=i.x,s=i.y;e.fakeNode.moveTo(a,s);var l=e.fakeNode.getData();e.lf.setNodeSnapLine(l),e.lf.graphModel.eventCenter.emit(C.NODE_DND_DRAG,{data:l,e:o})}return!1},this.onDragLeave=function(){e.fakeNode&&(e.lf.removeNodeSnapLine(),e.lf.graphModel.removeFakeNode(),e.fakeNode=null)},this.onDrop=function(o){!e.lf.graphModel||!o||!e.nodeConfig||(e.lf.addNode(Fe(Fe({},e.nodeConfig),e.clientToLocalPoint({x:o.clientX,y:o.clientY})),C.NODE_DND_ADD,o),o.preventDefault(),o.stopPropagation(),e.nodeConfig=null,e.lf.removeNodeSnapLine(),e.lf.graphModel.removeFakeNode(),e.fakeNode=null)};var n=t.lf;this.lf=n}return r.prototype.clientToLocalPoint=function(t){var e=t.x,n=t.y,o=zn(this.lf.options,["grid","size"]),i=this.lf.graphModel.getPointByClient({x:e,y:n}),a=i.canvasOverlayPosition,s=a.x,l=a.y,u=this.lf.graphModel.editConfigModel.snapGrid;return{x:er(s,o,u),y:er(l,o,u)}},r.prototype.startDrag=function(t){var e=this.lf.graphModel.editConfigModel;e!=null&&e.isSilentMode||(this.nodeConfig=t,window.document.addEventListener("mouseup",this.stopDrag))},r.prototype.eventMap=function(){return{onMouseEnter:this.dragEnter,onMouseOver:this.dragEnter,onMouseMove:this.onDragOver,onMouseLeave:this.onDragLeave,onMouseUp:this.onDrop}},r}();function Sh(r,t){r.on("node:mousemove",function(e){var n=e.data;t.setNodeSnapLine(n)}),r.on("node:mouseup",function(){t.clearSnapline()})}var wh=function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),oe=function(){return oe=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},oe.apply(this,arguments)},Mh=function(r,t,e,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,t,e,n);else for(var s=r.length-1;s>=0;s--)(a=r[s])&&(i=(o<3?a(i):o>3?a(t,e,i):a(t,e))||i);return o>3&&i&&Object.defineProperty(t,e,i),i},Ah=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i},Ph=function(r){wh(t,r);function t(e){var n=r.call(this,e)||this;return n.ref=Un(),n.__prevText={type:"",text:"",id:""},n.keyupHandler=function(o){var i=n.props.graphModel.textEditElement;o.key==="Enter"&&o.altKey&&(i==null||i.setElementState(V.DEFAULT))},n.inputHandler=function(o){var i=o.target.innerText,a=n.props.graphModel.textEditElement;a&&(n.__prevText={type:a.type,text:i.replace(/(\r\n)+$|(\n)+$/,""),id:a.id})},n.keydownHandler=function(o){o.stopPropagation()},n.state={style:{left:0,top:0}},n}return t.getDerivedStateFromProps=function(e){var n,o=e.textEditElement,i=e.graphModel,a=i.transformModel,s=i.theme,l=s.inputText,u;if(o){if(!(!((n=o.text)===null||n===void 0)&&n.value)&&o.BaseType===ot.EDGE){var f=o.text,d=o.textPosition,c=d.x,p=d.y;f.x=c,f.y=p,o.setText(f)}var v={resize:"auto",whiteSpace:"normal",wordBreak:"break-all"};if(o.BaseType===ot.EDGE){var h=s.edgeText,g=h.overflowMode,y=h.lineHeight,_=h.wrapPadding,S=h.textWidth;S&&g==="autoWrap"&&(u=oe(oe({},v),{width:S,minWidth:S,lineHeight:y,padding:_}))}else if(o.BaseType===ot.NODE){var M=s.nodeText,g=M.overflowMode,y=M.lineHeight,_=M.wrapPadding,S=M.textWidth,w=o.width,A=o.modelType,m=o.textWidth,O=m||S||w;(A!==Y.TEXT_NODE&&g==="autoWrap"||A===Y.TEXT_NODE&&S)&&(u=oe(oe({},v),{width:O,minWidth:O,lineHeight:y,padding:_}))}var P=o.text,T=P.x,B=P.y,I=Ah(a.CanvasPointToHtmlPoint([T,B]),2),et=I[0],K=I[1];return{style:oe(oe({left:et,top:K},u),l)}}return null},t.prototype.componentDidUpdate=function(){var e=this.props.graphModel;if(this.ref.current&&(this.ref.current.focus(),this.placeCaretAtEnd(this.ref.current)),this.__prevText.id!==""){var n=this.__prevText,o=n.text,i=n.id;e.updateText(i,o),e.eventCenter.emit(C.TEXT_UPDATE,{data:oe({},this.__prevText)}),this.__prevText.id="",this.__prevText.text="",this.__prevText.type=""}},t.prototype.placeCaretAtEnd=function(e){if(window.getSelection!==void 0&&document.createRange!==void 0){var n=document.createRange();n.selectNodeContents(e),n.collapse(!1);var o=window.getSelection();o==null||o.removeAllRanges(),o==null||o.addRange(n)}},t.prototype.render=function(){var e,n=this.props.graphModel.textEditElement,o=this.state.style;return n?b("div",{contentEditable:!0,className:"lf-text-input",style:o,ref:this.ref,onKeyUp:this.keyupHandler,onKeyDown:this.keydownHandler,onKeyPress:this.keydownHandler,onInput:this.inputHandler,children:(e=n.text)===null||e===void 0?void 0:e.value},n.id):null},t.toolName="text-edit-tool",t=Mh([St],t),t}(z),Th=function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Dh=function(r,t,e,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,t,e,n);else for(var s=r.length-1;s>=0;s--)(a=r[s])&&(i=(o<3?a(i):o>3?a(t,e,i):a(t,e))||i);return o>3&&i&&Object.defineProperty(t,e,i),i},co=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i},Nh=function(r,t,e){if(e||arguments.length===2)for(var n=0,o=t.length,i;n<o;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return r.concat(i||Array.prototype.slice.call(t))},Ch=function(r){Th(t,r);function t(e){var n=r.call(this,e)||this;n.handleMouseDown=function(s){n.stepDrag.handleMouseDown(s)},n.handleWheelEvent=function(s){var l,u;s.preventDefault();var f=s.deltaX,d=s.deltaY,c=s.clientX,p=s.clientY,v=s.ctrlKey,h=new WheelEvent("wheel",{deltaX:f,deltaY:d,clientX:c,clientY:p,ctrlKey:v});(u=(l=n.props.lf.container)===null||l===void 0?void 0:l.querySelector('.lf-canvas-overlay[name="canvas-overlay"]'))===null||u===void 0||u.dispatchEvent(h)},n.onDragging=function(s){var l=s.deltaX,u=s.deltaY,f=n.props,d=f.graphModel,c=f.lf,p=c.getTransform(),v=p.SCALE_X,h=p.SCALE_Y,g=d.getSelectElements(!0);d.moveNodes(g.nodes.map(function(y){return y.id}),l/v,u/h)},n.handleContextMenu=function(s){s.preventDefault();var l=n.props,u=l.graphModel,f=l.graphModel,d=f.eventCenter,c=f.selectElements,p=u.getPointByClient({x:s.clientX,y:s.clientY}),v={nodes:[],edges:[]},h=Nh([],co(c.values()),!1);h.forEach(function(g){g.BaseType===ot.NODE&&v.nodes.push(g.getData()),g.BaseType===ot.EDGE&&v.edges.push(g.getData())}),d.emit(C.SELECTION_CONTEXTMENU,{data:v,e:s,position:p})};var o=e.graphModel,i=o.gridSize,a=o.eventCenter;return n.stepDrag=new re({onDragging:n.onDragging,step:i,eventType:"SELECTION",eventCenter:a}),n}return t.prototype.render=function(){var e,n,o=this.props.graphModel,i=o.selectElements,a=o.transformModel,s=this.props.lf.getTransform(),l=s.SCALE_X,u=s.SCALE_Y;if(!(i.size<=1)){var f=Number.MAX_SAFE_INTEGER,d=Number.MAX_SAFE_INTEGER,c=Number.MIN_SAFE_INTEGER,p=Number.MIN_SAFE_INTEGER;i.forEach(function(h){var g;h.BaseType===ot.NODE&&(g=Sf(h)),h.BaseType===ot.EDGE&&(g=Pf(h)),g!==void 0&&(f=Math.min(f,g.x),d=Math.min(d,g.y),c=Math.max(c,g.x1),p=Math.max(p,g.y1))}),e=co(a.CanvasPointToHtmlPoint([f,d]),2),f=e[0],d=e[1],n=co(a.CanvasPointToHtmlPoint([c,p]),2),c=n[0],p=n[1];var v={left:"".concat(f-20*l/2,"px"),top:"".concat(d-20*u/2,"px"),width:"".concat(c-f+20*l,"px"),height:"".concat(p-d+20*u,"px"),"border-width":"".concat(2*l,"px")};return b("div",{className:"lf-multiple-select",style:v,onMouseDown:this.handleMouseDown,onContextMenu:this.handleContextMenu,onWheel:this.handleWheelEvent})}},t.toolName="multiple-select-tool",t=Dh([St],t),t}(z),po=function(r,t,e,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,t,e,n);else for(var s=r.length-1;s>=0;s--)(a=r[s])&&(i=(o<3?a(i):o>3?a(t,e,i):a(t,e))||i);return o>3&&i&&Object.defineProperty(t,e,i),i},Rh=[Ph,Ch],jh=function(){function r(t){var e=this;this.toolMap=new Map,this.disabledToolMap=new Map,this.instance=t,at(Rh,function(i){e.isDisabled(i.toolName)||e.registerTool(i.toolName,i)});var n=t.graphModel,o=n.eventCenter;o.on("".concat(C.GRAPH_TRANSFORM,",").concat(C.NODE_CLICK,",").concat(C.BLANK_CLICK," "),function(){var i,a=n.textEditElement,s=n.editConfigModel,l=s.edgeTextEdit,u=s.nodeTextEdit;(l||u)&&a&&((i=n.textEditElement)===null||i===void 0||i.setElementState(V.DEFAULT))})}return r.prototype.isDisabled=function(t){var e;return((e=this.instance.options.disabledTools)===null||e===void 0?void 0:e.indexOf(t))!==-1},r.prototype.registerTool=function(t,e){this.toolMap.set(t,e)},r.prototype.disableTool=function(t){var e=this.toolMap.get(t);if(e)return this.disabledToolMap.set(t,e),this.toolMap.delete(t),!0;throw new Error("禁用失败，不存在名为 ".concat(e," 的工具"))},r.prototype.enableTool=function(t){var e=this.disabledToolMap.get(t);if(e)return this.toolMap.set(t,e),this.disabledToolMap.delete(t),!0;throw new Error("不存在名为 ".concat(e," 的工具"))},r.prototype.getTools=function(){return Array.from(this.toolMap.values())},r.prototype.getInstance=function(){return this.instance},r.prototype.destroy=function(){this.toolMap.clear(),this.disabledToolMap.clear()},po([E],r.prototype,"toolMap",void 0),po([x],r.prototype,"disableTool",null),po([x],r.prototype,"enableTool",null),r}();function Lh(r){throw new Error("[mobx-utils] "+r)}function Xn(r,t){t===void 0&&(t="Illegal state"),r||Lh(t)}var Pl=function(r){return r&&r!==Object.prototype&&Object.getOwnPropertyNames(r).concat(Pl(Object.getPrototypeOf(r))||[])},Ih=function(r){var t=Pl(r),e=t.filter(function(n,o){return t.indexOf(n)===o});return e},Bh=function(r){return Ih(r).filter(function(t){return t!=="constructor"&&!~t.indexOf("__")})},Tl="pending",kn="fulfilled",bi="rejected";function Xh(r){switch(this.state){case Tl:return r.pending&&r.pending(this.value);case bi:return r.rejected&&r.rejected(this.value);case kn:return r.fulfilled?r.fulfilled(this.value):this.value}}function as(r,t){if(Xn(arguments.length<=2,"fromPromise expects up to two arguments"),Xn(typeof r=="function"||typeof r=="object"&&r&&typeof r.then=="function","Please pass a promise or function to fromPromise"),r.isPromiseBasedObservable===!0)return r;typeof r=="function"&&(r=new Promise(r));var e=r;r.then(x("observableFromPromise-resolve",function(o){e.value=o,e.state=kn}),x("observableFromPromise-reject",function(o){e.value=o,e.state=bi})),e.isPromiseBasedObservable=!0,e.case=Xh;var n=t&&t.state===kn?t.value:void 0;return Po(e,{value:n,state:Tl},{},{deep:!1}),e}(function(r){r.reject=x("fromPromise.reject",function(e){var n=r(Promise.reject(e));return n.state=bi,n.value=e,n});function t(e){e===void 0&&(e=void 0);var n=r(Promise.resolve(e));return n.state=kn,n.value=e,n}r.resolve=x("fromPromise.resolve",t)})(as||(as={}));var un=function(r,t,e,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,t,e,n);else for(var s=r.length-1;s>=0;s--)(a=r[s])&&(i=(o<3?a(i):o>3?a(t,e,i):a(t,e))||i);return o>3&&i&&Object.defineProperty(t,e,i),i};(function(){function r(t,e){var n=this;_d(function(){n.current=e,n.subscription=t.subscribe(n)})}return r.prototype.dispose=function(){this.subscription&&this.subscription.unsubscribe()},r.prototype.next=function(t){this.current=t},r.prototype.complete=function(){this.dispose()},r.prototype.error=function(t){this.current=t,this.dispose()},un([E.ref],r.prototype,"current",void 0),un([x.bound],r.prototype,"next",null),un([x.bound],r.prototype,"complete",null),un([x.bound],r.prototype,"error",null),r})();var Hn=function(){return Hn=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},Hn.apply(this,arguments)},fr=function(r,t,e,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,t,e,n);else for(var s=r.length-1;s>=0;s--)(a=r[s])&&(i=(o<3?a(i):o>3?a(t,e,i):a(t,e))||i);return o>3&&i&&Object.defineProperty(t,e,i),i},kh=["model","reset","submit","isDirty","isPropertyDirty","resetProperty"];(function(){function r(t){var e=this;this.model=t,this.localValues=E.map({}),this.localComputedValues=E.map({}),this.isPropertyDirty=function(n){return e.localValues.has(n)},Xn(Ft(t),"createViewModel expects an observable object"),Bh(t).forEach(function(n){if(!(n===L||n==="__mobxDidRunLazyInitializers")){if(Xn(kh.indexOf(n)===-1,"The propertyname "+n+" is reserved and cannot be used with viewModels"),Ri(t,n)){var o=Zn(t,n).derivation;e.localComputedValues.set(n,tt(o.bind(e)))}var i=Object.getOwnPropertyDescriptor(t,n),a=i?{enumerable:i.enumerable}:{};Object.defineProperty(e,n,Hn(Hn({},a),{configurable:!0,get:function(){return Ri(t,n)?e.localComputedValues.get(n).get():e.isPropertyDirty(n)?e.localValues.get(n):e.model[n]},set:x(function(s){s!==e.model[n]?e.localValues.set(n,s):e.localValues.delete(n)})}))}})}return Object.defineProperty(r.prototype,"isDirty",{get:function(){return this.localValues.size>0},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"changedValues",{get:function(){return this.localValues.toJS()},enumerable:!1,configurable:!0}),r.prototype.submit=function(){var t=this;tr(this.localValues).forEach(function(e){var n=t.localValues.get(e),o=t.model[e];ee(o)?o.replace(n):Et(o)?(o.clear(),o.merge(n)):wd(n)||(t.model[e]=n)}),this.localValues.clear()},r.prototype.reset=function(){this.localValues.clear()},r.prototype.resetProperty=function(t){this.localValues.delete(t)},fr([tt],r.prototype,"isDirty",null),fr([tt],r.prototype,"changedValues",null),fr([x.bound],r.prototype,"submit",null),fr([x.bound],r.prototype,"reset",null),fr([x.bound],r.prototype,"resetProperty",null),r})();function ho(r){if(!r)return"ROOT";for(var t=[];r.parent;)t.push(r.path),r=r.parent;return t.reverse().join("/")}function vo(r){return Ft(r)||ee(r)||Et(r)}function Hh(r,t){var e=new WeakMap;function n(s){var l=e.get(s.object);o(s,l),t(s,ho(l),r)}function o(s,l){switch(s.type){case"add":i(s.newValue,l,s.name);break;case"update":a(s.oldValue),i(s.newValue,l,s.name||""+s.index);break;case"remove":case"delete":a(s.oldValue);break;case"splice":s.removed.map(a),s.added.forEach(function(d,c){return i(d,l,""+(s.index+c))});for(var u=s.index+s.addedCount;u<s.object.length;u++)if(vo(s.object[u])){var f=e.get(s.object[u]);f&&(f.path=""+u)}break}}function i(s,l,u){if(vo(s)){var f=e.get(s);if(f){if(f.parent!==l||f.path!==u)throw new Error("The same observable object cannot appear twice in the same tree,"+(" trying to assign it to '"+ho(l)+"/"+u+"',")+(" but it already exists at '"+ho(f.parent)+"/"+f.path+"'"))}else{var d={parent:l,path:u,dispose:Qs(s,n)};e.set(s,d),Pd(s).forEach(function(c){var p=c[0],v=c[1];return i(v,d,p)})}}}function a(s){if(vo(s)){var l=e.get(s);if(!l)return;e.delete(s),l.dispose(),Ad(s).forEach(a)}}return i(r,void 0,""),function(){a(r)}}var Yh=function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)o.hasOwnProperty(i)&&(n[i]=o[i])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();(function(r){Yh(t,r);function t(e,n,o){var i=o===void 0?{}:o,a=i.name,s=a===void 0?"ogm"+(Math.random()*1e3|0):a,l=i.keyToName,u=l===void 0?function(c){return""+c}:l,f=r.call(this)||this;f._keyToName=u,f._groupBy=n,f._ogmInfoKey=Symbol("ogmInfo"+s),f._base=e;for(var d=0;d<e.length;d++)f._addItem(e[d]);return f._disposeBaseObserver=Qs(f._base,function(c){if(c.type==="splice")It(function(){for(var p=0,v=c.removed;p<v.length;p++){var h=v[p];f._removeItem(h)}for(var g=0,y=c.added;g<y.length;g++){var _=y[g];f._addItem(_)}});else if(c.type==="update")It(function(){f._removeItem(c.oldValue),f._addItem(c.newValue)});else throw new Error("illegal state")}),f}return t.prototype.clear=function(){throw new Error("not supported")},t.prototype.delete=function(e){throw new Error("not supported")},t.prototype.set=function(e,n){throw new Error("not supported")},t.prototype.dispose=function(){this._disposeBaseObserver();for(var e=0;e<this._base.length;e++){var n=this._base[e],o=n[this._ogmInfoKey];o.reaction(),delete n[this._ogmInfoKey]}},t.prototype._getGroupArr=function(e){var n=r.prototype.get.call(this,e);return n===void 0&&(n=E([],{name:"GroupArray["+this._keyToName(e)+"]",deep:!1}),r.prototype.set.call(this,e,n)),n},t.prototype._removeFromGroupArr=function(e,n){var o=r.prototype.get.call(this,e);o.length===1?r.prototype.delete.call(this,e):(n===o.length-1||(o[n]=o[o.length-1],o[n][this._ogmInfoKey].groupArrIndex=n),o.length--)},t.prototype._addItem=function(e){var n=this,o=this._groupBy(e),i=this._getGroupArr(o),a={groupByValue:o,groupArrIndex:i.length,reaction:$s(function(){return n._groupBy(e)},function(s,l){var u=e[n._ogmInfoKey];n._removeFromGroupArr(u.groupByValue,u.groupArrIndex);var f=n._getGroupArr(s),d=f.length;f.push(e),u.groupByValue=s,u.groupArrIndex=d})};Object.defineProperty(e,this._ogmInfoKey,{configurable:!0,enumerable:!1,value:a}),i.push(e)},t.prototype._removeItem=function(e){var n=e[this._ogmInfoKey];this._removeFromGroupArr(n.groupByValue,n.groupArrIndex),n.reaction(),delete e[this._ogmInfoKey]},t})(yi);Promise.resolve(),typeof queueMicrotask<"u"||typeof process<"u"&&process.nextTick;var ti=function(){return ti=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},ti.apply(this,arguments)},Gh=function(){function r(t){this.undos=[],this.redos=[],this.callbacks=[],this.stopWatch=null,this.curData=null,this.maxSize=50,this.waitTime=100,this.eventCenter=t}return r.prototype.add=function(t){Oi(Ql(this.undos),t)||(this.undos.push(t),Oi(this.curData,t)||(this.redos=[]),this.eventCenter.emit(C.HISTORY_CHANGE,{data:{undos:this.undos,redos:this.redos,undoAble:this.undoAble(),redoAble:this.redoAble()}}),this.undos.length>this.maxSize&&this.undos.shift())},r.prototype.undoAble=function(){return this.undos.length>1},r.prototype.undo=function(){if(this.undoAble()){var t=this.undos.pop();this.redos.push(t);var e=this.undos.pop();return this.curData=k(e),e}},r.prototype.redoAble=function(){return this.redos.length>0},r.prototype.redo=function(){if(this.redoAble()){var t=this.redos.pop();return this.curData=k(t),t}},r.prototype.watch=function(t){var e=this;this.stopWatch&&this.stopWatch(),this.undos.push(t.modelToGraphData()),this.stopWatch=Hh(t,hs(function(){var n=t.modelToHistoryData();n&&e.add(ti({},n))},this.waitTime))},r.prototype.destroy=function(){this.undos=[],this.redos=[],this.curData=null,this.stopWatch&&this.stopWatch()},r}(),yo={exports:{}},ss;function zh(){return ss||(ss=1,function(r){(function(t,e,n){if(!t)return;for(var o={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},i={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},a={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},s={option:"alt",command:"meta",return:"enter",escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},l,u=1;u<20;++u)o[111+u]="f"+u;for(u=0;u<=9;++u)o[u+96]=u.toString();function f(m,O,P){if(m.addEventListener){m.addEventListener(O,P,!1);return}m.attachEvent("on"+O,P)}function d(m){if(m.type=="keypress"){var O=String.fromCharCode(m.which);return m.shiftKey||(O=O.toLowerCase()),O}return o[m.which]?o[m.which]:i[m.which]?i[m.which]:String.fromCharCode(m.which).toLowerCase()}function c(m,O){return m.sort().join(",")===O.sort().join(",")}function p(m){var O=[];return m.shiftKey&&O.push("shift"),m.altKey&&O.push("alt"),m.ctrlKey&&O.push("ctrl"),m.metaKey&&O.push("meta"),O}function v(m){if(m.preventDefault){m.preventDefault();return}m.returnValue=!1}function h(m){if(m.stopPropagation){m.stopPropagation();return}m.cancelBubble=!0}function g(m){return m=="shift"||m=="ctrl"||m=="alt"||m=="meta"}function y(){if(!l){l={};for(var m in o)m>95&&m<112||o.hasOwnProperty(m)&&(l[o[m]]=m)}return l}function _(m,O,P){return P||(P=y()[m]?"keydown":"keypress"),P=="keypress"&&O.length&&(P="keydown"),P}function S(m){return m==="+"?["+"]:(m=m.replace(/\+{2}/g,"+plus"),m.split("+"))}function M(m,O){var P,T,B,I=[];for(P=S(m),B=0;B<P.length;++B)T=P[B],s[T]&&(T=s[T]),O&&O!="keypress"&&a[T]&&(T=a[T],I.push("shift")),g(T)&&I.push(T);return O=_(T,I,O),{key:T,modifiers:I,action:O}}function w(m,O){return m===null||m===e?!1:m===O?!0:w(m.parentNode,O)}function A(m){var O=this;if(m=m||e,!(O instanceof A))return new A(m);O.target=m,O._callbacks={},O._directMap={};var P={},T,B=!1,I=!1,et=!1;function K(X){X=X||{};var F=!1,q;for(q in P){if(X[q]){F=!0;continue}P[q]=0}F||(et=!1)}function it(X,F,q,G,nt,mt){var U,st,Ct=[],_t=q.type;if(!O._callbacks[X])return[];for(_t=="keyup"&&g(X)&&(F=[X]),U=0;U<O._callbacks[X].length;++U)if(st=O._callbacks[X][U],!(!G&&st.seq&&P[st.seq]!=st.level)&&_t==st.action&&(_t=="keypress"&&!q.metaKey&&!q.ctrlKey||c(F,st.modifiers))){var ue=!G&&st.combo==nt,to=G&&st.seq==G&&st.level==mt;(ue||to)&&O._callbacks[X].splice(U,1),Ct.push(st)}return Ct}function yt(X,F,q,G){O.stopCallback(F,F.target||F.srcElement,q,G)||X(F,q)===!1&&(v(F),h(F))}O._handleKey=function(X,F,q){var G=it(X,F,q),nt,mt={},U=0,st=!1;for(nt=0;nt<G.length;++nt)G[nt].seq&&(U=Math.max(U,G[nt].level));for(nt=0;nt<G.length;++nt){if(G[nt].seq){if(G[nt].level!=U)continue;st=!0,mt[G[nt].seq]=1,yt(G[nt].callback,q,G[nt].combo,G[nt].seq);continue}st||yt(G[nt].callback,q,G[nt].combo)}var Ct=q.type=="keypress"&&I;q.type==et&&!g(X)&&!Ct&&K(mt),I=st&&q.type=="keydown"};function Nt(X){typeof X.which!="number"&&(X.which=X.keyCode);var F=d(X);if(F){if(X.type=="keyup"&&B===F){B=!1;return}O.handleKey(F,p(X),X)}}function ne(){clearTimeout(T),T=setTimeout(K,1e3)}function gt(X,F,q,G){P[X]=0;function nt(_t){return function(){et=_t,++P[X],ne()}}function mt(_t){yt(q,_t,X),G!=="keyup"&&(B=d(_t)),setTimeout(K,10)}for(var U=0;U<F.length;++U){var st=U+1===F.length,Ct=st?mt:nt(G||M(F[U+1]).action);bt(F[U],Ct,G,X,U)}}function bt(X,F,q,G,nt){O._directMap[X+":"+q]=F,X=X.replace(/\s+/g," ");var mt=X.split(" "),U;if(mt.length>1){gt(X,mt,F,q);return}U=M(X,q),O._callbacks[U.key]=O._callbacks[U.key]||[],it(U.key,U.modifiers,{type:U.action},G,X,nt),O._callbacks[U.key][G?"unshift":"push"]({callback:F,modifiers:U.modifiers,action:U.action,seq:G,level:nt,combo:X})}O._bindMultiple=function(X,F,q){for(var G=0;G<X.length;++G)bt(X[G],F,q)},f(m,"keypress",Nt),f(m,"keydown",Nt),f(m,"keyup",Nt)}A.prototype.bind=function(m,O,P){var T=this;return m=m instanceof Array?m:[m],T._bindMultiple.call(T,m,O,P),T},A.prototype.unbind=function(m,O){var P=this;return P.bind.call(P,m,function(){},O)},A.prototype.trigger=function(m,O){var P=this;return P._directMap[m+":"+O]&&P._directMap[m+":"+O]({},m),P},A.prototype.reset=function(){var m=this;return m._callbacks={},m._directMap={},m},A.prototype.stopCallback=function(m,O){var P=this;if((" "+O.className+" ").indexOf(" mousetrap ")>-1||w(O,P.target))return!1;if("composedPath"in m&&typeof m.composedPath=="function"){var T=m.composedPath()[0];T!==m.target&&(O=T)}return O.tagName=="INPUT"||O.tagName=="SELECT"||O.tagName=="TEXTAREA"||O.isContentEditable},A.prototype.handleKey=function(){var m=this;return m._handleKey.apply(m,arguments)},A.addKeycodes=function(m){for(var O in m)m.hasOwnProperty(O)&&(o[O]=m[O]);l=null},A.init=function(){var m=A(e);for(var O in m)O.charAt(0)!=="_"&&(A[O]=function(P){return function(){return m[P].apply(m,arguments)}}(O))},A.init(),t.Mousetrap=A,r.exports&&(r.exports=A)})(typeof window<"u"?window:null,typeof window<"u"?document:null)}(yo)),yo.exports}var Fh=zh();const Uh=vs(Fh);var Ut=null;function ls(r,t){return r.x+=t,r.y+=t,ys(r.text)||(r.text.x+=t,r.text.y+=t),r}function us(r,t){return r.startPoint&&(r.startPoint.x+=t,r.startPoint.y+=t),r.endPoint&&(r.endPoint.x+=t,r.endPoint.y+=t),r.pointsList&&r.pointsList.length>0&&r.pointsList.forEach(function(e){e.x+=t,e.y+=t}),ys(r.text)||(r.text.x+=t,r.text.y+=t),r}var ke=40,dn=40;function $h(r,t){var e=r.keyboard,n=e.options.keyboard;e.on(["cmd + c","ctrl + c"],function(){if(dn=ke,!(n!=null&&n.enabled)||t.textEditElement)return!0;var o=r.options.guards,i=t.getSelectElements(!1),a=o&&o.beforeClone?o.beforeClone(i):!0;return!a||i.nodes.length===0&&i.edges.length===0?(Ut=null,!0):(Ut=i,Ut.nodes.forEach(function(s){return ls(s,ke)}),Ut.edges.forEach(function(s){return us(s,ke)}),!1)}),e.on(["cmd + v","ctrl + v"],function(){if(!(n!=null&&n.enabled)||t.textEditElement)return!0;if(Ut&&(Ut.nodes||Ut.edges)){r.clearSelectElements();var o=r.addElements(Ut,dn);if(!o)return!0;o.nodes.forEach(function(i){return r.selectElementById(i.id,!0)}),o.edges.forEach(function(i){return r.selectElementById(i.id,!0)}),Ut.nodes.forEach(function(i){return ls(i,ke)}),Ut.edges.forEach(function(i){return us(i,ke)}),dn=dn+ke}return!1}),e.on(["cmd + z","ctrl + z"],function(){return!(n!=null&&n.enabled)||t.textEditElement?!0:(r.undo(),!1)}),e.on(["cmd + y","ctrl + y"],function(){return!(n!=null&&n.enabled)||t.textEditElement?!0:(r.redo(),!1)}),e.on(["backspace"],function(){if(!(n!=null&&n.enabled)||t.textEditElement)return!0;var o=t.getSelectElements(!0);return r.clearSelectElements(),o.edges.forEach(function(i){return i.id&&r.deleteEdge(i.id)}),o.nodes.forEach(function(i){return i.id&&r.deleteNode(i.id)}),!1})}var Vh=function(){function r(t){t.keyboard||(t.keyboard={enabled:!1}),this.options=t;var e=t.lf;this.target=e.container,this.mousetrap=new Uh(this.target),t.keyboard.enabled&&!e.options.isSilentMode&&this.enable(!0)}return r.prototype.initShortcuts=function(){var t=this,e,n=((e=this.options.keyboard)!==null&&e!==void 0?e:{}).shortcuts;if(n)if(Yn(n))n.forEach(function(s){var l=s.keys,u=s.callback,f=s.action;return t.on(l,u,f)});else{var o=n.keys,i=n.callback,a=n.action;this.on(o,i,a)}},r.prototype.on=function(t,e,n){this.mousetrap.bind(this.getKeys(t),e,n)},Object.defineProperty(r.prototype,"disabled",{get:function(){var t,e;return((e=(t=this.options)===null||t===void 0?void 0:t.keyboard)===null||e===void 0?void 0:e.enabled)!==!0},enumerable:!1,configurable:!0}),r.prototype.off=function(t,e){this.mousetrap.unbind(this.getKeys(t),e)},r.prototype.enable=function(t){(this.disabled||t)&&(this.options.keyboard&&(this.options.keyboard.enabled=!0),this.target instanceof HTMLElement&&(this.target.setAttribute("tabindex","-1"),this.target.style.outline="none"))},r.prototype.disable=function(){this.disabled||(this.options.keyboard&&(this.options.keyboard.enabled=!1),this.target instanceof HTMLElement&&this.target.removeAttribute("tabindex"))},r.prototype.destroy=function(){this.mousetrap.reset()},r.prototype.getKeys=function(t){var e=this;return(Array.isArray(t)?t:[t]).map(function(n){return e.formatKey(n)})},r.prototype.formatKey=function(t){return t.toLowerCase().replace(/\s/g,"").replace("delete","del").replace("cmd","command")},r}(),he=function(){return he=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},he.apply(this,arguments)},fn=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i},go=function(r,t,e){if(e||arguments.length===2)for(var n=0,o=t.length,i;n<o;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return r.concat(i||Array.prototype.slice.call(t))},_o=Symbol("plugin registered by Logicflow.use"),ds=function(){function r(t){var e=this,n;this.viewMap=new Map,this.components=[],this.extension={},this.setView=function(u,f){return e.viewMap.set(u,f)},this.getView=function(u){return e.viewMap.get(u)};var o=Dr.get(t),i=o.container,a=o.width,s=o.height;this.options=o,this.container=this.initContainer(i,a,s),this.graphModel=new jp(he(he({},o),{container:this.container})),this.plugins=(n=o.plugins)!==null&&n!==void 0?n:[];var l=this.graphModel.eventCenter;this.tool=new jh(this),this.dnd=new Oh({lf:this}),this.history=new Gh(l),this.keyboard=new Vh({lf:this,keyboard:o.keyboard}),o.snapline!==!1&&(this.snaplineModel=new Lp(this.graphModel),Sh(l,this.snaplineModel)),o.isSilentMode||($h(this,this.graphModel),this.keyboard.initShortcuts()),this.defaultRegister(),this.installPlugins(o.disabledPlugins)}return r.prototype.initContainer=function(t,e,n){var o=document.createElement("div");return o.style.position="relative",o.style.width=e?"".concat(e,"px"):"100%",o.style.height=n?"".concat(n,"px"):"100%",t.innerHTML="",t.appendChild(o),o},Object.defineProperty(r.prototype,Symbol.toStringTag,{get:function(){return r.toStringTag},enumerable:!1,configurable:!0}),r.prototype.register=function(t,e,n){if(n===void 0&&(n=!0),typeof t!="string"){this.registerElement(t);return}var o={BaseEdge:Qn,BaseEdgeModel:Jn,BaseNode:be,BaseNodeModel:Ee,RectNode:Ka,RectNodeModel:za,CircleNode:Za,CircleNodeModel:ka,PolygonNode:qa,PolygonNodeModel:Ga,TextNode:ts,TextNodeModel:Ua,LineEdge:os,LineEdgeModel:La,DiamondNode:Ja,DiamondNodeModel:Ha,PolylineEdge:is,PolylineEdgeModel:Ba,BezierEdge:ns,BezierEdgeModel:Ra,EllipseNode:Qa,EllipseNodeModel:Ya,HtmlNode:es,HtmlNodeModel:$a,h:$e,type:t};if(this.viewMap.forEach(function(u){var f=u.extendKey;f&&(o[f]=u)}),this.graphModel.modelMap.forEach(function(u){var f=u.extendKey;f&&(o[f]=u)}),e){var i=e(o),a=i.view,s=i.model,l=a;n&&!l.isObserved&&(l.isObserved=!0,l=St(l)),this.setView(t,l),this.graphModel.setModel(t,s)}},r.prototype.registerElement=function(t){var e=t.view;t.isObserverView!==!1&&!e.isObserved&&(e.isObserved=!0,e=St(e)),this.setView(t.type,e),this.graphModel.setModel(t.type,t.model)},r.prototype.batchRegister=function(t){var e=this;t===void 0&&(t=[]),at(t,function(n){e.registerElement(n)})},r.prototype.defaultRegister=function(){var t=[{type:"rect",view:Ka,model:za},{type:"circle",view:Za,model:ka},{type:"polygon",view:qa,model:Ga},{type:"text",view:ts,model:Ua},{type:"ellipse",view:Qa,model:Ya},{type:"diamond",view:Ja,model:Ha},{type:"html",view:es,model:$a},{type:"line",view:os,model:La},{type:"polyline",view:is,model:Ba},{type:"bezier",view:ns,model:Ra}];this.batchRegister(t)},r.prototype.addNode=function(t,e,n){return e===void 0&&(e=C.NODE_ADD),this.graphModel.addNode(t,e,n)},r.prototype.deleteNode=function(t){var e=this.graphModel.getNodeModelById(t);if(!e)return!1;var n=e.getData(),o=this.options.guards,i=o!=null&&o.beforeDelete?o.beforeDelete(n):!0;return i&&this.graphModel.deleteNode(t),i},r.prototype.cloneNode=function(t){var e=this.graphModel.getNodeModelById(t),n=e==null?void 0:e.getData();if(n){var o=this.options.guards,i=o!=null&&o.beforeClone?o.beforeClone(n):!0;if(i)return this.graphModel.cloneNode(t)}},r.prototype.changeNodeId=function(t,e){return this.graphModel.changeNodeId(t,e)},r.prototype.changeNodeType=function(t,e){this.graphModel.changeNodeType(t,e)},r.prototype.getNodeModelById=function(t){return this.graphModel.getNodeModelById(t)},r.prototype.getNodeDataById=function(t){var e=this.getNodeModelById(t);return e==null?void 0:e.getData()},r.prototype.getNodeIncomingEdge=function(t){return this.graphModel.getNodeIncomingEdge(t)},r.prototype.getNodeOutgoingEdge=function(t){return this.graphModel.getNodeOutgoingEdge(t)},r.prototype.getNodeIncomingNode=function(t){return this.graphModel.getNodeIncomingNode(t)},r.prototype.getNodeOutgoingNode=function(t){return this.graphModel.getNodeOutgoingNode(t)},r.prototype.createFakeNode=function(t){var e=this.graphModel.modelMap.get(t.type);if(!e)return console.warn("不存在为".concat(t.type,"类型的节点")),null;var n=new e(he(he({},t),{virtual:!0}),this.graphModel);return this.graphModel.setFakeNode(n),n},r.prototype.removeFakeNode=function(){this.graphModel.removeFakeNode()},r.prototype.setNodeSnapLine=function(t){var e;(e=this.snaplineModel)===null||e===void 0||e.setNodeSnapLine(t)},r.prototype.removeNodeSnapLine=function(){var t;(t=this.snaplineModel)===null||t===void 0||t.clearSnapline()},r.prototype.setDefaultEdgeType=function(t){this.graphModel.setDefaultEdgeType(t)},r.prototype.addEdge=function(t){return this.graphModel.addEdge(t)},r.prototype.getEdgeDataById=function(t){var e=this.getEdgeModelById(t);return e==null?void 0:e.getData()},r.prototype.getEdgeModelById=function(t){return this.graphModel.getEdgeModelById(t)},r.prototype.getEdgeModels=function(t){var e=t.sourceNodeId,n=t.targetNodeId,o=[],i=this.graphModel.edges;return e&&n?at(i,function(a){a.sourceNodeId===e&&a.targetNodeId===n&&o.push(a)}):e?at(i,function(a){a.sourceNodeId===e&&o.push(a)}):n&&at(i,function(a){a.targetNodeId===n&&o.push(a)}),o},r.prototype.changeEdgeId=function(t,e){return this.graphModel.changeEdgeId(t,e)},r.prototype.changeEdgeType=function(t,e){this.graphModel.changeEdgeType(t,e)},r.prototype.deleteEdge=function(t){var e=this.graphModel.getEdgeModelById(t);if(!e)return!1;var n=e.getData(),o=this.options.guards,i=o!=null&&o.beforeDelete?o.beforeDelete(n):!0;return i&&this.graphModel.deleteEdgeById(t),i},r.prototype.deleteEdgeByNodeId=function(t){var e=t.sourceNodeId,n=t.targetNodeId;e&&n?this.graphModel.deleteEdgeBySourceAndTarget(e,n):e?this.graphModel.deleteEdgeBySource(e):n&&this.graphModel.deleteEdgeByTarget(n)},r.prototype.getNodeEdges=function(t){return this.graphModel.getNodeEdges(t)},r.prototype.addElements=function(t,e){var n=this,o=t.nodes,i=t.edges;e===void 0&&(e=40),console.log("distance",e);var a={},s={nodes:[],edges:[]};return at(o,function(l){var u=l.id,f=n.addNode(l);u&&(a[u]=f.id),s.nodes.push(f)}),at(i,function(l){var u=l.sourceNodeId,f=l.targetNodeId;a[u]&&(u=a[u]),a[f]&&(f=a[f]);var d=n.graphModel.addEdge(he(he({},l),{sourceNodeId:u,targetNodeId:f}));s.edges.push(d)}),s},r.prototype.selectElementById=function(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),this.graphModel.selectElementById(t,e),!e&&n&&this.graphModel.toFront(t)},r.prototype.getSelectElements=function(t){return t===void 0&&(t=!0),this.graphModel.getSelectElements(t)},r.prototype.clearSelectElements=function(){this.graphModel.clearSelectElements()},r.prototype.getModelById=function(t){return this.graphModel.getElement(t)},r.prototype.getDataById=function(t){var e;return(e=this.graphModel.getElement(t))===null||e===void 0?void 0:e.getData()},r.prototype.deleteElement=function(t){var e,n,o,i=this.getModelById(t);if(!i)return!1;var a=(e={},e[ot.NODE]=this.deleteNode,e[ot.EDGE]=this.deleteEdge,e);return(o=(n=a[i.BaseType])===null||n===void 0?void 0:n.call(this,t))!==null&&o!==void 0?o:!1},r.prototype.setElementZIndex=function(t,e){return this.graphModel.setElementZIndex(t,e)},r.prototype.getAreaElement=function(t,e,n,o,i){return n===void 0&&(n=!0),o===void 0&&(o=!0),i===void 0&&(i=!1),this.graphModel.getAreaElement(t,e,n,o,i).map(function(a){return a.getData()})},r.prototype.setProperties=function(t,e){var n;(n=this.graphModel.getElement(t))===null||n===void 0||n.setProperties(vt(e))},r.prototype.getProperties=function(t){var e;return(e=this.graphModel.getElement(t))===null||e===void 0?void 0:e.getProperties()},r.prototype.deleteProperty=function(t,e){var n;(n=this.graphModel.getElement(t))===null||n===void 0||n.deleteProperty(e)},r.prototype.updateAttributes=function(t,e){this.graphModel.updateAttributes(t,e)},r.prototype.editText=function(t){this.graphModel.editText(t)},r.prototype.updateText=function(t,e){this.graphModel.updateText(t,e)},r.prototype.updateEditConfig=function(t){var e=this.graphModel,n=e.editConfigModel,o=e.transformModel,i=n.snapGrid;if(n.updateEditConfig(t),(t==null?void 0:t.stopMoveGraph)!==void 0&&o.updateTranslateLimits(t.stopMoveGraph),t!=null&&t.isSilentMode?this.keyboard.disable():this.keyboard.enable(!0),!Xt(t==null?void 0:t.snapGrid)&&t.snapGrid!==i){var a=this.graphModel.grid.size,s=a===void 0?1:a;this.graphModel.updateGridSize(t.snapGrid?s:1)}},r.prototype.getEditConfig=function(){return this.graphModel.editConfigModel.getConfig()},r.prototype.setTheme=function(t){this.graphModel.setTheme(t)},r.prototype.focusByElement=function(t){var e=void 0,n=this.getNodeModelById(t);if(n){var o=n.getData(),i=o.x,a=o.y;e={x:i,y:a}}var s=this.getEdgeModelById(t);if(s){var l=s.textPosition,i=l.x,a=l.y;e={x:i,y:a}}e&&this.focusByCoordinate(e)},r.prototype.focusByCoordinate=function(t){var e=this.graphModel,n=e.transformModel,o=e.width,i=e.height,a=t.x,s=t.y;n.focusOn(a,s,o,i)},r.prototype.focusOn=function(t){if(typeof t=="string")this.focusByElement(t);else if("x"in t&&"y"in t)this.focusByCoordinate(t);else{var e=t.id,n=t.coordinate;e&&this.focusByElement(e),n&&this.focusByCoordinate(n)}},r.prototype.resize=function(t,e){this.graphModel.resize(t,e),this.options.width=this.graphModel.width,this.options.height=this.graphModel.height},r.prototype.toFront=function(t){this.graphModel.toFront(t)},r.prototype.getPointByClient=function(t,e){if(typeof t=="object")return this.graphModel.getPointByClient(t);if(typeof e=="number")return this.graphModel.getPointByClient({x:t,y:e})},r.prototype.getGraphData=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=this.getGraphRawData();return this.adapterOut?this.adapterOut.apply(this,go([n],fn(t),!1)):n},r.prototype.getGraphRawData=function(){return this.graphModel.modelToGraphData()},r.prototype.clearData=function(){this.graphModel.clearData(),this.render({})},r.prototype.renderRawData=function(t){this.graphModel.graphDataToModel(vt(t)),this.options.history!==!1&&this.history.watch(this.graphModel),aa(b(Gp,{getView:this.getView,tool:this.tool,options:this.options,dnd:this.dnd,snaplineModel:this.snaplineModel,graphModel:this.graphModel}),this.container),this.emit(C.GRAPH_RENDERED,{data:this.graphModel.modelToGraphData(),graphModel:this.graphModel})},r.prototype.render=function(t){var e=k(t);this.adapterIn&&(e=this.adapterIn(e)),this.renderRawData(e)},r.prototype.undo=function(){if(this.history.undoAble()){var t=vt(this.history.undo());this.clearSelectElements(),this.graphModel.graphDataToModel(t)}},r.prototype.redo=function(){if(this.history.redoAble()){var t=vt(this.history.redo());this.clearSelectElements(),this.graphModel.graphDataToModel(t)}},r.prototype.zoom=function(t,e){var n=this.graphModel.transformModel;return n.zoom(t,e)},r.prototype.resetZoom=function(){var t=this.graphModel.transformModel;t.resetZoom()},r.prototype.setZoomMiniSize=function(t){var e=this.graphModel.transformModel;e.setZoomMiniSize(t)},r.prototype.setZoomMaxSize=function(t){var e=this.graphModel.transformModel;e.setZoomMaxSize(t)},r.prototype.getTransform=function(){var t=this.graphModel.transformModel,e=t.SCALE_X,n=t.SCALE_Y,o=t.TRANSLATE_X,i=t.TRANSLATE_Y;return{SCALE_X:e,SCALE_Y:n,TRANSLATE_X:o,TRANSLATE_Y:i}},r.prototype.translate=function(t,e){var n=this.graphModel.transformModel;n.translate(t,e)},r.prototype.resetTranslate=function(){var t=this.graphModel.transformModel,e=t.TRANSLATE_X,n=t.TRANSLATE_Y;this.translate(-e,-n)},r.prototype.translateCenter=function(){this.graphModel.translateCenter()},r.prototype.fitView=function(t,e){e===void 0&&(e=t),this.graphModel.fitView(t,e)},r.prototype.openEdgeAnimation=function(t){this.graphModel.openEdgeAnimation(t)},r.prototype.closeEdgeAnimation=function(t){this.graphModel.closeEdgeAnimation(t)},r.prototype.on=function(t,e){this.graphModel.eventCenter.on(t,e)},r.prototype.off=function(t,e){this.graphModel.eventCenter.off(t,e)},r.prototype.once=function(t,e){this.graphModel.eventCenter.once(t,e)},r.prototype.emit=function(t,e){this.graphModel.eventCenter.emit(t,e)},r.use=function(t,e){var n,o=t.pluginName;if(!o)throw new Error("请给插件指定 pluginName!");this.extensions.set(o,(n={},n[_o]=_o,n.extension=t,n.props=e,n))},r.prototype.installPlugins=function(t){var e=this;t===void 0&&(t=[]);var n=Array.from(r.extensions,function(i){var a=fn(i,2),s=a[1];return s}),o=go(go([],fn(this.plugins),!1),fn(n),!1);at(o,function(i){var a,s;_o in i?(a=i.extension,s=i.props):a=i;var l=a==null?void 0:a.pluginName;Eu(t,l)===-1&&e.installPlugin(a,s)})},r.prototype.installPlugin=function(t,e){var n,o;if("pluginName"in t&&"install"in t){var i=t.pluginName,a=t.install,s=t.render;i&&(a&&a.call(t,this,r),s&&this.components.push(s.bind(t)),this.extension[i]=t);return}var l=t,u=l.pluginName,f=new l({lf:this,LogicFlow:r,props:e,options:(o=(n=this.options.pluginsOptions)===null||n===void 0?void 0:n[u])!==null&&o!==void 0?o:{}});f.render&&this.components.push(f.render.bind(f)),this.extension[u]=f},r.prototype.destroy=function(){var t;this.clearData(),aa(null,this.container),this.keyboard.destroy(),this.graphModel.destroy(),this.tool.destroy(),this.history.destroy();for(var e in this.extension){var n=this.extension[e];"destroy"in n&&((t=n.destroy)===null||t===void 0||t.call(n))}},r.extensions=new Map,r}();(function(r){r.toStringTag="LF.".concat(r.name)})(ds||(ds={}));function St(r){return _i(r)}const Kh=(r,t="info",e=!1,n=!1,o=!1)=>{tu({message:r,type:t,plain:e,showClose:n,center:o})},Zh=(r,t,e,n,o="确定",i="取消")=>{eu.confirm(r,t,{confirmButtonText:o,cancelButtonText:i,type:"warning"}).then(()=>{e&&e()}).catch(()=>{})};export{Ra as B,$a as H,ds as L,za as R,$e as _,es as a,Zh as b,ns as c,Ka as d,Kh as l};
